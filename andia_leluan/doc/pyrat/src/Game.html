<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.7.0"/>
    <title>pyrat.src.Game API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../src.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;pyrat.src</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Game">Game</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Game.__init__">Game</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_RANDOM_SEED">DEFAULT_RANDOM_SEED</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_RANDOM_SEED_MAZE">DEFAULT_RANDOM_SEED_MAZE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_RANDOM_SEED_CHEESE">DEFAULT_RANDOM_SEED_CHEESE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_RANDOM_SEED_PLAYERS">DEFAULT_RANDOM_SEED_PLAYERS</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_MAZE_WIDTH">DEFAULT_MAZE_WIDTH</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_MAZE_HEIGHT">DEFAULT_MAZE_HEIGHT</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_CELL_PERCENTAGE">DEFAULT_CELL_PERCENTAGE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_WALL_PERCENTAGE">DEFAULT_WALL_PERCENTAGE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_MUD_PERCENTAGE">DEFAULT_MUD_PERCENTAGE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_MUD_RANGE">DEFAULT_MUD_RANGE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_FIXED_MAZE">DEFAULT_FIXED_MAZE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_RANDOM_MAZE_ALGORITHM">DEFAULT_RANDOM_MAZE_ALGORITHM</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_NB_CHEESE">DEFAULT_NB_CHEESE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_FIXED_CHEESE">DEFAULT_FIXED_CHEESE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_RENDER_MODE">DEFAULT_RENDER_MODE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_RENDER_SIMPLIFIED">DEFAULT_RENDER_SIMPLIFIED</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_GUI_SPEED">DEFAULT_GUI_SPEED</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_TRACE_LENGTH">DEFAULT_TRACE_LENGTH</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_FULLSCREEN">DEFAULT_FULLSCREEN</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_SAVE_PATH">DEFAULT_SAVE_PATH</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_SAVE_GAME">DEFAULT_SAVE_GAME</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_PREPROCESSING_TIME">DEFAULT_PREPROCESSING_TIME</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_TURN_TIME">DEFAULT_TURN_TIME</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_GAME_MODE">DEFAULT_GAME_MODE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.DEFAULT_CONTINUE_ON_ERROR">DEFAULT_CONTINUE_ON_ERROR</a>
                        </li>
                        <li>
                                <a class="variable" href="#Game.maze">maze</a>
                        </li>
                        <li>
                                <a class="function" href="#Game.add_player">add_player</a>
                        </li>
                        <li>
                                <a class="function" href="#Game.reset">reset</a>
                        </li>
                        <li>
                                <a class="function" href="#Game.start">start</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../pyrat.html">pyrat</a><wbr>.<a href="./../src.html">src</a><wbr>.Game    </h1>

                        <div class="docstring"><p>This file is part of the PyRat library.
It is meant to be used as a library, and not to be executed directly.</p>

<h6 id="please-import-necessary-elements-using-the-following-syntax">Please import necessary elements using the following syntax:</h6>

<blockquote>
  <p>from pyrat import <element_name></p>
</blockquote>
</div>

                        <input id="mod-Game-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-Game-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1">#####################################################################################################################################################</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="c1">######################################################################## INFO #######################################################################</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="c1">#####################################################################################################################################################</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">    This file is part of the PyRat library.</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">    It is meant to be used as a library, and not to be executed directly.</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">    Please import necessary elements using the following syntax:</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">        from pyrat import &lt;element_name&gt;</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="c1">#####################################################################################################################################################</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="c1">###################################################################### IMPORTS ######################################################################</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="c1">#####################################################################################################################################################</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="c1"># External imports</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span> <span class="nn">numbers</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">import</span> <span class="nn">copy</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">import</span> <span class="nn">math</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">import</span> <span class="nn">multiprocessing</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="kn">import</span> <span class="nn">multiprocessing.managers</span> <span class="k">as</span> <span class="nn">mpmanagers</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="kn">import</span> <span class="nn">time</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="kn">import</span> <span class="nn">traceback</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="kn">import</span> <span class="nn">sys</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="kn">import</span> <span class="nn">datetime</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="kn">import</span> <span class="nn">random</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="c1"># PyRat imports</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="kn">from</span> <span class="nn">pyrat.src.Maze</span> <span class="kn">import</span> <span class="n">Maze</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="kn">from</span> <span class="nn">pyrat.src.HolesOnSideRandomMaze</span> <span class="kn">import</span> <span class="n">HolesOnSideRandomMaze</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="kn">from</span> <span class="nn">pyrat.src.UniformHolesRandomMaze</span> <span class="kn">import</span> <span class="n">UniformHolesRandomMaze</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="kn">from</span> <span class="nn">pyrat.src.BigHolesRandomMaze</span> <span class="kn">import</span> <span class="n">BigHolesRandomMaze</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="kn">from</span> <span class="nn">pyrat.src.MazeFromDict</span> <span class="kn">import</span> <span class="n">MazeFromDict</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="kn">from</span> <span class="nn">pyrat.src.MazeFromMatrix</span> <span class="kn">import</span> <span class="n">MazeFromMatrix</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="kn">from</span> <span class="nn">pyrat.src.Player</span> <span class="kn">import</span> <span class="n">Player</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="kn">from</span> <span class="nn">pyrat.src.GameState</span> <span class="kn">import</span> <span class="n">GameState</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="kn">from</span> <span class="nn">pyrat.src.RenderingEngine</span> <span class="kn">import</span> <span class="n">RenderingEngine</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="kn">from</span> <span class="nn">pyrat.src.ShellRenderingEngine</span> <span class="kn">import</span> <span class="n">ShellRenderingEngine</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="kn">from</span> <span class="nn">pyrat.src.PygameRenderingEngine</span> <span class="kn">import</span> <span class="n">PygameRenderingEngine</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="kn">from</span> <span class="nn">pyrat.src.enums</span> <span class="kn">import</span> <span class="n">RenderMode</span><span class="p">,</span> <span class="n">GameMode</span><span class="p">,</span> <span class="n">Action</span><span class="p">,</span> <span class="n">StartingLocation</span><span class="p">,</span> <span class="n">PlayerSkin</span><span class="p">,</span> <span class="n">RandomMazeAlgorithm</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="kn">from</span> <span class="nn">pyrat.src.utils</span> <span class="kn">import</span> <span class="n">is_valid_directory</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="c1">#####################################################################################################################################################</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="c1">###################################################################### CLASSES ######################################################################</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="c1">#####################################################################################################################################################</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="k">class</span> <span class="nc">Game</span> <span class="p">():</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">        A game is a class that allows to play a game of PyRat.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">        It is initialized with the parameters of the game.</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">        Players should then be added to the game using the add_player method.</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">        Finally, the start method should be called to start the game.</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">        Once the game is over, it will provide statistics about the game.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">        Set your own parameters to define interesting objectives for the players.</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>    <span class="c1">#                                                              CLASS ATTRIBUTES                                                             #</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="w">    </span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        To ease creating games, we provide a set of default parameters.</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        We do not put them in the constructor to be able to ckeck for valid configurations.</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="n">DEFAULT_RANDOM_SEED</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>    <span class="n">DEFAULT_RANDOM_SEED_MAZE</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>    <span class="n">DEFAULT_RANDOM_SEED_CHEESE</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>    <span class="n">DEFAULT_RANDOM_SEED_PLAYERS</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>    <span class="n">DEFAULT_MAZE_WIDTH</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>    <span class="n">DEFAULT_MAZE_HEIGHT</span> <span class="o">=</span> <span class="mi">13</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="n">DEFAULT_CELL_PERCENTAGE</span> <span class="o">=</span> <span class="mf">80.0</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>    <span class="n">DEFAULT_WALL_PERCENTAGE</span> <span class="o">=</span> <span class="mf">60.0</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>    <span class="n">DEFAULT_MUD_PERCENTAGE</span> <span class="o">=</span> <span class="mf">20.0</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="n">DEFAULT_MUD_RANGE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    <span class="n">DEFAULT_FIXED_MAZE</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>    <span class="n">DEFAULT_RANDOM_MAZE_ALGORITHM</span> <span class="o">=</span> <span class="n">RandomMazeAlgorithm</span><span class="o">.</span><span class="n">BIG_HOLES</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>    <span class="n">DEFAULT_NB_CHEESE</span> <span class="o">=</span> <span class="mi">21</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    <span class="n">DEFAULT_FIXED_CHEESE</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>    <span class="n">DEFAULT_RENDER_MODE</span> <span class="o">=</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>    <span class="n">DEFAULT_RENDER_SIMPLIFIED</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>    <span class="n">DEFAULT_GUI_SPEED</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>    <span class="n">DEFAULT_TRACE_LENGTH</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>    <span class="n">DEFAULT_FULLSCREEN</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>    <span class="n">DEFAULT_SAVE_PATH</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>    <span class="n">DEFAULT_SAVE_GAME</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>    <span class="n">DEFAULT_PREPROCESSING_TIME</span> <span class="o">=</span> <span class="mf">3.0</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>    <span class="n">DEFAULT_TURN_TIME</span> <span class="o">=</span> <span class="mf">0.1</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="n">DEFAULT_GAME_MODE</span> <span class="o">=</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    <span class="n">DEFAULT_CONTINUE_ON_ERROR</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>    <span class="c1">#                                                               MAGIC METHODS                                                               #</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>    <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>                  <span class="n">Self</span><span class="p">,</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>                   <span class="n">random_seed</span><span class="p">:</span>           <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>                   <span class="n">random_seed_maze</span><span class="p">:</span>      <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>                   <span class="n">random_seed_cheese</span><span class="p">:</span>    <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>                   <span class="n">random_seed_players</span><span class="p">:</span>   <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>                   <span class="n">maze_width</span><span class="p">:</span>            <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>                   <span class="n">maze_height</span><span class="p">:</span>           <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>                   <span class="n">cell_percentage</span><span class="p">:</span>       <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>                   <span class="n">wall_percentage</span><span class="p">:</span>       <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>                   <span class="n">mud_percentage</span><span class="p">:</span>        <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>                   <span class="n">mud_range</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Integral</span><span class="p">,</span> <span class="n">Integral</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>                   <span class="n">fixed_maze</span><span class="p">:</span>            <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Integral</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Integral</span><span class="p">,</span> <span class="n">Integral</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>                   <span class="n">nb_cheese</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>                   <span class="n">fixed_cheese</span><span class="p">:</span>          <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Integral</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>                   <span class="n">random_maze_algorithm</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RandomMazeAlgorithm</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>                   <span class="n">render_mode</span><span class="p">:</span>           <span class="n">Optional</span><span class="p">[</span><span class="n">RenderMode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>                   <span class="n">render_simplified</span><span class="p">:</span>     <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>                   <span class="n">gui_speed</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>                   <span class="n">trace_length</span><span class="p">:</span>          <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>                   <span class="n">fullscreen</span><span class="p">:</span>            <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>                   <span class="n">save_path</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>                   <span class="n">save_game</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>                   <span class="n">preprocessing_time</span><span class="p">:</span>    <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>                   <span class="n">turn_time</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>                   <span class="n">game_mode</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">GameMode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>                   <span class="n">continue_on_error</span><span class="p">:</span>     <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>                 <span class="p">)</span> <span class="o">-&gt;</span>                     <span class="n">Self</span><span class="p">:</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">            This function is the constructor of the class.</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">            When an object is instantiated, this method is called to initialize the object.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">            This is where you should define the attributes of the object and set their initial values.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">            Assertions checked in the objects manipulated by the game are not checked again.</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">            In:</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">                * self:                  Reference to the current object.</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">                * random_seed:           Global random seed for all elements, set to None for a random value.</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">                * random_seed_maze:      Random seed for the maze generation, set to None for a random value.</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="sd">                * random_seed_cheese:    Random seed for the pieces of cheese distribution, set to None for a random value.</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">                * random_seed_players:   Random seed for the initial location of players, set to None for a random value.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">                * maze_width:            Width of the maze in number of cells.</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">                * maze_height:           Height of the maze in number of cells.</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">                * cell_percentage:       Percentage of cells that can be accessed in the maze, 0%% being a useless maze, and 100%% being a full rectangular maze.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">                * wall_percentage:       Percentage of walls in the maze, 0%% being an empty maze, and 100%% being the maximum number of walls that keep the maze connected.</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">                * mud_percentage:        Percentage of pairs of adjacent cells that are separated by mud in the maze.</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">                * mud_range:             Interval of turns needed to cross mud.</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">                * fixed_maze:            Fixed maze in any PyRat accepted representation (dictionary, numpy.ndarray or torch.tensor).</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">                * random_maze_algorithm: Algorithm to generate the maze.</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">                * nb_cheese:             Number of pieces of cheese in the maze.</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">                * fixed_cheese:          Fixed list of cheese.</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">                * render_mode:           Method to display the game.</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">                * render_simplified:     If the maze is rendered, hides some elements that are not essential.</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">                * gui_speed:             When rendering as GUI, controls the speed of the game (GUI rendering only).</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">                * trace_length:          Maximum length of the trace to display when players are moving (GUI rendering only).</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">                * fullscreen:            Renders the game in fullscreen mode (GUI rendering only).</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">                * save_path:             Path where games are saved.</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">                * save_game:             Indicates if the game should be saved.</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">                * preprocessing_time:    Time given to the players before the game starts.</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">                * turn_time:             Time after which players will miss a turn.</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">                * game_mode:             Indicates if players play concurrently, wait for each other, or if multiprocessing is disabled.</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">                * continue_on_error:     If a player crashes, continues the game anyway.</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">            Out:</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">                * A new instance of the class.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>        
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>        <span class="c1"># Debug</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_seed</span><span class="p">,</span> <span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_seed&#39; must be an integer or None (if so, default value &#39;Game.DEFAULT_RANDOM_SEED&#39; is used)&quot;</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_seed_maze</span><span class="p">,</span> <span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_seed_maze&#39; must be an integer or None (if so, default value &#39;Game.DEFAULT_RANDOM_SEED_MAZE&#39; is used)&quot;</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_seed_cheese</span><span class="p">,</span> <span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_seed_cheese&#39; must be an integer or None (if so, default value &#39;Game.DEFAULT_RANDOM_SEED_CHEESE&#39; is used)&quot;</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_seed_players</span><span class="p">,</span> <span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_seed_players&#39; must be an integer or None (if so, default value &#39;Game.DEFAULT_RANDOM_SEED_PLAYERS&#39; is used)&quot;</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="k">assert</span> <span class="n">random_seed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">random_seed</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;random_seed&#39; should be non-negative&quot;</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="k">assert</span> <span class="n">random_seed_maze</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">random_seed_maze</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;random_seed_maze&#39; should be a positive integer&quot;</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="k">assert</span> <span class="n">random_seed_cheese</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">random_seed_cheese</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;random_seed_cheese&#39; should be a positive integer&quot;</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="k">assert</span> <span class="n">random_seed_players</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed_players</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">random_seed_players</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;random_seed_players&#39; should be a positive integer&quot;</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>        <span class="k">assert</span> <span class="n">random_seed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">random_seed_maze</span><span class="p">,</span> <span class="n">random_seed_cheese</span><span class="p">,</span> <span class="n">random_seed_players</span><span class="p">]])),</span> <span class="s2">&quot;Argument &#39;random_seed&#39; should be given if and only if no other random seed is given&quot;</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">render_mode</span><span class="p">,</span> <span class="p">(</span><span class="n">RenderMode</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;render_mode&#39; must be of type &#39;pyrat.RenderMode&#39; or None (if so, default value &#39;Game.DEFAULT_RENDER_MODE&#39; is used)&quot;</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">turn_time</span><span class="p">,</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;turn_time&#39; must be a real number or None (if so, default value &#39;Game.DEFAULT_TURN_TIME&#39; is used)&quot;</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="k">assert</span> <span class="n">turn_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">turn_time</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Argument &#39;turn_time&#39; should be non-negative&quot;</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preprocessing_time</span><span class="p">,</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;preprocessing_time&#39; must be a real number or None (if so, default value &#39;Game.DEFAULT_PREPROCESSING_TIME&#39; is used)&quot;</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="k">assert</span> <span class="n">preprocessing_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">preprocessing_time</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Argument &#39;preprocessing_time&#39; should be non-negative&quot;</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">game_mode</span><span class="p">,</span> <span class="p">(</span><span class="n">GameMode</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;game_mode&#39; must be of type &#39;pyrat.GameMode&#39; or None (if so, default value &#39;Game.DEFAULT_GAME_MODE&#39; is used)&quot;</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">continue_on_error</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;continue_on_error&#39; must be a boolean or None (if so, default value &#39;Game.DEFAULT_CONTINUE_ON_ERROR&#39; is used)&quot;</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="k">assert</span> <span class="ow">not</span><span class="p">(</span><span class="n">game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SEQUENTIAL</span> <span class="ow">and</span> <span class="n">render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span><span class="p">),</span> <span class="s2">&quot;Cannot render GUI in sequential mode&quot;</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="k">assert</span> <span class="n">fixed_maze</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fixed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">random_seed_maze</span><span class="p">,</span> <span class="n">random_maze_algorithm</span><span class="p">,</span> <span class="n">maze_width</span><span class="p">,</span> <span class="n">maze_height</span><span class="p">,</span> <span class="n">cell_percentage</span><span class="p">,</span> <span class="n">wall_percentage</span><span class="p">,</span> <span class="n">mud_percentage</span><span class="p">,</span> <span class="n">mud_range</span><span class="p">])),</span> <span class="s2">&quot;Argument &#39;fixed_maze&#39; should be given if and only if no other maze description is given&quot;</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>        <span class="k">assert</span> <span class="n">fixed_cheese</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fixed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">random_seed_cheese</span><span class="p">,</span> <span class="n">nb_cheese</span><span class="p">])),</span> <span class="s2">&quot;Argument &#39;fixed_cheese&#39; should be given if and only if no other cheese description is given&quot;</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>        <span class="k">assert</span> <span class="n">game_mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">game_mode</span> <span class="o">!=</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SIMULATION</span> <span class="ow">or</span> <span class="p">(</span><span class="n">game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SIMULATION</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">render_mode</span><span class="p">,</span> <span class="n">preprocessing_time</span><span class="p">,</span> <span class="n">turn_time</span><span class="p">]])),</span> <span class="s2">&quot;Some parameters should be set when running in simulation mode&quot;</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="k">assert</span> <span class="n">render_mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span> <span class="ow">or</span> <span class="p">(</span><span class="n">render_mode</span> <span class="o">!=</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">trace_length</span><span class="p">,</span> <span class="n">gui_speed</span><span class="p">,</span> <span class="n">fullscreen</span><span class="p">]])),</span> <span class="s2">&quot;Some parameters should be set only when rendering in GUI mode&quot;</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_maze_algorithm</span><span class="p">,</span> <span class="p">(</span><span class="n">RandomMazeAlgorithm</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_maze_algorithm&#39; must be of type &#39;pyrat.RandomMazeAlgorithm&#39; or None (if so, default value &#39;Game.DEFAULT_RANDOM_MAZE_ALGORITHM&#39; is used)&quot;</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">save_game</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;save_game&#39; must be a boolean or None (if so, default value &#39;Game.DEFAULT_SAVE_GAME&#39; is used)&quot;</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;save_path&#39; must be a string or None (if so, default value &#39;Game.DEFAULT_SAVE_PATH&#39; is used)&quot;</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>        <span class="k">assert</span> <span class="n">save_path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">is_valid_directory</span><span class="p">(</span><span class="n">save_path</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;save_path&#39; must be a valid directory&quot;</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>        <span class="c1"># Store given parameters or default values</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="o">=</span> <span class="n">random_seed</span> <span class="k">if</span> <span class="n">random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_SEED</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_maze</span> <span class="o">=</span> <span class="n">random_seed_maze</span> <span class="k">if</span> <span class="n">random_seed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_SEED_MAZE</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_cheese</span> <span class="o">=</span> <span class="n">random_seed_cheese</span> <span class="k">if</span> <span class="n">random_seed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_SEED_CHEESE</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_players</span> <span class="o">=</span> <span class="n">random_seed_players</span> <span class="k">if</span> <span class="n">random_seed_players</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_SEED_PLAYERS</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span> <span class="o">=</span> <span class="n">maze_width</span> <span class="k">if</span> <span class="n">maze_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_MAZE_WIDTH</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span> <span class="o">=</span> <span class="n">maze_height</span> <span class="k">if</span> <span class="n">maze_height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_MAZE_HEIGHT</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span> <span class="o">=</span> <span class="n">cell_percentage</span> <span class="k">if</span> <span class="n">cell_percentage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_CELL_PERCENTAGE</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span> <span class="o">=</span> <span class="n">wall_percentage</span> <span class="k">if</span> <span class="n">wall_percentage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_WALL_PERCENTAGE</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span> <span class="o">=</span> <span class="n">mud_percentage</span> <span class="k">if</span> <span class="n">mud_percentage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_MUD_PERCENTAGE</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span> <span class="o">=</span> <span class="n">mud_range</span> <span class="k">if</span> <span class="n">mud_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_MUD_RANGE</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span> <span class="o">=</span> <span class="n">fixed_maze</span> <span class="k">if</span> <span class="n">fixed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_FIXED_MAZE</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span> <span class="o">=</span> <span class="n">random_maze_algorithm</span> <span class="k">if</span> <span class="n">random_maze_algorithm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_MAZE_ALGORITHM</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span> <span class="o">=</span> <span class="n">nb_cheese</span> <span class="k">if</span> <span class="n">nb_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_NB_CHEESE</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span> <span class="o">=</span> <span class="n">fixed_cheese</span> <span class="k">if</span> <span class="n">fixed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_FIXED_CHEESE</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">=</span> <span class="n">render_mode</span> <span class="k">if</span> <span class="n">render_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RENDER_MODE</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span> <span class="o">=</span> <span class="n">render_simplified</span> <span class="k">if</span> <span class="n">render_simplified</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RENDER_SIMPLIFIED</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__gui_speed</span> <span class="o">=</span> <span class="n">gui_speed</span> <span class="k">if</span> <span class="n">gui_speed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_GUI_SPEED</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__trace_length</span> <span class="o">=</span> <span class="n">trace_length</span> <span class="k">if</span> <span class="n">trace_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_TRACE_LENGTH</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__fullscreen</span> <span class="o">=</span> <span class="n">fullscreen</span> <span class="k">if</span> <span class="n">fullscreen</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_FULLSCREEN</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__save_path</span> <span class="o">=</span> <span class="n">save_path</span> <span class="k">if</span> <span class="n">save_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_SAVE_PATH</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__save_game</span> <span class="o">=</span> <span class="n">save_game</span> <span class="k">if</span> <span class="n">save_game</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_SAVE_GAME</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__preprocessing_time</span> <span class="o">=</span> <span class="n">preprocessing_time</span> <span class="k">if</span> <span class="n">preprocessing_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_PREPROCESSING_TIME</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__turn_time</span> <span class="o">=</span> <span class="n">turn_time</span> <span class="k">if</span> <span class="n">turn_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_TURN_TIME</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">=</span> <span class="n">game_mode</span> <span class="k">if</span> <span class="n">game_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_GAME_MODE</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__continue_on_error</span> <span class="o">=</span> <span class="n">continue_on_error</span> <span class="k">if</span> <span class="n">continue_on_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_CONTINUE_ON_ERROR</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="c1"># If the game is in simulation mode, we enforce some parameters</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SIMULATION</span><span class="p">:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__preprocessing_time</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__turn_time</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">=</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">NO_RENDERING</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">=</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SEQUENTIAL</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="c1"># Private attributes</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_cheese</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_players</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players_rng</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players_asked_location</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__reset_called</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>        <span class="c1"># Initialize the game</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>    <span class="k">def</span> <span class="fm">__str__</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>                <span class="p">)</span> <span class="o">-&gt;</span>    <span class="nb">str</span><span class="p">:</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">            This method returns a string representation of the object.</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">            This defines what will be shown when calling print on the object.</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">            In:</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="sd">                * self: Reference to the current object.</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="sd">            Out:</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">                * string: String representation of the object.</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>        <span class="c1"># Create the string</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;Game object:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Random seed: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span><span class="p">)</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Random seed for maze: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_maze</span><span class="p">)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Random seed for cheese: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_cheese</span><span class="p">)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Random seed for players: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_players</span><span class="p">)</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Maze width: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span><span class="p">)</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Maze height: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span><span class="p">)</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Cell percentage: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span><span class="p">)</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Wall percentage: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span><span class="p">)</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Mud percentage: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span><span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Mud range: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Fixed maze: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span><span class="p">)</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Random maze algorithm: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span><span class="p">)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Number of cheese: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span><span class="p">)</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Fixed cheese: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">)</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Render mode: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span><span class="p">)</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Render simplified: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span><span class="p">)</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  GUI speed: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__gui_speed</span><span class="p">)</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Trace length: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__trace_length</span><span class="p">)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Fullscreen: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fullscreen</span><span class="p">)</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Save path: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__save_path</span><span class="p">)</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Save game: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__save_game</span><span class="p">)</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Preprocessing time: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__preprocessing_time</span><span class="p">)</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Turn time: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__turn_time</span><span class="p">)</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Game mode: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span><span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Continue on error: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__continue_on_error</span><span class="p">)</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="k">return</span> <span class="n">string</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>    <span class="c1">#                                                            ATTRIBUTE ACCESSORS                                                            #</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>    <span class="nd">@property</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>    <span class="k">def</span> <span class="nf">maze</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>             <span class="p">)</span> <span class="o">-&gt;</span>    <span class="n">Maze</span><span class="p">:</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="w">        </span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">            Getter for __maze.</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">            It returns a copy of the maze attribute.</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">            In:</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">                * self: Reference to the current object.</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">            Out:</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a><span class="sd">                * maze_copy: Copy of the __maze attribute.</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>        <span class="c1"># Return the attribute</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="n">maze_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="k">return</span> <span class="n">maze_copy</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>    
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>    <span class="c1">#                                                              PUBLIC METHODS                                                              #</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>    <span class="k">def</span> <span class="nf">add_player</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>     <span class="n">Self</span><span class="p">,</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>                     <span class="n">player</span><span class="p">:</span>   <span class="n">Player</span><span class="p">,</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>                     <span class="n">team</span><span class="p">:</span>     <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>                     <span class="n">location</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">StartingLocation</span><span class="p">,</span> <span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">CENTER</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>                   <span class="p">)</span> <span class="o">-&gt;</span>        <span class="kc">None</span><span class="p">:</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a><span class="w">        </span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">            Adds a player to the game.</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">            In:</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">                * self:     Reference to the current object.</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">                * player:   Player to add.</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">                * team:     Team of the player.</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">                * location: Controls initial location of the player (fixed index, or value of the StartingLocation enumeration).</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">            Out:</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="sd">                * None.</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>        <span class="c1"># Debug</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">Player</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;player&#39; must be of type &#39;pyrat.Player&#39;&quot;</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">team</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;team&#39; must be a string&quot;</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="p">(</span><span class="n">StartingLocation</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)),</span> <span class="s2">&quot;Argument &#39;location&#39; must be of type &#39;pyrat.StartingLocation&#39; or an integer, corresponding to the index of the cell where the player should start&quot;</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="k">assert</span> <span class="n">location</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">StartingLocation</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_exists</span><span class="p">(</span><span class="n">location</span><span class="p">)),</span> <span class="s2">&quot;Argument &#39;location&#39; must be a valid index of the maze or a value of the &#39;pyrat.StartingLocation&#39; enumeration&quot;</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>        <span class="k">assert</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span><span class="p">,</span> <span class="s2">&quot;Player &#39;</span><span class="si">%s</span><span class="s2">&#39; was already added to the game&quot;</span> <span class="o">%</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>        <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">SAME</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;Cannot start player &#39;</span><span class="si">%s</span><span class="s2">&#39; at the same location as the previous player if no player was added before&quot;</span> <span class="o">%</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="c1"># Set initial location</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players_asked_location</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="n">corrected_location</span> <span class="o">=</span> <span class="n">location</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>        <span class="k">if</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">RANDOM</span><span class="p">:</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players_rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">SAME</span><span class="p">:</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">CENTER</span><span class="p">:</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">:</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">:</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">:</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">:</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="c1"># If the location is not reachable, we choose the closest reachable location</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_exists</span><span class="p">(</span><span class="n">corrected_location</span><span class="p">):</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">corrected_location</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="n">valid_cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>            <span class="n">distances</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_to_rc</span><span class="p">(</span><span class="n">corrected_location</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_to_rc</span><span class="p">(</span><span class="n">cell</span><span class="p">))</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">valid_cells</span><span class="p">]</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="n">_</span><span class="p">,</span> <span class="n">argmin_distance</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">val</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_cells</span><span class="p">[</span><span class="n">argmin_distance</span><span class="p">]</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>        <span class="c1"># Append to team</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>        <span class="k">if</span> <span class="n">team</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">:</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>        <span class="c1"># Initialize other elements of game state</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">score_per_player</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>        <span class="c1"># Other attributes</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>        
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>    
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>    <span class="k">def</span> <span class="nf">reset</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>         <span class="n">Self</span><span class="p">,</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>                <span class="n">keep_players</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>              <span class="p">)</span> <span class="o">-&gt;</span>            <span class="kc">None</span><span class="p">:</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="w">        </span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">            Resets the game to its initial state.</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">            If random seeds were set, they will be kept, otherwise they will be randomly generated using the configuration provided when the game was created.</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">            If asked, it will keep players and will insert them as they were added.</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">            In:</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">                * self: Reference to the current object.</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">            Out:</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">                * None.</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>        
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>        <span class="c1"># Debug</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keep_players</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;keep_players&#39; must be a boolean&quot;</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="c1"># Set random seeds for the game</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_maze</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_cheese</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_cheese</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_players</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_players</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_players</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players_rng</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">Random</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_players</span><span class="p">)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>        
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>        <span class="c1"># Reset game analysis elements</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>        
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>        <span class="c1"># Initialize the maze</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">MazeFromDict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span><span class="p">)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">MazeFromMatrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span><span class="p">)</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span> <span class="o">==</span> <span class="n">RandomMazeAlgorithm</span><span class="o">.</span><span class="n">UNIFORM_HOLES</span><span class="p">:</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">UniformHolesRandomMaze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span><span class="p">)</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span> <span class="o">==</span> <span class="n">RandomMazeAlgorithm</span><span class="o">.</span><span class="n">HOLES_ON_SIDE</span><span class="p">:</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">HolesOnSideRandomMaze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span><span class="p">)</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span> <span class="o">==</span> <span class="n">RandomMazeAlgorithm</span><span class="o">.</span><span class="n">BIG_HOLES</span><span class="p">:</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">BigHolesRandomMaze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span><span class="p">)</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>        <span class="c1"># Initialize the rendering engine</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="n">RenderMode</span><span class="o">.</span><span class="n">ASCII</span><span class="p">,</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">ANSI</span><span class="p">]:</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>            <span class="n">use_colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">ANSI</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span> <span class="o">=</span> <span class="n">ShellRenderingEngine</span><span class="p">(</span><span class="n">use_colors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span><span class="p">)</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span><span class="p">:</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span> <span class="o">=</span> <span class="n">PygameRenderingEngine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fullscreen</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__trace_length</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_speed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span><span class="p">)</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">NO_RENDERING</span><span class="p">:</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span> <span class="o">=</span> <span class="n">RenderingEngine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span><span class="p">)</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>        
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>        <span class="c1"># Initialize the game state</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>        <span class="n">previous_initial_state</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="p">)</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">()</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>        <span class="c1"># Add players as they were added</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">)):</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>            <span class="n">player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>            <span class="n">player_asked_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players_asked_location</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>            <span class="k">if</span> <span class="n">keep_players</span><span class="p">:</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>                <span class="n">player_team</span> <span class="o">=</span> <span class="p">[</span><span class="n">team</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">previous_initial_state</span><span class="o">.</span><span class="n">teams</span> <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">previous_initial_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_player</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">player_team</span><span class="p">,</span> <span class="n">player_asked_location</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>        <span class="c1"># Indicate that the game was reset</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__reset_called</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>    <span class="k">def</span> <span class="nf">start</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>              <span class="p">)</span> <span class="o">-&gt;</span>    <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">            Starts a game, asking players for decisions until the game is over.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">            In:</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">                * self: Reference to the current object.</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">            Out:</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">                * stats: Game statistics computed during the game.</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>        
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>        <span class="c1"># Debug</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;No player was added to the game&quot;</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">__reset_called</span><span class="p">,</span> <span class="s2">&quot;The game was not reset before starting&quot;</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>        <span class="c1"># We catch exceptions that may happen during the game</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>        
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>            <span class="c1"># Mark the game as not reset</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__reset_called</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>            <span class="c1"># Initialize stats</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>            <span class="n">stats</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;players&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;turns&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>            <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>                                                 <span class="s2">&quot;preprocessing_duration&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>                                                 <span class="s2">&quot;turn_durations&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>                                                 <span class="s2">&quot;team&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">team</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span> <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>                                                 <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">Action</span><span class="o">.</span><span class="n">NOTHING</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>                                                             <span class="n">Action</span><span class="o">.</span><span class="n">NORTH</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>                                                             <span class="n">Action</span><span class="o">.</span><span class="n">EAST</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>                                                             <span class="n">Action</span><span class="o">.</span><span class="n">SOUTH</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>                                                             <span class="n">Action</span><span class="o">.</span><span class="n">WEST</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>                                                             <span class="s2">&quot;mud&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>                                                             <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>                                                             <span class="s2">&quot;miss&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>                                                             <span class="s2">&quot;wall&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">}}</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>            
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>            <span class="c1"># In multiprocessing mode, prepare processes</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>            <span class="n">maze_per_player</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="p">)</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">,</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">]:</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>                <span class="c1"># Create a process per player</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>                <span class="n">turn_start_synchronizer</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Barrier</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>                <span class="n">turn_timeout_lock</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>                <span class="n">player_processes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>                    <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;process&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;input_queue&quot;</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Queue</span><span class="p">(),</span> <span class="s2">&quot;output_queue&quot;</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Queue</span><span class="p">(),</span> <span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Barrier</span><span class="p">(</span><span class="mi">2</span><span class="p">)}</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>                    <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;process&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_player_process_function</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">maze_per_player</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;input_queue&quot;</span><span class="p">],</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">],</span> <span class="n">turn_start_synchronizer</span><span class="p">,</span> <span class="n">turn_timeout_lock</span><span class="p">,</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,))</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>                    <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;process&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>                <span class="c1"># If playing in standard mode, we create processs to wait instead of missing players</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">:</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>                    <span class="n">waiter_processes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>                        <span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;process&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;input_queue&quot;</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Queue</span><span class="p">()}</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>                        <span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;process&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_waiter_process_function</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;input_queue&quot;</span><span class="p">],</span> <span class="n">turn_start_synchronizer</span><span class="p">,))</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>                        <span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;process&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>            <span class="c1"># Add cheese</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>            <span class="n">available_cells</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">vertices</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">cheese</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__distribute_cheese</span><span class="p">(</span><span class="n">available_cells</span><span class="p">))</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>            <span class="n">game_state</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="p">)</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>            
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>            <span class="c1"># Initial rendering of the maze</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="p">,</span> <span class="n">game_state</span><span class="p">)</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>            
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>            <span class="c1"># We play until the game is over</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>            <span class="n">players_ready</span> <span class="o">=</span> <span class="p">[</span><span class="n">player</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">]</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>            <span class="n">players_running</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="kc">True</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>            <span class="n">all_action_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">action</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">Action</span><span class="p">]</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>            <span class="k">while</span> <span class="nb">any</span><span class="p">(</span><span class="n">players_running</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>                <span class="c1"># We communicate the state of the game to the players not in mud</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>                <span class="n">game_phases</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>                <span class="n">turn_actions</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="s2">&quot;miss&quot;</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>                <span class="n">durations</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>                <span class="k">for</span> <span class="n">ready_player</span> <span class="ow">in</span> <span class="n">players_ready</span><span class="p">:</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>                    <span class="n">final_stats</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span> <span class="k">if</span> <span class="n">game_state</span><span class="o">.</span><span class="n">game_over</span><span class="p">()</span> <span class="k">else</span> <span class="p">{}</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>                    <span class="n">player_game_state</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">game_state</span><span class="p">)</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">,</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">]:</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>                        <span class="n">player_processes</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;input_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">player_game_state</span><span class="p">,</span> <span class="n">final_stats</span><span class="p">))</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>                        <span class="n">turn_actions</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">durations</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_player_process_function</span><span class="p">(</span><span class="n">ready_player</span><span class="p">,</span> <span class="n">maze_per_player</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">player_game_state</span><span class="p">,</span> <span class="n">final_stats</span><span class="p">)</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>                
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>                <span class="c1"># In multiprocessing mode, we for everybody to receive data to start</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>                <span class="c1"># In sequential mode, decisions are already received at this point</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">,</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">]:</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>                    <span class="n">turn_start_synchronizer</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>                <span class="c1"># Wait a bit</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>                <span class="n">sleep_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__preprocessing_time</span> <span class="k">if</span> <span class="n">game_state</span><span class="o">.</span><span class="n">turn</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">__turn_time</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>                <span class="c1"># In synchronous mode, we wait for everyone</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>                        <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>                        <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>                <span class="c1"># In standard mode, we block the possibility to return an action and check who answered in time</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">:</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>                    <span class="c1"># Wait at least for those in mud</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>                        <span class="k">if</span> <span class="n">game_state</span><span class="o">.</span><span class="n">is_in_mud</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">players_running</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]:</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>                            <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>                            <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>                    <span class="c1"># For others, set timeout and wait for output info of those who passed just before timeout</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>                    <span class="k">with</span> <span class="n">turn_timeout_lock</span><span class="p">:</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>                        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">game_state</span><span class="o">.</span><span class="n">is_in_mud</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">players_running</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]:</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>                                    <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>                                    <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>                <span class="c1"># Check which players are ready to continue</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>                <span class="n">players_ready</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>                    <span class="k">if</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;postprocessing&quot;</span><span class="p">:</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>                        <span class="n">players_running</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span> <span class="ow">and</span> <span class="p">(</span><span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;postprocessing&quot;</span> <span class="ow">or</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;miss&quot;</span><span class="p">):</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>                        <span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;input_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>                        <span class="n">players_ready</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>                <span class="c1"># Check for errors</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>                <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">])</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__continue_on_error</span><span class="p">:</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;A player has crashed, exiting&quot;</span><span class="p">)</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>                <span class="c1"># We save the turn info if we are not postprocessing</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">game_state</span><span class="o">.</span><span class="n">game_over</span><span class="p">():</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>                
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>                    <span class="c1"># Apply the actions</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>                    <span class="n">corrected_actions</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">Action</span><span class="p">(</span><span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span> <span class="k">if</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">in</span> <span class="n">all_action_names</span> <span class="k">else</span> <span class="n">Action</span><span class="o">.</span><span class="n">NOTHING</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>                    <span class="n">new_game_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__determine_new_game_state</span><span class="p">(</span><span class="n">game_state</span><span class="p">,</span> <span class="n">corrected_actions</span><span class="p">)</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>                    <span class="c1"># Save stats</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>                        <span class="k">if</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>                            <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="s2">&quot;miss&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>                        <span class="k">elif</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;preprocessing&quot;</span><span class="p">:</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>                            <span class="k">if</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">in</span> <span class="n">all_action_names</span> <span class="ow">and</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Action</span><span class="o">.</span><span class="n">NOTHING</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="n">game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">is_in_mud</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>                                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="s2">&quot;wall&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>                                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>                            <span class="k">if</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;mud&quot;</span><span class="p">:</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corrected_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>                        <span class="k">if</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>                            <span class="k">if</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;preprocessing&quot;</span><span class="p">:</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>                                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;preprocessing_duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>                                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_durations&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>                        <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">score_per_player</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>                    <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;turns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">game_state</span><span class="o">.</span><span class="n">turn</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>                    
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>                    <span class="c1"># Go to next turn</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="p">,</span> <span class="n">new_game_state</span><span class="p">)</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>                    <span class="n">game_state</span> <span class="o">=</span> <span class="n">new_game_state</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>        <span class="c1"># In case of an error, we ignore stats</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>            <span class="n">stats</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a>        
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>        <span class="c1"># Apply end actions before returning</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__end</span><span class="p">(</span><span class="n">stats</span> <span class="o">==</span> <span class="p">{})</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>        <span class="k">return</span> <span class="n">stats</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>    <span class="c1">#                                                              PRIVATE METHODS                                                              #</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>    <span class="k">def</span> <span class="nf">__end</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>         <span class="n">Self</span><span class="p">,</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>                <span class="n">game_crashed</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>              <span class="p">)</span> <span class="o">-&gt;</span>            <span class="kc">None</span><span class="p">:</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a><span class="w">        </span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a><span class="sd">            Actions to do at the end of the game if needed.</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a><span class="sd">            In:</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a><span class="sd">                * self:         Reference to the current object.</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a><span class="sd">                * game_crashed: Indicates if the game crashed.</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a><span class="sd">            Out:</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a><span class="sd">                * None.</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>        <span class="c1"># Debug</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">game_crashed</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;game_crashed&#39; must be a boolean&quot;</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>        <span class="c1"># We save the game if asked</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__save_game</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">game_crashed</span><span class="p">:</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>            
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>            <span class="c1"># Create the saves directory if needed</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__save_path</span><span class="p">):</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__save_path</span><span class="p">)</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>            <span class="c1"># Prepare the config dictionary</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;game_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{GAME_MODE}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>                      <span class="s2">&quot;fixed_maze&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">as_dict</span><span class="p">(),</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>                      <span class="s2">&quot;fixed_cheese&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">cheese</span><span class="p">}</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>            
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>            <span class="c1"># Create a description of the players</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>            <span class="n">player_descriptions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>            <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>                <span class="n">player_descriptions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>                                            <span class="s2">&quot;skin&quot;</span><span class="p">:</span> <span class="s2">&quot;{SKIN_&quot;</span> <span class="o">+</span> <span class="n">player</span><span class="o">.</span><span class="n">skin</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>                                            <span class="s2">&quot;team&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">team</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span> <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>                                            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>                                            <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="s2">&quot;{ACTIONS_&quot;</span> <span class="o">+</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">})</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>            <span class="c1"># Create the players&#39; file, forcing players to their initial locations</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>            <span class="n">output_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__save_path</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y_%m_</span><span class="si">%d</span><span class="s2">_%H_%M_%S_</span><span class="si">%f</span><span class="s2">.ipynb&quot;</span><span class="p">))</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s2">&quot;save_template.ipynb&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">save_template_file</span><span class="p">:</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>                <span class="n">save_template</span> <span class="o">=</span> <span class="n">save_template_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>                <span class="n">save_template</span> <span class="o">=</span> <span class="n">save_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{PLAYERS}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">player_descriptions</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;}, &quot;</span><span class="p">,</span> <span class="s2">&quot;},</span><span class="se">\\</span><span class="s2">n                       &quot;</span><span class="p">))</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>                <span class="n">save_template</span> <span class="o">=</span> <span class="n">save_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{CONFIG}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;, &#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;,</span><span class="se">\\</span><span class="s2">n          &#39;&quot;</span><span class="p">))</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>                <span class="n">save_template</span> <span class="o">=</span> <span class="n">save_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">{GAME_MODE}</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;GameMode.SYNCHRONOUS&quot;</span><span class="p">)</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>                <span class="k">for</span> <span class="n">skin</span> <span class="ow">in</span> <span class="n">PlayerSkin</span><span class="p">:</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>                    <span class="n">save_template</span> <span class="o">=</span> <span class="n">save_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;{SKIN_&quot;</span> <span class="o">+</span> <span class="n">skin</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;}&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;PlayerSkin.&quot;</span> <span class="o">+</span> <span class="n">skin</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>                    <span class="n">save_template</span> <span class="o">=</span> <span class="n">save_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;{ACTIONS_&quot;</span> <span class="o">+</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;}&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;Action.&quot;</span> <span class="o">+</span> <span class="n">action</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">)</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file_name</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">save_template</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">output_file</span><span class="p">)</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>        <span class="c1"># Apply ending actions of the rendering engine</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>        
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>    <span class="k">def</span> <span class="nf">__determine_new_game_state</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>       <span class="n">Self</span><span class="p">,</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>                                     <span class="n">game_state</span><span class="p">:</span> <span class="n">GameState</span><span class="p">,</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>                                     <span class="n">actions</span><span class="p">:</span>    <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Action</span><span class="p">]</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>                                   <span class="p">)</span> <span class="o">-&gt;</span>          <span class="n">GameState</span><span class="p">:</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a><span class="w">        </span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a><span class="sd">            Updates the game state after a turn, given decisions of players.</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a><span class="sd">            In:</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a><span class="sd">                * self:       Reference to the current object.</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a><span class="sd">                * game_state: Current game state.</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a><span class="sd">                * actions:    Action performed per player.</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a><span class="sd">            Out:</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a><span class="sd">                * new_game_state: New game state after the turn.</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>        <span class="c1"># Debug</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">game_state</span><span class="p">,</span> <span class="n">GameState</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;game_state&#39; must be of type &#39;pyrat.GameState&#39;&quot;</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;actions&#39; must be a dictionary&quot;</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">player_name</span> <span class="ow">in</span> <span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">]</span> <span class="k">for</span> <span class="n">player_name</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">),</span> <span class="s2">&quot;All players must be in the game&quot;</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">action</span> <span class="ow">in</span> <span class="n">Action</span> <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">actions</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="s2">&quot;All actions must be of type &#39;pyrat.Action&#39;&quot;</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>        <span class="c1"># Initialize new game state</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>        <span class="n">new_game_state</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">game_state</span><span class="p">)</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>        <span class="n">new_game_state</span><span class="o">.</span><span class="n">turn</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a>        <span class="c1"># Move all players accordingly</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a>            <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_to_rc</span><span class="p">(</span><span class="n">game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>            <span class="n">target</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>            <span class="k">if</span> <span class="n">actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">Action</span><span class="o">.</span><span class="n">NORTH</span> <span class="ow">and</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>                <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a>            <span class="k">elif</span> <span class="n">actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">Action</span><span class="o">.</span><span class="n">SOUTH</span> <span class="ow">and</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a>                <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>            <span class="k">elif</span> <span class="n">actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">Action</span><span class="o">.</span><span class="n">WEST</span> <span class="ow">and</span> <span class="n">col</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>                <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>            <span class="k">elif</span> <span class="n">actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">Action</span><span class="o">.</span><span class="n">EAST</span> <span class="ow">and</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>                <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>            <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_exists</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">target</span><span class="p">):</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>                <span class="n">weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">get_weight</span><span class="p">(</span><span class="n">game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">target</span><span class="p">)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>                <span class="k">if</span> <span class="n">weight</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>                    <span class="n">new_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>                <span class="k">elif</span> <span class="n">weight</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>                    <span class="n">new_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>                    <span class="n">new_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>        <span class="c1"># All players in mud advance a bit</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>            <span class="k">if</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">is_in_mud</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>                <span class="n">new_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>                <span class="k">if</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>                    <span class="n">new_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>                    <span class="n">new_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>        <span class="c1"># Update cheese and scores</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">game_state</span><span class="o">.</span><span class="n">cheese</span><span class="p">:</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>            <span class="n">players_on_cheese</span> <span class="o">=</span> <span class="p">[</span><span class="n">player</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span> <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]]</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a>            <span class="k">for</span> <span class="n">player_on_cheese</span> <span class="ow">in</span> <span class="n">players_on_cheese</span><span class="p">:</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a>                <span class="n">new_game_state</span><span class="o">.</span><span class="n">score_per_player</span><span class="p">[</span><span class="n">player_on_cheese</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">players_on_cheese</span><span class="p">)</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">players_on_cheese</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a>                <span class="n">new_game_state</span><span class="o">.</span><span class="n">cheese</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a>        
</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a>        <span class="c1"># Store trace for GUI</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a>        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">__trace_length</span><span class="p">:]</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a>        
</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a>        <span class="c1"># Return new game state</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a>        <span class="k">return</span> <span class="n">new_game_state</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos">741</span></a>        
</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos">743</span></a>
</span><span id="L-744"><a href="#L-744"><span class="linenos">744</span></a>    <span class="k">def</span> <span class="nf">__distribute_cheese</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>            <span class="n">Self</span><span class="p">,</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos">745</span></a>                              <span class="n">available_cells</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Integral</span><span class="p">],</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos">746</span></a>                            <span class="p">)</span> <span class="o">-&gt;</span>               <span class="n">List</span><span class="p">[</span><span class="n">Integral</span><span class="p">]:</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos">747</span></a><span class="w">        </span>
</span><span id="L-748"><a href="#L-748"><span class="linenos">748</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos">749</span></a><span class="sd">            Distributes pieces of cheese in the maze, according to the provided criteria.</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos">750</span></a><span class="sd">            If a fixed list of cheese was provided, it is used.</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos">751</span></a><span class="sd">            Otherwise, the cheese is distributed randomly.</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos">752</span></a><span class="sd">            In:</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos">753</span></a><span class="sd">                * self:            Reference to the current object.</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos">754</span></a><span class="sd">                * available_cells: List of indices of cells that can be used to place cheese.</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos">755</span></a><span class="sd">            Out:</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos">756</span></a><span class="sd">                * cheese: List of indices of cells containing cheese.</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos">757</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos">758</span></a>        
</span><span id="L-759"><a href="#L-759"><span class="linenos">759</span></a>        <span class="c1"># Debug</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos">760</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">available_cells</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;available_cells&#39; must be a list&quot;</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos">761</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">available_cells</span><span class="p">]),</span> <span class="s2">&quot;All elements of &#39;available_cells&#39; must be integers&quot;</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos">762</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_exists</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">available_cells</span><span class="p">]),</span> <span class="s2">&quot;All elements of &#39;available_cells&#39; must be valid indices of the maze&quot;</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos">763</span></a>
</span><span id="L-764"><a href="#L-764"><span class="linenos">764</span></a>        <span class="c1"># If we ask for a fixed list of cheese, we use it</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos">765</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos">766</span></a>            
</span><span id="L-767"><a href="#L-767"><span class="linenos">767</span></a>            <span class="c1"># Debug</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos">768</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="s2">&quot;Attribute &#39;__fixed_cheese&#39; must be a list&quot;</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos">769</span></a>            <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">]),</span> <span class="s2">&quot;All elements of &#39;__fixed_cheese&#39; must be integers&quot;</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos">770</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">),</span> <span class="s2">&quot;All elements of &#39;__fixed_cheese&#39; must be unique&quot;</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos">771</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">available_cells</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">),</span> <span class="s2">&quot;Not enough available cells to place the fixed cheese&quot;</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos">772</span></a>            <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_exists</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">]),</span> <span class="s2">&quot;All elements of &#39;__fixed_cheese&#39; must be valid indices of the maze&quot;</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos">773</span></a>            <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">cell</span> <span class="ow">in</span> <span class="n">available_cells</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">]),</span> <span class="s2">&quot;All elements of &#39;__fixed_cheese&#39; must be in &#39;available_cells&#39;&quot;</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos">774</span></a>
</span><span id="L-775"><a href="#L-775"><span class="linenos">775</span></a>            <span class="c1"># Place the cheese</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos">776</span></a>            <span class="n">cheese</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">)</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos">777</span></a>
</span><span id="L-778"><a href="#L-778"><span class="linenos">778</span></a>        <span class="c1"># Otherwise, we place the cheese randomly</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos">779</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos">780</span></a>            
</span><span id="L-781"><a href="#L-781"><span class="linenos">781</span></a>            <span class="c1"># Debug</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos">782</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span><span class="p">,</span> <span class="n">Integral</span><span class="p">),</span> <span class="s2">&quot;Attribute &#39;__nb_cheese&#39; must be an integer&quot;</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Attribute &#39;__nb_cheese&#39; must be positive&quot;</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos">784</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">available_cells</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span><span class="p">,</span> <span class="s2">&quot;Not enough available cells to place the cheese&quot;</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos">785</span></a>
</span><span id="L-786"><a href="#L-786"><span class="linenos">786</span></a>            <span class="c1"># Place the cheese randomly</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos">787</span></a>            <span class="n">rng</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">Random</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_cheese</span><span class="p">)</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos">788</span></a>            <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">available_cells</span><span class="p">)</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos">789</span></a>            <span class="n">cheese</span> <span class="o">=</span> <span class="n">available_cells</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span><span class="p">]</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos">790</span></a>
</span><span id="L-791"><a href="#L-791"><span class="linenos">791</span></a>        <span class="c1"># Return the cheese</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos">792</span></a>        <span class="k">return</span> <span class="n">cheese</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos">793</span></a>
</span><span id="L-794"><a href="#L-794"><span class="linenos">794</span></a><span class="c1">#####################################################################################################################################################</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos">795</span></a><span class="c1">##################################################################### FUNCTIONS #####################################################################</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos">796</span></a><span class="c1">#####################################################################################################################################################</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos">797</span></a>
</span><span id="L-798"><a href="#L-798"><span class="linenos">798</span></a><span class="k">def</span> <span class="nf">_player_process_function</span> <span class="p">(</span> <span class="n">player</span><span class="p">:</span>                  <span class="n">Player</span><span class="p">,</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos">799</span></a>                               <span class="n">maze</span><span class="p">:</span>                    <span class="n">Maze</span><span class="p">,</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos">800</span></a>                               <span class="n">input_queue</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Queue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos">801</span></a>                               <span class="n">output_queue</span><span class="p">:</span>            <span class="n">Optional</span><span class="p">[</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Queue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos">802</span></a>                               <span class="n">turn_start_synchronizer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Barrier</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos">803</span></a>                               <span class="n">turn_timeout_lock</span><span class="p">:</span>       <span class="n">Optional</span><span class="p">[</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Lock</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos">804</span></a>                               <span class="n">turn_end_synchronizer</span><span class="p">:</span>   <span class="n">Optional</span><span class="p">[</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Barrier</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos">805</span></a>                               <span class="n">game_state</span><span class="p">:</span>              <span class="n">Optional</span><span class="p">[</span><span class="n">GameState</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos">806</span></a>                               <span class="n">final_stats</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos">807</span></a>                             <span class="p">)</span> <span class="o">-&gt;</span>                       <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos">808</span></a><span class="w">    </span>
</span><span id="L-809"><a href="#L-809"><span class="linenos">809</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos">810</span></a><span class="sd">        This function is executed in a separate process per player.</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos">811</span></a><span class="sd">        It handles the communication with the player and calls the functions given as arguments.</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos">812</span></a><span class="sd">        It is defined outside of the class due to multiprocessing limitations.</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos">813</span></a><span class="sd">        If not using multiprocessing, the function returns the action and the duration of the turn.</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos">814</span></a><span class="sd">        In:</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos">815</span></a><span class="sd">            * player:                  Player controlled by the process.</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos">816</span></a><span class="sd">            * maze:                    Maze in which the player plays.</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos">817</span></a><span class="sd">            * input_queue:             Queue to receive the game state (set if multiprocessing).</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos">818</span></a><span class="sd">            * output_queue:            Queue to send the action (set if multiprocessing).</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos">819</span></a><span class="sd">            * turn_start_synchronizer: Barrier to synchronize the start of the turn (set if multiprocessing).</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos">820</span></a><span class="sd">            * turn_timeout_lock:       Lock to synchronize the timeout of the turn (set if multiprocessing).</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos">821</span></a><span class="sd">            * turn_end_synchronizer:   Barrier to synchronize the end of the turn (set if multiprocessing).</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos">822</span></a><span class="sd">            * game_state:              Initial game state (set if sequential).</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos">823</span></a><span class="sd">            * final_stats:             Final stats (set if sequential).</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos">824</span></a><span class="sd">        Out:</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos">825</span></a><span class="sd">            * action:     Action performed by the player.</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos">826</span></a><span class="sd">            * game_phase: Phase of the game in which the player is.</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos">827</span></a><span class="sd">            * duration:   Duration of the turn.</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos">828</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos">829</span></a>
</span><span id="L-830"><a href="#L-830"><span class="linenos">830</span></a>    <span class="c1"># Debug</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos">831</span></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">Player</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;player&#39; must be of type &#39;pyrat.Player&#39;&quot;</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos">832</span></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">Maze</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;maze&#39; must be of type &#39;pyrat.Maze&#39;&quot;</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos">833</span></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_queue</span><span class="p">,</span> <span class="p">(</span><span class="n">mpmanagers</span><span class="o">.</span><span class="n">BaseProxy</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;input_queue&#39; must be of type &#39;multiprocessing.Queue&#39; or None&quot;</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos">834</span></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_queue</span><span class="p">,</span> <span class="p">(</span><span class="n">mpmanagers</span><span class="o">.</span><span class="n">BaseProxy</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;output_queue&#39; must be of type &#39;multiprocessing.Queue&#39; or None&quot;</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos">835</span></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">turn_start_synchronizer</span><span class="p">,</span> <span class="p">(</span><span class="n">mpmanagers</span><span class="o">.</span><span class="n">BarrierProxy</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;turn_start_synchronizer&#39; must be of type &#39;multiprocessing.Barrier&#39; or None&quot;</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos">836</span></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">turn_timeout_lock</span><span class="p">,</span> <span class="p">(</span><span class="n">mpmanagers</span><span class="o">.</span><span class="n">AcquirerProxy</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;turn_timeout_lock&#39; must be of type &#39;multiprocessing.Lock&#39; or None&quot;</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos">837</span></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">turn_end_synchronizer</span><span class="p">,</span> <span class="p">(</span><span class="n">mpmanagers</span><span class="o">.</span><span class="n">BarrierProxy</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;turn_end_synchronizer&#39; must be of type &#39;multiprocessing.Barrier&#39; or None&quot;</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos">838</span></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">game_state</span><span class="p">,</span> <span class="p">(</span><span class="n">GameState</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;game_state&#39; must be of type &#39;pyrat.GameState&#39; or None&quot;</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos">839</span></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_stats</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;final_stats&#39; must be of type &#39;dict&#39; or None&quot;</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos">840</span></a>    <span class="k">assert</span> <span class="n">final_stats</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">final_stats</span><span class="p">),</span> <span class="s2">&quot;Keys of &#39;final_stats&#39; must be strings&quot;</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos">841</span></a>    <span class="k">assert</span> <span class="p">(</span><span class="n">input_queue</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">output_queue</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">turn_start_synchronizer</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">turn_timeout_lock</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">turn_end_synchronizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">game_state</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">final_stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">),</span> <span class="s2">&quot;Some arguments are for multiprocessing mode, and others for sequential mode&quot;</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos">842</span></a>    
</span><span id="L-843"><a href="#L-843"><span class="linenos">843</span></a>    <span class="c1"># We catch exceptions that may happen during the game</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos">844</span></a>    <span class="n">use_multiprocessing</span> <span class="o">=</span> <span class="n">input_queue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos">845</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos">846</span></a>
</span><span id="L-847"><a href="#L-847"><span class="linenos">847</span></a>        <span class="c1"># Main loop</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos">848</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos">849</span></a>            
</span><span id="L-850"><a href="#L-850"><span class="linenos">850</span></a>            <span class="c1"># In multiprocessing, wait for all players ready</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos">851</span></a>            <span class="k">if</span> <span class="n">use_multiprocessing</span><span class="p">:</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos">852</span></a>                <span class="n">turn_start_synchronizer</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos">853</span></a>                <span class="n">game_state</span><span class="p">,</span> <span class="n">final_stats</span> <span class="o">=</span> <span class="n">input_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos">854</span></a>            
</span><span id="L-855"><a href="#L-855"><span class="linenos">855</span></a>            <span class="c1"># Call the correct function</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos">856</span></a>            <span class="n">game_phase</span> <span class="o">=</span> <span class="s2">&quot;turn&quot;</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos">857</span></a>            <span class="n">duration</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos">858</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos">859</span></a>                
</span><span id="L-860"><a href="#L-860"><span class="linenos">860</span></a>                <span class="c1"># Call postprocessing once the game is over</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos">861</span></a>                <span class="k">if</span> <span class="n">final_stats</span><span class="p">:</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos">862</span></a>                    <span class="n">game_phase</span> <span class="o">=</span> <span class="s2">&quot;postprocessing&quot;</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos">863</span></a>                    <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos">864</span></a>                    <span class="n">player</span><span class="o">.</span><span class="n">postprocessing</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">game_state</span><span class="p">,</span> <span class="n">final_stats</span><span class="p">)</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos">865</span></a>                    <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;ignore&quot;</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos">866</span></a>                    
</span><span id="L-867"><a href="#L-867"><span class="linenos">867</span></a>                <span class="c1"># If in mud, we return immediately (main process will wait for us in all cases)</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos">868</span></a>                <span class="k">elif</span> <span class="n">game_state</span><span class="o">.</span><span class="n">is_in_mud</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos">869</span></a>                    <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;mud&quot;</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos">870</span></a>                
</span><span id="L-871"><a href="#L-871"><span class="linenos">871</span></a>                <span class="c1"># Otherwise, we ask for an action</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos">872</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos">873</span></a>                
</span><span id="L-874"><a href="#L-874"><span class="linenos">874</span></a>                    <span class="c1"># Measure start time</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos">875</span></a>                    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos">876</span></a>                    
</span><span id="L-877"><a href="#L-877"><span class="linenos">877</span></a>                    <span class="c1"># Go</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos">878</span></a>                    <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos">879</span></a>                    <span class="k">if</span> <span class="n">game_state</span><span class="o">.</span><span class="n">turn</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos">880</span></a>                        <span class="n">game_phase</span> <span class="o">=</span> <span class="s2">&quot;preprocessing&quot;</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos">881</span></a>                        <span class="n">player</span><span class="o">.</span><span class="n">preprocessing</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">game_state</span><span class="p">)</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos">882</span></a>                        <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;ignore&quot;</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos">883</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos">884</span></a>                        <span class="n">a</span> <span class="o">=</span> <span class="n">player</span><span class="o">.</span><span class="n">turn</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">game_state</span><span class="p">)</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos">885</span></a>                        <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos">886</span></a>                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid action </span><span class="si">%s</span><span class="s2"> by player </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos">887</span></a>                        <span class="n">action</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos">888</span></a>                    
</span><span id="L-889"><a href="#L-889"><span class="linenos">889</span></a>                    <span class="c1"># Set end time</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos">890</span></a>                    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos">891</span></a>                    <span class="n">duration</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos">892</span></a>                        
</span><span id="L-893"><a href="#L-893"><span class="linenos">893</span></a>            <span class="c1"># Print error message in case of a crash</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos">894</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos">895</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Player </span><span class="si">%s</span><span class="s2"> has crashed with the following error:&quot;</span> <span class="o">%</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos">896</span></a>                <span class="nb">print</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos">897</span></a>                    
</span><span id="L-898"><a href="#L-898"><span class="linenos">898</span></a>            <span class="c1"># Turn is over</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos">899</span></a>            <span class="k">if</span> <span class="n">use_multiprocessing</span><span class="p">:</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos">900</span></a>                <span class="k">with</span> <span class="n">turn_timeout_lock</span><span class="p">:</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos">901</span></a>                    <span class="n">output_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">action</span><span class="p">,</span> <span class="n">game_phase</span><span class="p">,</span> <span class="n">duration</span><span class="p">))</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos">902</span></a>                <span class="n">turn_end_synchronizer</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos">903</span></a>                <span class="k">if</span> <span class="n">game_phase</span> <span class="o">==</span> <span class="s2">&quot;postprocessing&quot;</span><span class="p">:</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos">904</span></a>                    <span class="k">break</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos">905</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos">906</span></a>                <span class="k">return</span> <span class="n">action</span><span class="p">,</span> <span class="n">game_phase</span><span class="p">,</span> <span class="n">duration</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos">907</span></a>
</span><span id="L-908"><a href="#L-908"><span class="linenos">908</span></a>    <span class="c1"># Ignore</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos">909</span></a>    <span class="k">except</span><span class="p">:</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos">910</span></a>        <span class="k">pass</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos">911</span></a>
</span><span id="L-912"><a href="#L-912"><span class="linenos">912</span></a>    <span class="c1"># Default return when the process is killed</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos">913</span></a>    <span class="c1"># This is useless and there just to match the return type</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos">914</span></a>    <span class="k">return</span> <span class="s2">&quot;abort&quot;</span><span class="p">,</span> <span class="s2">&quot;any&quot;</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos">915</span></a>
</span><span id="L-916"><a href="#L-916"><span class="linenos">916</span></a><span class="c1">#####################################################################################################################################################</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos">917</span></a>
</span><span id="L-918"><a href="#L-918"><span class="linenos">918</span></a><span class="k">def</span> <span class="nf">_waiter_process_function</span> <span class="p">(</span> <span class="n">input_queue</span><span class="p">:</span>             <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Queue</span><span class="p">,</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos">919</span></a>                               <span class="n">turn_start_synchronizer</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Barrier</span><span class="p">,</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos">920</span></a>                             <span class="p">)</span> <span class="o">-&gt;</span>                       <span class="kc">None</span><span class="p">:</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos">921</span></a><span class="w">    </span>
</span><span id="L-922"><a href="#L-922"><span class="linenos">922</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos">923</span></a><span class="sd">        This function is executed in a separate process per player.</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos">924</span></a><span class="sd">        It handles the timeouts of the player.</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos">925</span></a><span class="sd">        It is defined outside of the class due to multiprocessing limitations.</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos">926</span></a><span class="sd">        In:</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos">927</span></a><span class="sd">            * input_queue:             Queue to receive the game state.</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos">928</span></a><span class="sd">            * turn_start_synchronizer: Barrier to synchronize the start of the turn.</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos">929</span></a><span class="sd">        Out:</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos">930</span></a><span class="sd">            * None.</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos">931</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos">932</span></a>
</span><span id="L-933"><a href="#L-933"><span class="linenos">933</span></a>    <span class="c1"># Debug</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos">934</span></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_queue</span><span class="p">,</span> <span class="n">mpmanagers</span><span class="o">.</span><span class="n">BaseProxy</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;input_queue&#39; must be of type &#39;multiprocessing.Queue&#39;&quot;</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos">935</span></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">turn_start_synchronizer</span><span class="p">,</span> <span class="n">mpmanagers</span><span class="o">.</span><span class="n">BarrierProxy</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;turn_start_synchronizer&#39; must be of type &#39;multiprocessing.Barrier&#39;&quot;</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos">936</span></a>
</span><span id="L-937"><a href="#L-937"><span class="linenos">937</span></a>    <span class="c1"># We catch exceptions that may happen during the game</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos">938</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos">939</span></a>
</span><span id="L-940"><a href="#L-940"><span class="linenos">940</span></a>        <span class="c1"># We just mark as ready</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos">941</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos">942</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="n">input_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos">943</span></a>            <span class="n">turn_start_synchronizer</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos">944</span></a>
</span><span id="L-945"><a href="#L-945"><span class="linenos">945</span></a>    <span class="c1"># Ignore</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos">946</span></a>    <span class="k">except</span><span class="p">:</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos">947</span></a>        <span class="k">pass</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos">948</span></a>
</span><span id="L-949"><a href="#L-949"><span class="linenos">949</span></a><span class="c1">#####################################################################################################################################################</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos">950</span></a><span class="c1">#####################################################################################################################################################</span>
</span></pre></div>


            </section>
                <section id="Game">
                            <input id="Game-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Game</span>:

                <label class="view-source-button" for="Game-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Game"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Game-51"><a href="#Game-51"><span class="linenos"> 51</span></a><span class="k">class</span> <span class="nc">Game</span> <span class="p">():</span>
</span><span id="Game-52"><a href="#Game-52"><span class="linenos"> 52</span></a>
</span><span id="Game-53"><a href="#Game-53"><span class="linenos"> 53</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game-54"><a href="#Game-54"><span class="linenos"> 54</span></a><span class="sd">        A game is a class that allows to play a game of PyRat.</span>
</span><span id="Game-55"><a href="#Game-55"><span class="linenos"> 55</span></a><span class="sd">        It is initialized with the parameters of the game.</span>
</span><span id="Game-56"><a href="#Game-56"><span class="linenos"> 56</span></a><span class="sd">        Players should then be added to the game using the add_player method.</span>
</span><span id="Game-57"><a href="#Game-57"><span class="linenos"> 57</span></a><span class="sd">        Finally, the start method should be called to start the game.</span>
</span><span id="Game-58"><a href="#Game-58"><span class="linenos"> 58</span></a><span class="sd">        Once the game is over, it will provide statistics about the game.</span>
</span><span id="Game-59"><a href="#Game-59"><span class="linenos"> 59</span></a><span class="sd">        Set your own parameters to define interesting objectives for the players.</span>
</span><span id="Game-60"><a href="#Game-60"><span class="linenos"> 60</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Game-61"><a href="#Game-61"><span class="linenos"> 61</span></a>
</span><span id="Game-62"><a href="#Game-62"><span class="linenos"> 62</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-63"><a href="#Game-63"><span class="linenos"> 63</span></a>    <span class="c1">#                                                              CLASS ATTRIBUTES                                                             #</span>
</span><span id="Game-64"><a href="#Game-64"><span class="linenos"> 64</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-65"><a href="#Game-65"><span class="linenos"> 65</span></a><span class="w">    </span>
</span><span id="Game-66"><a href="#Game-66"><span class="linenos"> 66</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game-67"><a href="#Game-67"><span class="linenos"> 67</span></a><span class="sd">        To ease creating games, we provide a set of default parameters.</span>
</span><span id="Game-68"><a href="#Game-68"><span class="linenos"> 68</span></a><span class="sd">        We do not put them in the constructor to be able to ckeck for valid configurations.</span>
</span><span id="Game-69"><a href="#Game-69"><span class="linenos"> 69</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Game-70"><a href="#Game-70"><span class="linenos"> 70</span></a>
</span><span id="Game-71"><a href="#Game-71"><span class="linenos"> 71</span></a>    <span class="n">DEFAULT_RANDOM_SEED</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-72"><a href="#Game-72"><span class="linenos"> 72</span></a>    <span class="n">DEFAULT_RANDOM_SEED_MAZE</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-73"><a href="#Game-73"><span class="linenos"> 73</span></a>    <span class="n">DEFAULT_RANDOM_SEED_CHEESE</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-74"><a href="#Game-74"><span class="linenos"> 74</span></a>    <span class="n">DEFAULT_RANDOM_SEED_PLAYERS</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-75"><a href="#Game-75"><span class="linenos"> 75</span></a>    <span class="n">DEFAULT_MAZE_WIDTH</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="Game-76"><a href="#Game-76"><span class="linenos"> 76</span></a>    <span class="n">DEFAULT_MAZE_HEIGHT</span> <span class="o">=</span> <span class="mi">13</span>
</span><span id="Game-77"><a href="#Game-77"><span class="linenos"> 77</span></a>    <span class="n">DEFAULT_CELL_PERCENTAGE</span> <span class="o">=</span> <span class="mf">80.0</span>
</span><span id="Game-78"><a href="#Game-78"><span class="linenos"> 78</span></a>    <span class="n">DEFAULT_WALL_PERCENTAGE</span> <span class="o">=</span> <span class="mf">60.0</span>
</span><span id="Game-79"><a href="#Game-79"><span class="linenos"> 79</span></a>    <span class="n">DEFAULT_MUD_PERCENTAGE</span> <span class="o">=</span> <span class="mf">20.0</span>
</span><span id="Game-80"><a href="#Game-80"><span class="linenos"> 80</span></a>    <span class="n">DEFAULT_MUD_RANGE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</span><span id="Game-81"><a href="#Game-81"><span class="linenos"> 81</span></a>    <span class="n">DEFAULT_FIXED_MAZE</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-82"><a href="#Game-82"><span class="linenos"> 82</span></a>    <span class="n">DEFAULT_RANDOM_MAZE_ALGORITHM</span> <span class="o">=</span> <span class="n">RandomMazeAlgorithm</span><span class="o">.</span><span class="n">BIG_HOLES</span>
</span><span id="Game-83"><a href="#Game-83"><span class="linenos"> 83</span></a>    <span class="n">DEFAULT_NB_CHEESE</span> <span class="o">=</span> <span class="mi">21</span>
</span><span id="Game-84"><a href="#Game-84"><span class="linenos"> 84</span></a>    <span class="n">DEFAULT_FIXED_CHEESE</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-85"><a href="#Game-85"><span class="linenos"> 85</span></a>    <span class="n">DEFAULT_RENDER_MODE</span> <span class="o">=</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span>
</span><span id="Game-86"><a href="#Game-86"><span class="linenos"> 86</span></a>    <span class="n">DEFAULT_RENDER_SIMPLIFIED</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Game-87"><a href="#Game-87"><span class="linenos"> 87</span></a>    <span class="n">DEFAULT_GUI_SPEED</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="Game-88"><a href="#Game-88"><span class="linenos"> 88</span></a>    <span class="n">DEFAULT_TRACE_LENGTH</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Game-89"><a href="#Game-89"><span class="linenos"> 89</span></a>    <span class="n">DEFAULT_FULLSCREEN</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Game-90"><a href="#Game-90"><span class="linenos"> 90</span></a>    <span class="n">DEFAULT_SAVE_PATH</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>
</span><span id="Game-91"><a href="#Game-91"><span class="linenos"> 91</span></a>    <span class="n">DEFAULT_SAVE_GAME</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Game-92"><a href="#Game-92"><span class="linenos"> 92</span></a>    <span class="n">DEFAULT_PREPROCESSING_TIME</span> <span class="o">=</span> <span class="mf">3.0</span>
</span><span id="Game-93"><a href="#Game-93"><span class="linenos"> 93</span></a>    <span class="n">DEFAULT_TURN_TIME</span> <span class="o">=</span> <span class="mf">0.1</span>
</span><span id="Game-94"><a href="#Game-94"><span class="linenos"> 94</span></a>    <span class="n">DEFAULT_GAME_MODE</span> <span class="o">=</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span>
</span><span id="Game-95"><a href="#Game-95"><span class="linenos"> 95</span></a>    <span class="n">DEFAULT_CONTINUE_ON_ERROR</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Game-96"><a href="#Game-96"><span class="linenos"> 96</span></a>    
</span><span id="Game-97"><a href="#Game-97"><span class="linenos"> 97</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-98"><a href="#Game-98"><span class="linenos"> 98</span></a>    <span class="c1">#                                                               MAGIC METHODS                                                               #</span>
</span><span id="Game-99"><a href="#Game-99"><span class="linenos"> 99</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-100"><a href="#Game-100"><span class="linenos">100</span></a>
</span><span id="Game-101"><a href="#Game-101"><span class="linenos">101</span></a>    <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>                  <span class="n">Self</span><span class="p">,</span>
</span><span id="Game-102"><a href="#Game-102"><span class="linenos">102</span></a>                   <span class="n">random_seed</span><span class="p">:</span>           <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-103"><a href="#Game-103"><span class="linenos">103</span></a>                   <span class="n">random_seed_maze</span><span class="p">:</span>      <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-104"><a href="#Game-104"><span class="linenos">104</span></a>                   <span class="n">random_seed_cheese</span><span class="p">:</span>    <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-105"><a href="#Game-105"><span class="linenos">105</span></a>                   <span class="n">random_seed_players</span><span class="p">:</span>   <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-106"><a href="#Game-106"><span class="linenos">106</span></a>                   <span class="n">maze_width</span><span class="p">:</span>            <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-107"><a href="#Game-107"><span class="linenos">107</span></a>                   <span class="n">maze_height</span><span class="p">:</span>           <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-108"><a href="#Game-108"><span class="linenos">108</span></a>                   <span class="n">cell_percentage</span><span class="p">:</span>       <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-109"><a href="#Game-109"><span class="linenos">109</span></a>                   <span class="n">wall_percentage</span><span class="p">:</span>       <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-110"><a href="#Game-110"><span class="linenos">110</span></a>                   <span class="n">mud_percentage</span><span class="p">:</span>        <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-111"><a href="#Game-111"><span class="linenos">111</span></a>                   <span class="n">mud_range</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Integral</span><span class="p">,</span> <span class="n">Integral</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-112"><a href="#Game-112"><span class="linenos">112</span></a>                   <span class="n">fixed_maze</span><span class="p">:</span>            <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Integral</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Integral</span><span class="p">,</span> <span class="n">Integral</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-113"><a href="#Game-113"><span class="linenos">113</span></a>                   <span class="n">nb_cheese</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-114"><a href="#Game-114"><span class="linenos">114</span></a>                   <span class="n">fixed_cheese</span><span class="p">:</span>          <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Integral</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-115"><a href="#Game-115"><span class="linenos">115</span></a>                   <span class="n">random_maze_algorithm</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RandomMazeAlgorithm</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-116"><a href="#Game-116"><span class="linenos">116</span></a>                   <span class="n">render_mode</span><span class="p">:</span>           <span class="n">Optional</span><span class="p">[</span><span class="n">RenderMode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-117"><a href="#Game-117"><span class="linenos">117</span></a>                   <span class="n">render_simplified</span><span class="p">:</span>     <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-118"><a href="#Game-118"><span class="linenos">118</span></a>                   <span class="n">gui_speed</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-119"><a href="#Game-119"><span class="linenos">119</span></a>                   <span class="n">trace_length</span><span class="p">:</span>          <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-120"><a href="#Game-120"><span class="linenos">120</span></a>                   <span class="n">fullscreen</span><span class="p">:</span>            <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-121"><a href="#Game-121"><span class="linenos">121</span></a>                   <span class="n">save_path</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-122"><a href="#Game-122"><span class="linenos">122</span></a>                   <span class="n">save_game</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-123"><a href="#Game-123"><span class="linenos">123</span></a>                   <span class="n">preprocessing_time</span><span class="p">:</span>    <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-124"><a href="#Game-124"><span class="linenos">124</span></a>                   <span class="n">turn_time</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-125"><a href="#Game-125"><span class="linenos">125</span></a>                   <span class="n">game_mode</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">GameMode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-126"><a href="#Game-126"><span class="linenos">126</span></a>                   <span class="n">continue_on_error</span><span class="p">:</span>     <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-127"><a href="#Game-127"><span class="linenos">127</span></a>                 <span class="p">)</span> <span class="o">-&gt;</span>                     <span class="n">Self</span><span class="p">:</span>
</span><span id="Game-128"><a href="#Game-128"><span class="linenos">128</span></a>
</span><span id="Game-129"><a href="#Game-129"><span class="linenos">129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game-130"><a href="#Game-130"><span class="linenos">130</span></a><span class="sd">            This function is the constructor of the class.</span>
</span><span id="Game-131"><a href="#Game-131"><span class="linenos">131</span></a><span class="sd">            When an object is instantiated, this method is called to initialize the object.</span>
</span><span id="Game-132"><a href="#Game-132"><span class="linenos">132</span></a><span class="sd">            This is where you should define the attributes of the object and set their initial values.</span>
</span><span id="Game-133"><a href="#Game-133"><span class="linenos">133</span></a><span class="sd">            Assertions checked in the objects manipulated by the game are not checked again.</span>
</span><span id="Game-134"><a href="#Game-134"><span class="linenos">134</span></a><span class="sd">            In:</span>
</span><span id="Game-135"><a href="#Game-135"><span class="linenos">135</span></a><span class="sd">                * self:                  Reference to the current object.</span>
</span><span id="Game-136"><a href="#Game-136"><span class="linenos">136</span></a><span class="sd">                * random_seed:           Global random seed for all elements, set to None for a random value.</span>
</span><span id="Game-137"><a href="#Game-137"><span class="linenos">137</span></a><span class="sd">                * random_seed_maze:      Random seed for the maze generation, set to None for a random value.</span>
</span><span id="Game-138"><a href="#Game-138"><span class="linenos">138</span></a><span class="sd">                * random_seed_cheese:    Random seed for the pieces of cheese distribution, set to None for a random value.</span>
</span><span id="Game-139"><a href="#Game-139"><span class="linenos">139</span></a><span class="sd">                * random_seed_players:   Random seed for the initial location of players, set to None for a random value.</span>
</span><span id="Game-140"><a href="#Game-140"><span class="linenos">140</span></a><span class="sd">                * maze_width:            Width of the maze in number of cells.</span>
</span><span id="Game-141"><a href="#Game-141"><span class="linenos">141</span></a><span class="sd">                * maze_height:           Height of the maze in number of cells.</span>
</span><span id="Game-142"><a href="#Game-142"><span class="linenos">142</span></a><span class="sd">                * cell_percentage:       Percentage of cells that can be accessed in the maze, 0%% being a useless maze, and 100%% being a full rectangular maze.</span>
</span><span id="Game-143"><a href="#Game-143"><span class="linenos">143</span></a><span class="sd">                * wall_percentage:       Percentage of walls in the maze, 0%% being an empty maze, and 100%% being the maximum number of walls that keep the maze connected.</span>
</span><span id="Game-144"><a href="#Game-144"><span class="linenos">144</span></a><span class="sd">                * mud_percentage:        Percentage of pairs of adjacent cells that are separated by mud in the maze.</span>
</span><span id="Game-145"><a href="#Game-145"><span class="linenos">145</span></a><span class="sd">                * mud_range:             Interval of turns needed to cross mud.</span>
</span><span id="Game-146"><a href="#Game-146"><span class="linenos">146</span></a><span class="sd">                * fixed_maze:            Fixed maze in any PyRat accepted representation (dictionary, numpy.ndarray or torch.tensor).</span>
</span><span id="Game-147"><a href="#Game-147"><span class="linenos">147</span></a><span class="sd">                * random_maze_algorithm: Algorithm to generate the maze.</span>
</span><span id="Game-148"><a href="#Game-148"><span class="linenos">148</span></a><span class="sd">                * nb_cheese:             Number of pieces of cheese in the maze.</span>
</span><span id="Game-149"><a href="#Game-149"><span class="linenos">149</span></a><span class="sd">                * fixed_cheese:          Fixed list of cheese.</span>
</span><span id="Game-150"><a href="#Game-150"><span class="linenos">150</span></a><span class="sd">                * render_mode:           Method to display the game.</span>
</span><span id="Game-151"><a href="#Game-151"><span class="linenos">151</span></a><span class="sd">                * render_simplified:     If the maze is rendered, hides some elements that are not essential.</span>
</span><span id="Game-152"><a href="#Game-152"><span class="linenos">152</span></a><span class="sd">                * gui_speed:             When rendering as GUI, controls the speed of the game (GUI rendering only).</span>
</span><span id="Game-153"><a href="#Game-153"><span class="linenos">153</span></a><span class="sd">                * trace_length:          Maximum length of the trace to display when players are moving (GUI rendering only).</span>
</span><span id="Game-154"><a href="#Game-154"><span class="linenos">154</span></a><span class="sd">                * fullscreen:            Renders the game in fullscreen mode (GUI rendering only).</span>
</span><span id="Game-155"><a href="#Game-155"><span class="linenos">155</span></a><span class="sd">                * save_path:             Path where games are saved.</span>
</span><span id="Game-156"><a href="#Game-156"><span class="linenos">156</span></a><span class="sd">                * save_game:             Indicates if the game should be saved.</span>
</span><span id="Game-157"><a href="#Game-157"><span class="linenos">157</span></a><span class="sd">                * preprocessing_time:    Time given to the players before the game starts.</span>
</span><span id="Game-158"><a href="#Game-158"><span class="linenos">158</span></a><span class="sd">                * turn_time:             Time after which players will miss a turn.</span>
</span><span id="Game-159"><a href="#Game-159"><span class="linenos">159</span></a><span class="sd">                * game_mode:             Indicates if players play concurrently, wait for each other, or if multiprocessing is disabled.</span>
</span><span id="Game-160"><a href="#Game-160"><span class="linenos">160</span></a><span class="sd">                * continue_on_error:     If a player crashes, continues the game anyway.</span>
</span><span id="Game-161"><a href="#Game-161"><span class="linenos">161</span></a><span class="sd">            Out:</span>
</span><span id="Game-162"><a href="#Game-162"><span class="linenos">162</span></a><span class="sd">                * A new instance of the class.</span>
</span><span id="Game-163"><a href="#Game-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game-164"><a href="#Game-164"><span class="linenos">164</span></a>        
</span><span id="Game-165"><a href="#Game-165"><span class="linenos">165</span></a>        <span class="c1"># Debug</span>
</span><span id="Game-166"><a href="#Game-166"><span class="linenos">166</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_seed</span><span class="p">,</span> <span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_seed&#39; must be an integer or None (if so, default value &#39;Game.DEFAULT_RANDOM_SEED&#39; is used)&quot;</span>
</span><span id="Game-167"><a href="#Game-167"><span class="linenos">167</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_seed_maze</span><span class="p">,</span> <span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_seed_maze&#39; must be an integer or None (if so, default value &#39;Game.DEFAULT_RANDOM_SEED_MAZE&#39; is used)&quot;</span>
</span><span id="Game-168"><a href="#Game-168"><span class="linenos">168</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_seed_cheese</span><span class="p">,</span> <span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_seed_cheese&#39; must be an integer or None (if so, default value &#39;Game.DEFAULT_RANDOM_SEED_CHEESE&#39; is used)&quot;</span>
</span><span id="Game-169"><a href="#Game-169"><span class="linenos">169</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_seed_players</span><span class="p">,</span> <span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_seed_players&#39; must be an integer or None (if so, default value &#39;Game.DEFAULT_RANDOM_SEED_PLAYERS&#39; is used)&quot;</span>
</span><span id="Game-170"><a href="#Game-170"><span class="linenos">170</span></a>        <span class="k">assert</span> <span class="n">random_seed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">random_seed</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;random_seed&#39; should be non-negative&quot;</span>
</span><span id="Game-171"><a href="#Game-171"><span class="linenos">171</span></a>        <span class="k">assert</span> <span class="n">random_seed_maze</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">random_seed_maze</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;random_seed_maze&#39; should be a positive integer&quot;</span>
</span><span id="Game-172"><a href="#Game-172"><span class="linenos">172</span></a>        <span class="k">assert</span> <span class="n">random_seed_cheese</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">random_seed_cheese</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;random_seed_cheese&#39; should be a positive integer&quot;</span>
</span><span id="Game-173"><a href="#Game-173"><span class="linenos">173</span></a>        <span class="k">assert</span> <span class="n">random_seed_players</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed_players</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">random_seed_players</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;random_seed_players&#39; should be a positive integer&quot;</span>
</span><span id="Game-174"><a href="#Game-174"><span class="linenos">174</span></a>        <span class="k">assert</span> <span class="n">random_seed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">random_seed_maze</span><span class="p">,</span> <span class="n">random_seed_cheese</span><span class="p">,</span> <span class="n">random_seed_players</span><span class="p">]])),</span> <span class="s2">&quot;Argument &#39;random_seed&#39; should be given if and only if no other random seed is given&quot;</span>
</span><span id="Game-175"><a href="#Game-175"><span class="linenos">175</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">render_mode</span><span class="p">,</span> <span class="p">(</span><span class="n">RenderMode</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;render_mode&#39; must be of type &#39;pyrat.RenderMode&#39; or None (if so, default value &#39;Game.DEFAULT_RENDER_MODE&#39; is used)&quot;</span>
</span><span id="Game-176"><a href="#Game-176"><span class="linenos">176</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">turn_time</span><span class="p">,</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;turn_time&#39; must be a real number or None (if so, default value &#39;Game.DEFAULT_TURN_TIME&#39; is used)&quot;</span>
</span><span id="Game-177"><a href="#Game-177"><span class="linenos">177</span></a>        <span class="k">assert</span> <span class="n">turn_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">turn_time</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Argument &#39;turn_time&#39; should be non-negative&quot;</span>
</span><span id="Game-178"><a href="#Game-178"><span class="linenos">178</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preprocessing_time</span><span class="p">,</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;preprocessing_time&#39; must be a real number or None (if so, default value &#39;Game.DEFAULT_PREPROCESSING_TIME&#39; is used)&quot;</span>
</span><span id="Game-179"><a href="#Game-179"><span class="linenos">179</span></a>        <span class="k">assert</span> <span class="n">preprocessing_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">preprocessing_time</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Argument &#39;preprocessing_time&#39; should be non-negative&quot;</span>
</span><span id="Game-180"><a href="#Game-180"><span class="linenos">180</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">game_mode</span><span class="p">,</span> <span class="p">(</span><span class="n">GameMode</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;game_mode&#39; must be of type &#39;pyrat.GameMode&#39; or None (if so, default value &#39;Game.DEFAULT_GAME_MODE&#39; is used)&quot;</span>
</span><span id="Game-181"><a href="#Game-181"><span class="linenos">181</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">continue_on_error</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;continue_on_error&#39; must be a boolean or None (if so, default value &#39;Game.DEFAULT_CONTINUE_ON_ERROR&#39; is used)&quot;</span>
</span><span id="Game-182"><a href="#Game-182"><span class="linenos">182</span></a>        <span class="k">assert</span> <span class="ow">not</span><span class="p">(</span><span class="n">game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SEQUENTIAL</span> <span class="ow">and</span> <span class="n">render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span><span class="p">),</span> <span class="s2">&quot;Cannot render GUI in sequential mode&quot;</span>
</span><span id="Game-183"><a href="#Game-183"><span class="linenos">183</span></a>        <span class="k">assert</span> <span class="n">fixed_maze</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fixed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">random_seed_maze</span><span class="p">,</span> <span class="n">random_maze_algorithm</span><span class="p">,</span> <span class="n">maze_width</span><span class="p">,</span> <span class="n">maze_height</span><span class="p">,</span> <span class="n">cell_percentage</span><span class="p">,</span> <span class="n">wall_percentage</span><span class="p">,</span> <span class="n">mud_percentage</span><span class="p">,</span> <span class="n">mud_range</span><span class="p">])),</span> <span class="s2">&quot;Argument &#39;fixed_maze&#39; should be given if and only if no other maze description is given&quot;</span>
</span><span id="Game-184"><a href="#Game-184"><span class="linenos">184</span></a>        <span class="k">assert</span> <span class="n">fixed_cheese</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fixed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">random_seed_cheese</span><span class="p">,</span> <span class="n">nb_cheese</span><span class="p">])),</span> <span class="s2">&quot;Argument &#39;fixed_cheese&#39; should be given if and only if no other cheese description is given&quot;</span>
</span><span id="Game-185"><a href="#Game-185"><span class="linenos">185</span></a>        <span class="k">assert</span> <span class="n">game_mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">game_mode</span> <span class="o">!=</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SIMULATION</span> <span class="ow">or</span> <span class="p">(</span><span class="n">game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SIMULATION</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">render_mode</span><span class="p">,</span> <span class="n">preprocessing_time</span><span class="p">,</span> <span class="n">turn_time</span><span class="p">]])),</span> <span class="s2">&quot;Some parameters should be set when running in simulation mode&quot;</span>
</span><span id="Game-186"><a href="#Game-186"><span class="linenos">186</span></a>        <span class="k">assert</span> <span class="n">render_mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span> <span class="ow">or</span> <span class="p">(</span><span class="n">render_mode</span> <span class="o">!=</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">trace_length</span><span class="p">,</span> <span class="n">gui_speed</span><span class="p">,</span> <span class="n">fullscreen</span><span class="p">]])),</span> <span class="s2">&quot;Some parameters should be set only when rendering in GUI mode&quot;</span>
</span><span id="Game-187"><a href="#Game-187"><span class="linenos">187</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_maze_algorithm</span><span class="p">,</span> <span class="p">(</span><span class="n">RandomMazeAlgorithm</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_maze_algorithm&#39; must be of type &#39;pyrat.RandomMazeAlgorithm&#39; or None (if so, default value &#39;Game.DEFAULT_RANDOM_MAZE_ALGORITHM&#39; is used)&quot;</span>
</span><span id="Game-188"><a href="#Game-188"><span class="linenos">188</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">save_game</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;save_game&#39; must be a boolean or None (if so, default value &#39;Game.DEFAULT_SAVE_GAME&#39; is used)&quot;</span>
</span><span id="Game-189"><a href="#Game-189"><span class="linenos">189</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;save_path&#39; must be a string or None (if so, default value &#39;Game.DEFAULT_SAVE_PATH&#39; is used)&quot;</span>
</span><span id="Game-190"><a href="#Game-190"><span class="linenos">190</span></a>        <span class="k">assert</span> <span class="n">save_path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">is_valid_directory</span><span class="p">(</span><span class="n">save_path</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;save_path&#39; must be a valid directory&quot;</span>
</span><span id="Game-191"><a href="#Game-191"><span class="linenos">191</span></a>
</span><span id="Game-192"><a href="#Game-192"><span class="linenos">192</span></a>        <span class="c1"># Store given parameters or default values</span>
</span><span id="Game-193"><a href="#Game-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="o">=</span> <span class="n">random_seed</span> <span class="k">if</span> <span class="n">random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_SEED</span>
</span><span id="Game-194"><a href="#Game-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_maze</span> <span class="o">=</span> <span class="n">random_seed_maze</span> <span class="k">if</span> <span class="n">random_seed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_SEED_MAZE</span>
</span><span id="Game-195"><a href="#Game-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_cheese</span> <span class="o">=</span> <span class="n">random_seed_cheese</span> <span class="k">if</span> <span class="n">random_seed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_SEED_CHEESE</span>
</span><span id="Game-196"><a href="#Game-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_players</span> <span class="o">=</span> <span class="n">random_seed_players</span> <span class="k">if</span> <span class="n">random_seed_players</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_SEED_PLAYERS</span>
</span><span id="Game-197"><a href="#Game-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span> <span class="o">=</span> <span class="n">maze_width</span> <span class="k">if</span> <span class="n">maze_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_MAZE_WIDTH</span>
</span><span id="Game-198"><a href="#Game-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span> <span class="o">=</span> <span class="n">maze_height</span> <span class="k">if</span> <span class="n">maze_height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_MAZE_HEIGHT</span>
</span><span id="Game-199"><a href="#Game-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span> <span class="o">=</span> <span class="n">cell_percentage</span> <span class="k">if</span> <span class="n">cell_percentage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_CELL_PERCENTAGE</span>
</span><span id="Game-200"><a href="#Game-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span> <span class="o">=</span> <span class="n">wall_percentage</span> <span class="k">if</span> <span class="n">wall_percentage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_WALL_PERCENTAGE</span>
</span><span id="Game-201"><a href="#Game-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span> <span class="o">=</span> <span class="n">mud_percentage</span> <span class="k">if</span> <span class="n">mud_percentage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_MUD_PERCENTAGE</span>
</span><span id="Game-202"><a href="#Game-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span> <span class="o">=</span> <span class="n">mud_range</span> <span class="k">if</span> <span class="n">mud_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_MUD_RANGE</span>
</span><span id="Game-203"><a href="#Game-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span> <span class="o">=</span> <span class="n">fixed_maze</span> <span class="k">if</span> <span class="n">fixed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_FIXED_MAZE</span>
</span><span id="Game-204"><a href="#Game-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span> <span class="o">=</span> <span class="n">random_maze_algorithm</span> <span class="k">if</span> <span class="n">random_maze_algorithm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_MAZE_ALGORITHM</span>
</span><span id="Game-205"><a href="#Game-205"><span class="linenos">205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span> <span class="o">=</span> <span class="n">nb_cheese</span> <span class="k">if</span> <span class="n">nb_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_NB_CHEESE</span>
</span><span id="Game-206"><a href="#Game-206"><span class="linenos">206</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span> <span class="o">=</span> <span class="n">fixed_cheese</span> <span class="k">if</span> <span class="n">fixed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_FIXED_CHEESE</span>
</span><span id="Game-207"><a href="#Game-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">=</span> <span class="n">render_mode</span> <span class="k">if</span> <span class="n">render_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RENDER_MODE</span>
</span><span id="Game-208"><a href="#Game-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span> <span class="o">=</span> <span class="n">render_simplified</span> <span class="k">if</span> <span class="n">render_simplified</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RENDER_SIMPLIFIED</span>
</span><span id="Game-209"><a href="#Game-209"><span class="linenos">209</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__gui_speed</span> <span class="o">=</span> <span class="n">gui_speed</span> <span class="k">if</span> <span class="n">gui_speed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_GUI_SPEED</span>
</span><span id="Game-210"><a href="#Game-210"><span class="linenos">210</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__trace_length</span> <span class="o">=</span> <span class="n">trace_length</span> <span class="k">if</span> <span class="n">trace_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_TRACE_LENGTH</span>
</span><span id="Game-211"><a href="#Game-211"><span class="linenos">211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__fullscreen</span> <span class="o">=</span> <span class="n">fullscreen</span> <span class="k">if</span> <span class="n">fullscreen</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_FULLSCREEN</span>
</span><span id="Game-212"><a href="#Game-212"><span class="linenos">212</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__save_path</span> <span class="o">=</span> <span class="n">save_path</span> <span class="k">if</span> <span class="n">save_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_SAVE_PATH</span>
</span><span id="Game-213"><a href="#Game-213"><span class="linenos">213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__save_game</span> <span class="o">=</span> <span class="n">save_game</span> <span class="k">if</span> <span class="n">save_game</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_SAVE_GAME</span>
</span><span id="Game-214"><a href="#Game-214"><span class="linenos">214</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__preprocessing_time</span> <span class="o">=</span> <span class="n">preprocessing_time</span> <span class="k">if</span> <span class="n">preprocessing_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_PREPROCESSING_TIME</span>
</span><span id="Game-215"><a href="#Game-215"><span class="linenos">215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__turn_time</span> <span class="o">=</span> <span class="n">turn_time</span> <span class="k">if</span> <span class="n">turn_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_TURN_TIME</span>
</span><span id="Game-216"><a href="#Game-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">=</span> <span class="n">game_mode</span> <span class="k">if</span> <span class="n">game_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_GAME_MODE</span>
</span><span id="Game-217"><a href="#Game-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__continue_on_error</span> <span class="o">=</span> <span class="n">continue_on_error</span> <span class="k">if</span> <span class="n">continue_on_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_CONTINUE_ON_ERROR</span>
</span><span id="Game-218"><a href="#Game-218"><span class="linenos">218</span></a>
</span><span id="Game-219"><a href="#Game-219"><span class="linenos">219</span></a>        <span class="c1"># If the game is in simulation mode, we enforce some parameters</span>
</span><span id="Game-220"><a href="#Game-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SIMULATION</span><span class="p">:</span>
</span><span id="Game-221"><a href="#Game-221"><span class="linenos">221</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__preprocessing_time</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="Game-222"><a href="#Game-222"><span class="linenos">222</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__turn_time</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="Game-223"><a href="#Game-223"><span class="linenos">223</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">=</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">NO_RENDERING</span>
</span><span id="Game-224"><a href="#Game-224"><span class="linenos">224</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">=</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SEQUENTIAL</span>
</span><span id="Game-225"><a href="#Game-225"><span class="linenos">225</span></a>
</span><span id="Game-226"><a href="#Game-226"><span class="linenos">226</span></a>        <span class="c1"># Private attributes</span>
</span><span id="Game-227"><a href="#Game-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-228"><a href="#Game-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_cheese</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-229"><a href="#Game-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_players</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-230"><a href="#Game-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players_rng</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-231"><a href="#Game-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players_asked_location</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Game-232"><a href="#Game-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Game-233"><a href="#Game-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-234"><a href="#Game-234"><span class="linenos">234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-235"><a href="#Game-235"><span class="linenos">235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-236"><a href="#Game-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-237"><a href="#Game-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-238"><a href="#Game-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__reset_called</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Game-239"><a href="#Game-239"><span class="linenos">239</span></a>
</span><span id="Game-240"><a href="#Game-240"><span class="linenos">240</span></a>        <span class="c1"># Initialize the game</span>
</span><span id="Game-241"><a href="#Game-241"><span class="linenos">241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</span><span id="Game-242"><a href="#Game-242"><span class="linenos">242</span></a>
</span><span id="Game-243"><a href="#Game-243"><span class="linenos">243</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-244"><a href="#Game-244"><span class="linenos">244</span></a>
</span><span id="Game-245"><a href="#Game-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="fm">__str__</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span>
</span><span id="Game-246"><a href="#Game-246"><span class="linenos">246</span></a>                <span class="p">)</span> <span class="o">-&gt;</span>    <span class="nb">str</span><span class="p">:</span>
</span><span id="Game-247"><a href="#Game-247"><span class="linenos">247</span></a>
</span><span id="Game-248"><a href="#Game-248"><span class="linenos">248</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game-249"><a href="#Game-249"><span class="linenos">249</span></a><span class="sd">            This method returns a string representation of the object.</span>
</span><span id="Game-250"><a href="#Game-250"><span class="linenos">250</span></a><span class="sd">            This defines what will be shown when calling print on the object.</span>
</span><span id="Game-251"><a href="#Game-251"><span class="linenos">251</span></a><span class="sd">            In:</span>
</span><span id="Game-252"><a href="#Game-252"><span class="linenos">252</span></a><span class="sd">                * self: Reference to the current object.</span>
</span><span id="Game-253"><a href="#Game-253"><span class="linenos">253</span></a><span class="sd">            Out:</span>
</span><span id="Game-254"><a href="#Game-254"><span class="linenos">254</span></a><span class="sd">                * string: String representation of the object.</span>
</span><span id="Game-255"><a href="#Game-255"><span class="linenos">255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game-256"><a href="#Game-256"><span class="linenos">256</span></a>        
</span><span id="Game-257"><a href="#Game-257"><span class="linenos">257</span></a>        <span class="c1"># Create the string</span>
</span><span id="Game-258"><a href="#Game-258"><span class="linenos">258</span></a>        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;Game object:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="Game-259"><a href="#Game-259"><span class="linenos">259</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Random seed: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span><span class="p">)</span>
</span><span id="Game-260"><a href="#Game-260"><span class="linenos">260</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Random seed for maze: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_maze</span><span class="p">)</span>
</span><span id="Game-261"><a href="#Game-261"><span class="linenos">261</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Random seed for cheese: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_cheese</span><span class="p">)</span>
</span><span id="Game-262"><a href="#Game-262"><span class="linenos">262</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Random seed for players: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_players</span><span class="p">)</span>
</span><span id="Game-263"><a href="#Game-263"><span class="linenos">263</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Maze width: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span><span class="p">)</span>
</span><span id="Game-264"><a href="#Game-264"><span class="linenos">264</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Maze height: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span><span class="p">)</span>
</span><span id="Game-265"><a href="#Game-265"><span class="linenos">265</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Cell percentage: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span><span class="p">)</span>
</span><span id="Game-266"><a href="#Game-266"><span class="linenos">266</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Wall percentage: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span><span class="p">)</span>
</span><span id="Game-267"><a href="#Game-267"><span class="linenos">267</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Mud percentage: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span><span class="p">)</span>
</span><span id="Game-268"><a href="#Game-268"><span class="linenos">268</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Mud range: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span><span class="p">)</span>
</span><span id="Game-269"><a href="#Game-269"><span class="linenos">269</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Fixed maze: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span><span class="p">)</span>
</span><span id="Game-270"><a href="#Game-270"><span class="linenos">270</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Random maze algorithm: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span><span class="p">)</span>
</span><span id="Game-271"><a href="#Game-271"><span class="linenos">271</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Number of cheese: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span><span class="p">)</span>
</span><span id="Game-272"><a href="#Game-272"><span class="linenos">272</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Fixed cheese: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">)</span>
</span><span id="Game-273"><a href="#Game-273"><span class="linenos">273</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Render mode: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span><span class="p">)</span>
</span><span id="Game-274"><a href="#Game-274"><span class="linenos">274</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Render simplified: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span><span class="p">)</span>
</span><span id="Game-275"><a href="#Game-275"><span class="linenos">275</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  GUI speed: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__gui_speed</span><span class="p">)</span>
</span><span id="Game-276"><a href="#Game-276"><span class="linenos">276</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Trace length: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__trace_length</span><span class="p">)</span>
</span><span id="Game-277"><a href="#Game-277"><span class="linenos">277</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Fullscreen: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fullscreen</span><span class="p">)</span>
</span><span id="Game-278"><a href="#Game-278"><span class="linenos">278</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Save path: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__save_path</span><span class="p">)</span>
</span><span id="Game-279"><a href="#Game-279"><span class="linenos">279</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Save game: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__save_game</span><span class="p">)</span>
</span><span id="Game-280"><a href="#Game-280"><span class="linenos">280</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Preprocessing time: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__preprocessing_time</span><span class="p">)</span>
</span><span id="Game-281"><a href="#Game-281"><span class="linenos">281</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Turn time: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__turn_time</span><span class="p">)</span>
</span><span id="Game-282"><a href="#Game-282"><span class="linenos">282</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Game mode: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span><span class="p">)</span>
</span><span id="Game-283"><a href="#Game-283"><span class="linenos">283</span></a>        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;|  Continue on error: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__continue_on_error</span><span class="p">)</span>
</span><span id="Game-284"><a href="#Game-284"><span class="linenos">284</span></a>        <span class="k">return</span> <span class="n">string</span>
</span><span id="Game-285"><a href="#Game-285"><span class="linenos">285</span></a>
</span><span id="Game-286"><a href="#Game-286"><span class="linenos">286</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-287"><a href="#Game-287"><span class="linenos">287</span></a>    <span class="c1">#                                                            ATTRIBUTE ACCESSORS                                                            #</span>
</span><span id="Game-288"><a href="#Game-288"><span class="linenos">288</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-289"><a href="#Game-289"><span class="linenos">289</span></a>
</span><span id="Game-290"><a href="#Game-290"><span class="linenos">290</span></a>    <span class="nd">@property</span>
</span><span id="Game-291"><a href="#Game-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">maze</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span>
</span><span id="Game-292"><a href="#Game-292"><span class="linenos">292</span></a>             <span class="p">)</span> <span class="o">-&gt;</span>    <span class="n">Maze</span><span class="p">:</span>
</span><span id="Game-293"><a href="#Game-293"><span class="linenos">293</span></a><span class="w">        </span>
</span><span id="Game-294"><a href="#Game-294"><span class="linenos">294</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game-295"><a href="#Game-295"><span class="linenos">295</span></a><span class="sd">            Getter for __maze.</span>
</span><span id="Game-296"><a href="#Game-296"><span class="linenos">296</span></a><span class="sd">            It returns a copy of the maze attribute.</span>
</span><span id="Game-297"><a href="#Game-297"><span class="linenos">297</span></a><span class="sd">            In:</span>
</span><span id="Game-298"><a href="#Game-298"><span class="linenos">298</span></a><span class="sd">                * self: Reference to the current object.</span>
</span><span id="Game-299"><a href="#Game-299"><span class="linenos">299</span></a><span class="sd">            Out:</span>
</span><span id="Game-300"><a href="#Game-300"><span class="linenos">300</span></a><span class="sd">                * maze_copy: Copy of the __maze attribute.</span>
</span><span id="Game-301"><a href="#Game-301"><span class="linenos">301</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game-302"><a href="#Game-302"><span class="linenos">302</span></a>
</span><span id="Game-303"><a href="#Game-303"><span class="linenos">303</span></a>        <span class="c1"># Return the attribute</span>
</span><span id="Game-304"><a href="#Game-304"><span class="linenos">304</span></a>        <span class="n">maze_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="p">)</span>
</span><span id="Game-305"><a href="#Game-305"><span class="linenos">305</span></a>        <span class="k">return</span> <span class="n">maze_copy</span>
</span><span id="Game-306"><a href="#Game-306"><span class="linenos">306</span></a>    
</span><span id="Game-307"><a href="#Game-307"><span class="linenos">307</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-308"><a href="#Game-308"><span class="linenos">308</span></a>    <span class="c1">#                                                              PUBLIC METHODS                                                              #</span>
</span><span id="Game-309"><a href="#Game-309"><span class="linenos">309</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-310"><a href="#Game-310"><span class="linenos">310</span></a>
</span><span id="Game-311"><a href="#Game-311"><span class="linenos">311</span></a>    <span class="k">def</span> <span class="nf">add_player</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>     <span class="n">Self</span><span class="p">,</span>
</span><span id="Game-312"><a href="#Game-312"><span class="linenos">312</span></a>                     <span class="n">player</span><span class="p">:</span>   <span class="n">Player</span><span class="p">,</span>
</span><span id="Game-313"><a href="#Game-313"><span class="linenos">313</span></a>                     <span class="n">team</span><span class="p">:</span>     <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="Game-314"><a href="#Game-314"><span class="linenos">314</span></a>                     <span class="n">location</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">StartingLocation</span><span class="p">,</span> <span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">CENTER</span>
</span><span id="Game-315"><a href="#Game-315"><span class="linenos">315</span></a>                   <span class="p">)</span> <span class="o">-&gt;</span>        <span class="kc">None</span><span class="p">:</span>
</span><span id="Game-316"><a href="#Game-316"><span class="linenos">316</span></a><span class="w">        </span>
</span><span id="Game-317"><a href="#Game-317"><span class="linenos">317</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game-318"><a href="#Game-318"><span class="linenos">318</span></a><span class="sd">            Adds a player to the game.</span>
</span><span id="Game-319"><a href="#Game-319"><span class="linenos">319</span></a><span class="sd">            In:</span>
</span><span id="Game-320"><a href="#Game-320"><span class="linenos">320</span></a><span class="sd">                * self:     Reference to the current object.</span>
</span><span id="Game-321"><a href="#Game-321"><span class="linenos">321</span></a><span class="sd">                * player:   Player to add.</span>
</span><span id="Game-322"><a href="#Game-322"><span class="linenos">322</span></a><span class="sd">                * team:     Team of the player.</span>
</span><span id="Game-323"><a href="#Game-323"><span class="linenos">323</span></a><span class="sd">                * location: Controls initial location of the player (fixed index, or value of the StartingLocation enumeration).</span>
</span><span id="Game-324"><a href="#Game-324"><span class="linenos">324</span></a><span class="sd">            Out:</span>
</span><span id="Game-325"><a href="#Game-325"><span class="linenos">325</span></a><span class="sd">                * None.</span>
</span><span id="Game-326"><a href="#Game-326"><span class="linenos">326</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game-327"><a href="#Game-327"><span class="linenos">327</span></a>
</span><span id="Game-328"><a href="#Game-328"><span class="linenos">328</span></a>        <span class="c1"># Debug</span>
</span><span id="Game-329"><a href="#Game-329"><span class="linenos">329</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">Player</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;player&#39; must be of type &#39;pyrat.Player&#39;&quot;</span>
</span><span id="Game-330"><a href="#Game-330"><span class="linenos">330</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">team</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;team&#39; must be a string&quot;</span>
</span><span id="Game-331"><a href="#Game-331"><span class="linenos">331</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="p">(</span><span class="n">StartingLocation</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)),</span> <span class="s2">&quot;Argument &#39;location&#39; must be of type &#39;pyrat.StartingLocation&#39; or an integer, corresponding to the index of the cell where the player should start&quot;</span>
</span><span id="Game-332"><a href="#Game-332"><span class="linenos">332</span></a>        <span class="k">assert</span> <span class="n">location</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">StartingLocation</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_exists</span><span class="p">(</span><span class="n">location</span><span class="p">)),</span> <span class="s2">&quot;Argument &#39;location&#39; must be a valid index of the maze or a value of the &#39;pyrat.StartingLocation&#39; enumeration&quot;</span>
</span><span id="Game-333"><a href="#Game-333"><span class="linenos">333</span></a>        <span class="k">assert</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span><span class="p">,</span> <span class="s2">&quot;Player &#39;</span><span class="si">%s</span><span class="s2">&#39; was already added to the game&quot;</span> <span class="o">%</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span>
</span><span id="Game-334"><a href="#Game-334"><span class="linenos">334</span></a>        <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">SAME</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;Cannot start player &#39;</span><span class="si">%s</span><span class="s2">&#39; at the same location as the previous player if no player was added before&quot;</span> <span class="o">%</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span>
</span><span id="Game-335"><a href="#Game-335"><span class="linenos">335</span></a>
</span><span id="Game-336"><a href="#Game-336"><span class="linenos">336</span></a>        <span class="c1"># Set initial location</span>
</span><span id="Game-337"><a href="#Game-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players_asked_location</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
</span><span id="Game-338"><a href="#Game-338"><span class="linenos">338</span></a>        <span class="n">corrected_location</span> <span class="o">=</span> <span class="n">location</span>
</span><span id="Game-339"><a href="#Game-339"><span class="linenos">339</span></a>        <span class="k">if</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">RANDOM</span><span class="p">:</span>
</span><span id="Game-340"><a href="#Game-340"><span class="linenos">340</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players_rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Game-341"><a href="#Game-341"><span class="linenos">341</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">SAME</span><span class="p">:</span>
</span><span id="Game-342"><a href="#Game-342"><span class="linenos">342</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Game-343"><a href="#Game-343"><span class="linenos">343</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">CENTER</span><span class="p">:</span>
</span><span id="Game-344"><a href="#Game-344"><span class="linenos">344</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Game-345"><a href="#Game-345"><span class="linenos">345</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">:</span>
</span><span id="Game-346"><a href="#Game-346"><span class="linenos">346</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Game-347"><a href="#Game-347"><span class="linenos">347</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">:</span>
</span><span id="Game-348"><a href="#Game-348"><span class="linenos">348</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game-349"><a href="#Game-349"><span class="linenos">349</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">:</span>
</span><span id="Game-350"><a href="#Game-350"><span class="linenos">350</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Game-351"><a href="#Game-351"><span class="linenos">351</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">:</span>
</span><span id="Game-352"><a href="#Game-352"><span class="linenos">352</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game-353"><a href="#Game-353"><span class="linenos">353</span></a>        
</span><span id="Game-354"><a href="#Game-354"><span class="linenos">354</span></a>        <span class="c1"># If the location is not reachable, we choose the closest reachable location</span>
</span><span id="Game-355"><a href="#Game-355"><span class="linenos">355</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_exists</span><span class="p">(</span><span class="n">corrected_location</span><span class="p">):</span>
</span><span id="Game-356"><a href="#Game-356"><span class="linenos">356</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">corrected_location</span>
</span><span id="Game-357"><a href="#Game-357"><span class="linenos">357</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Game-358"><a href="#Game-358"><span class="linenos">358</span></a>            <span class="n">valid_cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="Game-359"><a href="#Game-359"><span class="linenos">359</span></a>            <span class="n">distances</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_to_rc</span><span class="p">(</span><span class="n">corrected_location</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_to_rc</span><span class="p">(</span><span class="n">cell</span><span class="p">))</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">valid_cells</span><span class="p">]</span>
</span><span id="Game-360"><a href="#Game-360"><span class="linenos">360</span></a>            <span class="n">_</span><span class="p">,</span> <span class="n">argmin_distance</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">val</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>
</span><span id="Game-361"><a href="#Game-361"><span class="linenos">361</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_cells</span><span class="p">[</span><span class="n">argmin_distance</span><span class="p">]</span>
</span><span id="Game-362"><a href="#Game-362"><span class="linenos">362</span></a>
</span><span id="Game-363"><a href="#Game-363"><span class="linenos">363</span></a>        <span class="c1"># Append to team</span>
</span><span id="Game-364"><a href="#Game-364"><span class="linenos">364</span></a>        <span class="k">if</span> <span class="n">team</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">:</span>
</span><span id="Game-365"><a href="#Game-365"><span class="linenos">365</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Game-366"><a href="#Game-366"><span class="linenos">366</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="Game-367"><a href="#Game-367"><span class="linenos">367</span></a>
</span><span id="Game-368"><a href="#Game-368"><span class="linenos">368</span></a>        <span class="c1"># Initialize other elements of game state</span>
</span><span id="Game-369"><a href="#Game-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">score_per_player</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Game-370"><a href="#Game-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span><span id="Game-371"><a href="#Game-371"><span class="linenos">371</span></a>
</span><span id="Game-372"><a href="#Game-372"><span class="linenos">372</span></a>        <span class="c1"># Other attributes</span>
</span><span id="Game-373"><a href="#Game-373"><span class="linenos">373</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
</span><span id="Game-374"><a href="#Game-374"><span class="linenos">374</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Game-375"><a href="#Game-375"><span class="linenos">375</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Game-376"><a href="#Game-376"><span class="linenos">376</span></a>        
</span><span id="Game-377"><a href="#Game-377"><span class="linenos">377</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-378"><a href="#Game-378"><span class="linenos">378</span></a>    
</span><span id="Game-379"><a href="#Game-379"><span class="linenos">379</span></a>    <span class="k">def</span> <span class="nf">reset</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>         <span class="n">Self</span><span class="p">,</span>
</span><span id="Game-380"><a href="#Game-380"><span class="linenos">380</span></a>                <span class="n">keep_players</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Game-381"><a href="#Game-381"><span class="linenos">381</span></a>              <span class="p">)</span> <span class="o">-&gt;</span>            <span class="kc">None</span><span class="p">:</span>
</span><span id="Game-382"><a href="#Game-382"><span class="linenos">382</span></a><span class="w">        </span>
</span><span id="Game-383"><a href="#Game-383"><span class="linenos">383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game-384"><a href="#Game-384"><span class="linenos">384</span></a><span class="sd">            Resets the game to its initial state.</span>
</span><span id="Game-385"><a href="#Game-385"><span class="linenos">385</span></a><span class="sd">            If random seeds were set, they will be kept, otherwise they will be randomly generated using the configuration provided when the game was created.</span>
</span><span id="Game-386"><a href="#Game-386"><span class="linenos">386</span></a><span class="sd">            If asked, it will keep players and will insert them as they were added.</span>
</span><span id="Game-387"><a href="#Game-387"><span class="linenos">387</span></a><span class="sd">            In:</span>
</span><span id="Game-388"><a href="#Game-388"><span class="linenos">388</span></a><span class="sd">                * self: Reference to the current object.</span>
</span><span id="Game-389"><a href="#Game-389"><span class="linenos">389</span></a><span class="sd">            Out:</span>
</span><span id="Game-390"><a href="#Game-390"><span class="linenos">390</span></a><span class="sd">                * None.</span>
</span><span id="Game-391"><a href="#Game-391"><span class="linenos">391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game-392"><a href="#Game-392"><span class="linenos">392</span></a>        
</span><span id="Game-393"><a href="#Game-393"><span class="linenos">393</span></a>        <span class="c1"># Debug</span>
</span><span id="Game-394"><a href="#Game-394"><span class="linenos">394</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keep_players</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;keep_players&#39; must be a boolean&quot;</span>
</span><span id="Game-395"><a href="#Game-395"><span class="linenos">395</span></a>
</span><span id="Game-396"><a href="#Game-396"><span class="linenos">396</span></a>        <span class="c1"># Set random seeds for the game</span>
</span><span id="Game-397"><a href="#Game-397"><span class="linenos">397</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_maze</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game-398"><a href="#Game-398"><span class="linenos">398</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_cheese</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_cheese</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game-399"><a href="#Game-399"><span class="linenos">399</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_players</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_players</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_players</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game-400"><a href="#Game-400"><span class="linenos">400</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players_rng</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">Random</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_players</span><span class="p">)</span>
</span><span id="Game-401"><a href="#Game-401"><span class="linenos">401</span></a>        
</span><span id="Game-402"><a href="#Game-402"><span class="linenos">402</span></a>        <span class="c1"># Reset game analysis elements</span>
</span><span id="Game-403"><a href="#Game-403"><span class="linenos">403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Game-404"><a href="#Game-404"><span class="linenos">404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Game-405"><a href="#Game-405"><span class="linenos">405</span></a>        
</span><span id="Game-406"><a href="#Game-406"><span class="linenos">406</span></a>        <span class="c1"># Initialize the maze</span>
</span><span id="Game-407"><a href="#Game-407"><span class="linenos">407</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Game-408"><a href="#Game-408"><span class="linenos">408</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">MazeFromDict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span><span class="p">)</span>
</span><span id="Game-409"><a href="#Game-409"><span class="linenos">409</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Game-410"><a href="#Game-410"><span class="linenos">410</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">MazeFromMatrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span><span class="p">)</span>
</span><span id="Game-411"><a href="#Game-411"><span class="linenos">411</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span> <span class="o">==</span> <span class="n">RandomMazeAlgorithm</span><span class="o">.</span><span class="n">UNIFORM_HOLES</span><span class="p">:</span>
</span><span id="Game-412"><a href="#Game-412"><span class="linenos">412</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">UniformHolesRandomMaze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span><span class="p">)</span>
</span><span id="Game-413"><a href="#Game-413"><span class="linenos">413</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span> <span class="o">==</span> <span class="n">RandomMazeAlgorithm</span><span class="o">.</span><span class="n">HOLES_ON_SIDE</span><span class="p">:</span>
</span><span id="Game-414"><a href="#Game-414"><span class="linenos">414</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">HolesOnSideRandomMaze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span><span class="p">)</span>
</span><span id="Game-415"><a href="#Game-415"><span class="linenos">415</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span> <span class="o">==</span> <span class="n">RandomMazeAlgorithm</span><span class="o">.</span><span class="n">BIG_HOLES</span><span class="p">:</span>
</span><span id="Game-416"><a href="#Game-416"><span class="linenos">416</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">BigHolesRandomMaze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span><span class="p">)</span>
</span><span id="Game-417"><a href="#Game-417"><span class="linenos">417</span></a>
</span><span id="Game-418"><a href="#Game-418"><span class="linenos">418</span></a>        <span class="c1"># Initialize the rendering engine</span>
</span><span id="Game-419"><a href="#Game-419"><span class="linenos">419</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="n">RenderMode</span><span class="o">.</span><span class="n">ASCII</span><span class="p">,</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">ANSI</span><span class="p">]:</span>
</span><span id="Game-420"><a href="#Game-420"><span class="linenos">420</span></a>            <span class="n">use_colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">ANSI</span>
</span><span id="Game-421"><a href="#Game-421"><span class="linenos">421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span> <span class="o">=</span> <span class="n">ShellRenderingEngine</span><span class="p">(</span><span class="n">use_colors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span><span class="p">)</span>
</span><span id="Game-422"><a href="#Game-422"><span class="linenos">422</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span><span class="p">:</span>
</span><span id="Game-423"><a href="#Game-423"><span class="linenos">423</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span> <span class="o">=</span> <span class="n">PygameRenderingEngine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fullscreen</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__trace_length</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_speed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span><span class="p">)</span>
</span><span id="Game-424"><a href="#Game-424"><span class="linenos">424</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">NO_RENDERING</span><span class="p">:</span>
</span><span id="Game-425"><a href="#Game-425"><span class="linenos">425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span> <span class="o">=</span> <span class="n">RenderingEngine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span><span class="p">)</span>
</span><span id="Game-426"><a href="#Game-426"><span class="linenos">426</span></a>        
</span><span id="Game-427"><a href="#Game-427"><span class="linenos">427</span></a>        <span class="c1"># Initialize the game state</span>
</span><span id="Game-428"><a href="#Game-428"><span class="linenos">428</span></a>        <span class="n">previous_initial_state</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="p">)</span>
</span><span id="Game-429"><a href="#Game-429"><span class="linenos">429</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">()</span>
</span><span id="Game-430"><a href="#Game-430"><span class="linenos">430</span></a>
</span><span id="Game-431"><a href="#Game-431"><span class="linenos">431</span></a>        <span class="c1"># Add players as they were added</span>
</span><span id="Game-432"><a href="#Game-432"><span class="linenos">432</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">)):</span>
</span><span id="Game-433"><a href="#Game-433"><span class="linenos">433</span></a>            <span class="n">player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Game-434"><a href="#Game-434"><span class="linenos">434</span></a>            <span class="n">player_asked_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players_asked_location</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Game-435"><a href="#Game-435"><span class="linenos">435</span></a>            <span class="k">if</span> <span class="n">keep_players</span><span class="p">:</span>
</span><span id="Game-436"><a href="#Game-436"><span class="linenos">436</span></a>                <span class="n">player_team</span> <span class="o">=</span> <span class="p">[</span><span class="n">team</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">previous_initial_state</span><span class="o">.</span><span class="n">teams</span> <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">previous_initial_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Game-437"><a href="#Game-437"><span class="linenos">437</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_player</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">player_team</span><span class="p">,</span> <span class="n">player_asked_location</span><span class="p">)</span>
</span><span id="Game-438"><a href="#Game-438"><span class="linenos">438</span></a>
</span><span id="Game-439"><a href="#Game-439"><span class="linenos">439</span></a>        <span class="c1"># Indicate that the game was reset</span>
</span><span id="Game-440"><a href="#Game-440"><span class="linenos">440</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__reset_called</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Game-441"><a href="#Game-441"><span class="linenos">441</span></a>
</span><span id="Game-442"><a href="#Game-442"><span class="linenos">442</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-443"><a href="#Game-443"><span class="linenos">443</span></a>
</span><span id="Game-444"><a href="#Game-444"><span class="linenos">444</span></a>    <span class="k">def</span> <span class="nf">start</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span>
</span><span id="Game-445"><a href="#Game-445"><span class="linenos">445</span></a>              <span class="p">)</span> <span class="o">-&gt;</span>    <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="Game-446"><a href="#Game-446"><span class="linenos">446</span></a>
</span><span id="Game-447"><a href="#Game-447"><span class="linenos">447</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game-448"><a href="#Game-448"><span class="linenos">448</span></a><span class="sd">            Starts a game, asking players for decisions until the game is over.</span>
</span><span id="Game-449"><a href="#Game-449"><span class="linenos">449</span></a><span class="sd">            In:</span>
</span><span id="Game-450"><a href="#Game-450"><span class="linenos">450</span></a><span class="sd">                * self: Reference to the current object.</span>
</span><span id="Game-451"><a href="#Game-451"><span class="linenos">451</span></a><span class="sd">            Out:</span>
</span><span id="Game-452"><a href="#Game-452"><span class="linenos">452</span></a><span class="sd">                * stats: Game statistics computed during the game.</span>
</span><span id="Game-453"><a href="#Game-453"><span class="linenos">453</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game-454"><a href="#Game-454"><span class="linenos">454</span></a>        
</span><span id="Game-455"><a href="#Game-455"><span class="linenos">455</span></a>        <span class="c1"># Debug</span>
</span><span id="Game-456"><a href="#Game-456"><span class="linenos">456</span></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;No player was added to the game&quot;</span>
</span><span id="Game-457"><a href="#Game-457"><span class="linenos">457</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">__reset_called</span><span class="p">,</span> <span class="s2">&quot;The game was not reset before starting&quot;</span>
</span><span id="Game-458"><a href="#Game-458"><span class="linenos">458</span></a>
</span><span id="Game-459"><a href="#Game-459"><span class="linenos">459</span></a>        <span class="c1"># We catch exceptions that may happen during the game</span>
</span><span id="Game-460"><a href="#Game-460"><span class="linenos">460</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Game-461"><a href="#Game-461"><span class="linenos">461</span></a>        
</span><span id="Game-462"><a href="#Game-462"><span class="linenos">462</span></a>            <span class="c1"># Mark the game as not reset</span>
</span><span id="Game-463"><a href="#Game-463"><span class="linenos">463</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__reset_called</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Game-464"><a href="#Game-464"><span class="linenos">464</span></a>
</span><span id="Game-465"><a href="#Game-465"><span class="linenos">465</span></a>            <span class="c1"># Initialize stats</span>
</span><span id="Game-466"><a href="#Game-466"><span class="linenos">466</span></a>            <span class="n">stats</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;players&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;turns&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
</span><span id="Game-467"><a href="#Game-467"><span class="linenos">467</span></a>            <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-468"><a href="#Game-468"><span class="linenos">468</span></a>                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game-469"><a href="#Game-469"><span class="linenos">469</span></a>                                                 <span class="s2">&quot;preprocessing_duration&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game-470"><a href="#Game-470"><span class="linenos">470</span></a>                                                 <span class="s2">&quot;turn_durations&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="Game-471"><a href="#Game-471"><span class="linenos">471</span></a>                                                 <span class="s2">&quot;team&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">team</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span> <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Game-472"><a href="#Game-472"><span class="linenos">472</span></a>                                                 <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">Action</span><span class="o">.</span><span class="n">NOTHING</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game-473"><a href="#Game-473"><span class="linenos">473</span></a>                                                             <span class="n">Action</span><span class="o">.</span><span class="n">NORTH</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game-474"><a href="#Game-474"><span class="linenos">474</span></a>                                                             <span class="n">Action</span><span class="o">.</span><span class="n">EAST</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game-475"><a href="#Game-475"><span class="linenos">475</span></a>                                                             <span class="n">Action</span><span class="o">.</span><span class="n">SOUTH</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game-476"><a href="#Game-476"><span class="linenos">476</span></a>                                                             <span class="n">Action</span><span class="o">.</span><span class="n">WEST</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game-477"><a href="#Game-477"><span class="linenos">477</span></a>                                                             <span class="s2">&quot;mud&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game-478"><a href="#Game-478"><span class="linenos">478</span></a>                                                             <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game-479"><a href="#Game-479"><span class="linenos">479</span></a>                                                             <span class="s2">&quot;miss&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game-480"><a href="#Game-480"><span class="linenos">480</span></a>                                                             <span class="s2">&quot;wall&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">}}</span>
</span><span id="Game-481"><a href="#Game-481"><span class="linenos">481</span></a>            
</span><span id="Game-482"><a href="#Game-482"><span class="linenos">482</span></a>            <span class="c1"># In multiprocessing mode, prepare processes</span>
</span><span id="Game-483"><a href="#Game-483"><span class="linenos">483</span></a>            <span class="n">maze_per_player</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="p">)</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="Game-484"><a href="#Game-484"><span class="linenos">484</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">,</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">]:</span>
</span><span id="Game-485"><a href="#Game-485"><span class="linenos">485</span></a>
</span><span id="Game-486"><a href="#Game-486"><span class="linenos">486</span></a>                <span class="c1"># Create a process per player</span>
</span><span id="Game-487"><a href="#Game-487"><span class="linenos">487</span></a>                <span class="n">turn_start_synchronizer</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Barrier</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game-488"><a href="#Game-488"><span class="linenos">488</span></a>                <span class="n">turn_timeout_lock</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</span><span id="Game-489"><a href="#Game-489"><span class="linenos">489</span></a>                <span class="n">player_processes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Game-490"><a href="#Game-490"><span class="linenos">490</span></a>                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-491"><a href="#Game-491"><span class="linenos">491</span></a>                    <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;process&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;input_queue&quot;</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Queue</span><span class="p">(),</span> <span class="s2">&quot;output_queue&quot;</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Queue</span><span class="p">(),</span> <span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Barrier</span><span class="p">(</span><span class="mi">2</span><span class="p">)}</span>
</span><span id="Game-492"><a href="#Game-492"><span class="linenos">492</span></a>                    <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;process&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_player_process_function</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">maze_per_player</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;input_queue&quot;</span><span class="p">],</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">],</span> <span class="n">turn_start_synchronizer</span><span class="p">,</span> <span class="n">turn_timeout_lock</span><span class="p">,</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,))</span>
</span><span id="Game-493"><a href="#Game-493"><span class="linenos">493</span></a>                    <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;process&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="Game-494"><a href="#Game-494"><span class="linenos">494</span></a>
</span><span id="Game-495"><a href="#Game-495"><span class="linenos">495</span></a>                <span class="c1"># If playing in standard mode, we create processs to wait instead of missing players</span>
</span><span id="Game-496"><a href="#Game-496"><span class="linenos">496</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">:</span>
</span><span id="Game-497"><a href="#Game-497"><span class="linenos">497</span></a>                    <span class="n">waiter_processes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Game-498"><a href="#Game-498"><span class="linenos">498</span></a>                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-499"><a href="#Game-499"><span class="linenos">499</span></a>                        <span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;process&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;input_queue&quot;</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Queue</span><span class="p">()}</span>
</span><span id="Game-500"><a href="#Game-500"><span class="linenos">500</span></a>                        <span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;process&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_waiter_process_function</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;input_queue&quot;</span><span class="p">],</span> <span class="n">turn_start_synchronizer</span><span class="p">,))</span>
</span><span id="Game-501"><a href="#Game-501"><span class="linenos">501</span></a>                        <span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;process&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="Game-502"><a href="#Game-502"><span class="linenos">502</span></a>
</span><span id="Game-503"><a href="#Game-503"><span class="linenos">503</span></a>            <span class="c1"># Add cheese</span>
</span><span id="Game-504"><a href="#Game-504"><span class="linenos">504</span></a>            <span class="n">available_cells</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">vertices</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="Game-505"><a href="#Game-505"><span class="linenos">505</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">cheese</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__distribute_cheese</span><span class="p">(</span><span class="n">available_cells</span><span class="p">))</span>
</span><span id="Game-506"><a href="#Game-506"><span class="linenos">506</span></a>            <span class="n">game_state</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="p">)</span>
</span><span id="Game-507"><a href="#Game-507"><span class="linenos">507</span></a>            
</span><span id="Game-508"><a href="#Game-508"><span class="linenos">508</span></a>            <span class="c1"># Initial rendering of the maze</span>
</span><span id="Game-509"><a href="#Game-509"><span class="linenos">509</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="p">,</span> <span class="n">game_state</span><span class="p">)</span>
</span><span id="Game-510"><a href="#Game-510"><span class="linenos">510</span></a>            
</span><span id="Game-511"><a href="#Game-511"><span class="linenos">511</span></a>            <span class="c1"># We play until the game is over</span>
</span><span id="Game-512"><a href="#Game-512"><span class="linenos">512</span></a>            <span class="n">players_ready</span> <span class="o">=</span> <span class="p">[</span><span class="n">player</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">]</span>
</span><span id="Game-513"><a href="#Game-513"><span class="linenos">513</span></a>            <span class="n">players_running</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="kc">True</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="Game-514"><a href="#Game-514"><span class="linenos">514</span></a>            <span class="n">all_action_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">action</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">Action</span><span class="p">]</span>
</span><span id="Game-515"><a href="#Game-515"><span class="linenos">515</span></a>            <span class="k">while</span> <span class="nb">any</span><span class="p">(</span><span class="n">players_running</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="Game-516"><a href="#Game-516"><span class="linenos">516</span></a>
</span><span id="Game-517"><a href="#Game-517"><span class="linenos">517</span></a>                <span class="c1"># We communicate the state of the game to the players not in mud</span>
</span><span id="Game-518"><a href="#Game-518"><span class="linenos">518</span></a>                <span class="n">game_phases</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="Game-519"><a href="#Game-519"><span class="linenos">519</span></a>                <span class="n">turn_actions</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="s2">&quot;miss&quot;</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="Game-520"><a href="#Game-520"><span class="linenos">520</span></a>                <span class="n">durations</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="Game-521"><a href="#Game-521"><span class="linenos">521</span></a>                <span class="k">for</span> <span class="n">ready_player</span> <span class="ow">in</span> <span class="n">players_ready</span><span class="p">:</span>
</span><span id="Game-522"><a href="#Game-522"><span class="linenos">522</span></a>                    <span class="n">final_stats</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span> <span class="k">if</span> <span class="n">game_state</span><span class="o">.</span><span class="n">game_over</span><span class="p">()</span> <span class="k">else</span> <span class="p">{}</span>
</span><span id="Game-523"><a href="#Game-523"><span class="linenos">523</span></a>                    <span class="n">player_game_state</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">game_state</span><span class="p">)</span>
</span><span id="Game-524"><a href="#Game-524"><span class="linenos">524</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">,</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">]:</span>
</span><span id="Game-525"><a href="#Game-525"><span class="linenos">525</span></a>                        <span class="n">player_processes</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;input_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">player_game_state</span><span class="p">,</span> <span class="n">final_stats</span><span class="p">))</span>
</span><span id="Game-526"><a href="#Game-526"><span class="linenos">526</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Game-527"><a href="#Game-527"><span class="linenos">527</span></a>                        <span class="n">turn_actions</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">durations</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_player_process_function</span><span class="p">(</span><span class="n">ready_player</span><span class="p">,</span> <span class="n">maze_per_player</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">player_game_state</span><span class="p">,</span> <span class="n">final_stats</span><span class="p">)</span>
</span><span id="Game-528"><a href="#Game-528"><span class="linenos">528</span></a>                
</span><span id="Game-529"><a href="#Game-529"><span class="linenos">529</span></a>                <span class="c1"># In multiprocessing mode, we for everybody to receive data to start</span>
</span><span id="Game-530"><a href="#Game-530"><span class="linenos">530</span></a>                <span class="c1"># In sequential mode, decisions are already received at this point</span>
</span><span id="Game-531"><a href="#Game-531"><span class="linenos">531</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">,</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">]:</span>
</span><span id="Game-532"><a href="#Game-532"><span class="linenos">532</span></a>                    <span class="n">turn_start_synchronizer</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="Game-533"><a href="#Game-533"><span class="linenos">533</span></a>
</span><span id="Game-534"><a href="#Game-534"><span class="linenos">534</span></a>                <span class="c1"># Wait a bit</span>
</span><span id="Game-535"><a href="#Game-535"><span class="linenos">535</span></a>                <span class="n">sleep_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__preprocessing_time</span> <span class="k">if</span> <span class="n">game_state</span><span class="o">.</span><span class="n">turn</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">__turn_time</span>
</span><span id="Game-536"><a href="#Game-536"><span class="linenos">536</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>
</span><span id="Game-537"><a href="#Game-537"><span class="linenos">537</span></a>
</span><span id="Game-538"><a href="#Game-538"><span class="linenos">538</span></a>                <span class="c1"># In synchronous mode, we wait for everyone</span>
</span><span id="Game-539"><a href="#Game-539"><span class="linenos">539</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">:</span>
</span><span id="Game-540"><a href="#Game-540"><span class="linenos">540</span></a>                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-541"><a href="#Game-541"><span class="linenos">541</span></a>                        <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="Game-542"><a href="#Game-542"><span class="linenos">542</span></a>                        <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="Game-543"><a href="#Game-543"><span class="linenos">543</span></a>
</span><span id="Game-544"><a href="#Game-544"><span class="linenos">544</span></a>                <span class="c1"># In standard mode, we block the possibility to return an action and check who answered in time</span>
</span><span id="Game-545"><a href="#Game-545"><span class="linenos">545</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">:</span>
</span><span id="Game-546"><a href="#Game-546"><span class="linenos">546</span></a>
</span><span id="Game-547"><a href="#Game-547"><span class="linenos">547</span></a>                    <span class="c1"># Wait at least for those in mud</span>
</span><span id="Game-548"><a href="#Game-548"><span class="linenos">548</span></a>                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-549"><a href="#Game-549"><span class="linenos">549</span></a>                        <span class="k">if</span> <span class="n">game_state</span><span class="o">.</span><span class="n">is_in_mud</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">players_running</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]:</span>
</span><span id="Game-550"><a href="#Game-550"><span class="linenos">550</span></a>                            <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="Game-551"><a href="#Game-551"><span class="linenos">551</span></a>                            <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="Game-552"><a href="#Game-552"><span class="linenos">552</span></a>
</span><span id="Game-553"><a href="#Game-553"><span class="linenos">553</span></a>                    <span class="c1"># For others, set timeout and wait for output info of those who passed just before timeout</span>
</span><span id="Game-554"><a href="#Game-554"><span class="linenos">554</span></a>                    <span class="k">with</span> <span class="n">turn_timeout_lock</span><span class="p">:</span>
</span><span id="Game-555"><a href="#Game-555"><span class="linenos">555</span></a>                        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-556"><a href="#Game-556"><span class="linenos">556</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">game_state</span><span class="o">.</span><span class="n">is_in_mud</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">players_running</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]:</span>
</span><span id="Game-557"><a href="#Game-557"><span class="linenos">557</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
</span><span id="Game-558"><a href="#Game-558"><span class="linenos">558</span></a>                                    <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="Game-559"><a href="#Game-559"><span class="linenos">559</span></a>                                    <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="Game-560"><a href="#Game-560"><span class="linenos">560</span></a>
</span><span id="Game-561"><a href="#Game-561"><span class="linenos">561</span></a>                <span class="c1"># Check which players are ready to continue</span>
</span><span id="Game-562"><a href="#Game-562"><span class="linenos">562</span></a>                <span class="n">players_ready</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Game-563"><a href="#Game-563"><span class="linenos">563</span></a>                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-564"><a href="#Game-564"><span class="linenos">564</span></a>                    <span class="k">if</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;postprocessing&quot;</span><span class="p">:</span>
</span><span id="Game-565"><a href="#Game-565"><span class="linenos">565</span></a>                        <span class="n">players_running</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Game-566"><a href="#Game-566"><span class="linenos">566</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span> <span class="ow">and</span> <span class="p">(</span><span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;postprocessing&quot;</span> <span class="ow">or</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;miss&quot;</span><span class="p">):</span>
</span><span id="Game-567"><a href="#Game-567"><span class="linenos">567</span></a>                        <span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;input_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Game-568"><a href="#Game-568"><span class="linenos">568</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Game-569"><a href="#Game-569"><span class="linenos">569</span></a>                        <span class="n">players_ready</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
</span><span id="Game-570"><a href="#Game-570"><span class="linenos">570</span></a>
</span><span id="Game-571"><a href="#Game-571"><span class="linenos">571</span></a>                <span class="c1"># Check for errors</span>
</span><span id="Game-572"><a href="#Game-572"><span class="linenos">572</span></a>                <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">])</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__continue_on_error</span><span class="p">:</span>
</span><span id="Game-573"><a href="#Game-573"><span class="linenos">573</span></a>                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;A player has crashed, exiting&quot;</span><span class="p">)</span>
</span><span id="Game-574"><a href="#Game-574"><span class="linenos">574</span></a>
</span><span id="Game-575"><a href="#Game-575"><span class="linenos">575</span></a>                <span class="c1"># We save the turn info if we are not postprocessing</span>
</span><span id="Game-576"><a href="#Game-576"><span class="linenos">576</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">game_state</span><span class="o">.</span><span class="n">game_over</span><span class="p">():</span>
</span><span id="Game-577"><a href="#Game-577"><span class="linenos">577</span></a>                
</span><span id="Game-578"><a href="#Game-578"><span class="linenos">578</span></a>                    <span class="c1"># Apply the actions</span>
</span><span id="Game-579"><a href="#Game-579"><span class="linenos">579</span></a>                    <span class="n">corrected_actions</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">Action</span><span class="p">(</span><span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span> <span class="k">if</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">in</span> <span class="n">all_action_names</span> <span class="k">else</span> <span class="n">Action</span><span class="o">.</span><span class="n">NOTHING</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="Game-580"><a href="#Game-580"><span class="linenos">580</span></a>                    <span class="n">new_game_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__determine_new_game_state</span><span class="p">(</span><span class="n">game_state</span><span class="p">,</span> <span class="n">corrected_actions</span><span class="p">)</span>
</span><span id="Game-581"><a href="#Game-581"><span class="linenos">581</span></a>
</span><span id="Game-582"><a href="#Game-582"><span class="linenos">582</span></a>                    <span class="c1"># Save stats</span>
</span><span id="Game-583"><a href="#Game-583"><span class="linenos">583</span></a>                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-584"><a href="#Game-584"><span class="linenos">584</span></a>                        <span class="k">if</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
</span><span id="Game-585"><a href="#Game-585"><span class="linenos">585</span></a>                            <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="s2">&quot;miss&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Game-586"><a href="#Game-586"><span class="linenos">586</span></a>                        <span class="k">elif</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;preprocessing&quot;</span><span class="p">:</span>
</span><span id="Game-587"><a href="#Game-587"><span class="linenos">587</span></a>                            <span class="k">if</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">in</span> <span class="n">all_action_names</span> <span class="ow">and</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Action</span><span class="o">.</span><span class="n">NOTHING</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="n">game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">is_in_mud</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
</span><span id="Game-588"><a href="#Game-588"><span class="linenos">588</span></a>                                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="s2">&quot;wall&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Game-589"><a href="#Game-589"><span class="linenos">589</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="Game-590"><a href="#Game-590"><span class="linenos">590</span></a>                                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Game-591"><a href="#Game-591"><span class="linenos">591</span></a>                            <span class="k">if</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;mud&quot;</span><span class="p">:</span>
</span><span id="Game-592"><a href="#Game-592"><span class="linenos">592</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corrected_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="Game-593"><a href="#Game-593"><span class="linenos">593</span></a>                        <span class="k">if</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Game-594"><a href="#Game-594"><span class="linenos">594</span></a>                            <span class="k">if</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;preprocessing&quot;</span><span class="p">:</span>
</span><span id="Game-595"><a href="#Game-595"><span class="linenos">595</span></a>                                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;preprocessing_duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="Game-596"><a href="#Game-596"><span class="linenos">596</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="Game-597"><a href="#Game-597"><span class="linenos">597</span></a>                                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_durations&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="Game-598"><a href="#Game-598"><span class="linenos">598</span></a>                        <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">score_per_player</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="Game-599"><a href="#Game-599"><span class="linenos">599</span></a>                    <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;turns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">game_state</span><span class="o">.</span><span class="n">turn</span>
</span><span id="Game-600"><a href="#Game-600"><span class="linenos">600</span></a>                    
</span><span id="Game-601"><a href="#Game-601"><span class="linenos">601</span></a>                    <span class="c1"># Go to next turn</span>
</span><span id="Game-602"><a href="#Game-602"><span class="linenos">602</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="p">,</span> <span class="n">new_game_state</span><span class="p">)</span>
</span><span id="Game-603"><a href="#Game-603"><span class="linenos">603</span></a>                    <span class="n">game_state</span> <span class="o">=</span> <span class="n">new_game_state</span>
</span><span id="Game-604"><a href="#Game-604"><span class="linenos">604</span></a>
</span><span id="Game-605"><a href="#Game-605"><span class="linenos">605</span></a>        <span class="c1"># In case of an error, we ignore stats</span>
</span><span id="Game-606"><a href="#Game-606"><span class="linenos">606</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Game-607"><a href="#Game-607"><span class="linenos">607</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="Game-608"><a href="#Game-608"><span class="linenos">608</span></a>            <span class="n">stats</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Game-609"><a href="#Game-609"><span class="linenos">609</span></a>        
</span><span id="Game-610"><a href="#Game-610"><span class="linenos">610</span></a>        <span class="c1"># Apply end actions before returning</span>
</span><span id="Game-611"><a href="#Game-611"><span class="linenos">611</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__end</span><span class="p">(</span><span class="n">stats</span> <span class="o">==</span> <span class="p">{})</span>
</span><span id="Game-612"><a href="#Game-612"><span class="linenos">612</span></a>        <span class="k">return</span> <span class="n">stats</span>
</span><span id="Game-613"><a href="#Game-613"><span class="linenos">613</span></a>
</span><span id="Game-614"><a href="#Game-614"><span class="linenos">614</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-615"><a href="#Game-615"><span class="linenos">615</span></a>    <span class="c1">#                                                              PRIVATE METHODS                                                              #</span>
</span><span id="Game-616"><a href="#Game-616"><span class="linenos">616</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-617"><a href="#Game-617"><span class="linenos">617</span></a>
</span><span id="Game-618"><a href="#Game-618"><span class="linenos">618</span></a>    <span class="k">def</span> <span class="nf">__end</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>         <span class="n">Self</span><span class="p">,</span>
</span><span id="Game-619"><a href="#Game-619"><span class="linenos">619</span></a>                <span class="n">game_crashed</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span><span id="Game-620"><a href="#Game-620"><span class="linenos">620</span></a>              <span class="p">)</span> <span class="o">-&gt;</span>            <span class="kc">None</span><span class="p">:</span>
</span><span id="Game-621"><a href="#Game-621"><span class="linenos">621</span></a><span class="w">        </span>
</span><span id="Game-622"><a href="#Game-622"><span class="linenos">622</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game-623"><a href="#Game-623"><span class="linenos">623</span></a><span class="sd">            Actions to do at the end of the game if needed.</span>
</span><span id="Game-624"><a href="#Game-624"><span class="linenos">624</span></a><span class="sd">            In:</span>
</span><span id="Game-625"><a href="#Game-625"><span class="linenos">625</span></a><span class="sd">                * self:         Reference to the current object.</span>
</span><span id="Game-626"><a href="#Game-626"><span class="linenos">626</span></a><span class="sd">                * game_crashed: Indicates if the game crashed.</span>
</span><span id="Game-627"><a href="#Game-627"><span class="linenos">627</span></a><span class="sd">            Out:</span>
</span><span id="Game-628"><a href="#Game-628"><span class="linenos">628</span></a><span class="sd">                * None.</span>
</span><span id="Game-629"><a href="#Game-629"><span class="linenos">629</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game-630"><a href="#Game-630"><span class="linenos">630</span></a>
</span><span id="Game-631"><a href="#Game-631"><span class="linenos">631</span></a>        <span class="c1"># Debug</span>
</span><span id="Game-632"><a href="#Game-632"><span class="linenos">632</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">game_crashed</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;game_crashed&#39; must be a boolean&quot;</span>
</span><span id="Game-633"><a href="#Game-633"><span class="linenos">633</span></a>
</span><span id="Game-634"><a href="#Game-634"><span class="linenos">634</span></a>        <span class="c1"># We save the game if asked</span>
</span><span id="Game-635"><a href="#Game-635"><span class="linenos">635</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__save_game</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">game_crashed</span><span class="p">:</span>
</span><span id="Game-636"><a href="#Game-636"><span class="linenos">636</span></a>            
</span><span id="Game-637"><a href="#Game-637"><span class="linenos">637</span></a>            <span class="c1"># Create the saves directory if needed</span>
</span><span id="Game-638"><a href="#Game-638"><span class="linenos">638</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__save_path</span><span class="p">):</span>
</span><span id="Game-639"><a href="#Game-639"><span class="linenos">639</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__save_path</span><span class="p">)</span>
</span><span id="Game-640"><a href="#Game-640"><span class="linenos">640</span></a>
</span><span id="Game-641"><a href="#Game-641"><span class="linenos">641</span></a>            <span class="c1"># Prepare the config dictionary</span>
</span><span id="Game-642"><a href="#Game-642"><span class="linenos">642</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;game_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{GAME_MODE}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="Game-643"><a href="#Game-643"><span class="linenos">643</span></a>                      <span class="s2">&quot;fixed_maze&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">as_dict</span><span class="p">(),</span>
</span><span id="Game-644"><a href="#Game-644"><span class="linenos">644</span></a>                      <span class="s2">&quot;fixed_cheese&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">cheese</span><span class="p">}</span>
</span><span id="Game-645"><a href="#Game-645"><span class="linenos">645</span></a>            
</span><span id="Game-646"><a href="#Game-646"><span class="linenos">646</span></a>            <span class="c1"># Create a description of the players</span>
</span><span id="Game-647"><a href="#Game-647"><span class="linenos">647</span></a>            <span class="n">player_descriptions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Game-648"><a href="#Game-648"><span class="linenos">648</span></a>            <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-649"><a href="#Game-649"><span class="linenos">649</span></a>                <span class="n">player_descriptions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="Game-650"><a href="#Game-650"><span class="linenos">650</span></a>                                            <span class="s2">&quot;skin&quot;</span><span class="p">:</span> <span class="s2">&quot;{SKIN_&quot;</span> <span class="o">+</span> <span class="n">player</span><span class="o">.</span><span class="n">skin</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span>
</span><span id="Game-651"><a href="#Game-651"><span class="linenos">651</span></a>                                            <span class="s2">&quot;team&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">team</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span> <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Game-652"><a href="#Game-652"><span class="linenos">652</span></a>                                            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="Game-653"><a href="#Game-653"><span class="linenos">653</span></a>                                            <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="s2">&quot;{ACTIONS_&quot;</span> <span class="o">+</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">})</span>
</span><span id="Game-654"><a href="#Game-654"><span class="linenos">654</span></a>
</span><span id="Game-655"><a href="#Game-655"><span class="linenos">655</span></a>            <span class="c1"># Create the players&#39; file, forcing players to their initial locations</span>
</span><span id="Game-656"><a href="#Game-656"><span class="linenos">656</span></a>            <span class="n">output_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__save_path</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y_%m_</span><span class="si">%d</span><span class="s2">_%H_%M_%S_</span><span class="si">%f</span><span class="s2">.ipynb&quot;</span><span class="p">))</span>
</span><span id="Game-657"><a href="#Game-657"><span class="linenos">657</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s2">&quot;save_template.ipynb&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">save_template_file</span><span class="p">:</span>
</span><span id="Game-658"><a href="#Game-658"><span class="linenos">658</span></a>                <span class="n">save_template</span> <span class="o">=</span> <span class="n">save_template_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="Game-659"><a href="#Game-659"><span class="linenos">659</span></a>                <span class="n">save_template</span> <span class="o">=</span> <span class="n">save_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{PLAYERS}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">player_descriptions</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;}, &quot;</span><span class="p">,</span> <span class="s2">&quot;},</span><span class="se">\\</span><span class="s2">n                       &quot;</span><span class="p">))</span>
</span><span id="Game-660"><a href="#Game-660"><span class="linenos">660</span></a>                <span class="n">save_template</span> <span class="o">=</span> <span class="n">save_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{CONFIG}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;, &#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;,</span><span class="se">\\</span><span class="s2">n          &#39;&quot;</span><span class="p">))</span>
</span><span id="Game-661"><a href="#Game-661"><span class="linenos">661</span></a>                <span class="n">save_template</span> <span class="o">=</span> <span class="n">save_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">{GAME_MODE}</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;GameMode.SYNCHRONOUS&quot;</span><span class="p">)</span>
</span><span id="Game-662"><a href="#Game-662"><span class="linenos">662</span></a>                <span class="k">for</span> <span class="n">skin</span> <span class="ow">in</span> <span class="n">PlayerSkin</span><span class="p">:</span>
</span><span id="Game-663"><a href="#Game-663"><span class="linenos">663</span></a>                    <span class="n">save_template</span> <span class="o">=</span> <span class="n">save_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;{SKIN_&quot;</span> <span class="o">+</span> <span class="n">skin</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;}&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;PlayerSkin.&quot;</span> <span class="o">+</span> <span class="n">skin</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="Game-664"><a href="#Game-664"><span class="linenos">664</span></a>                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-665"><a href="#Game-665"><span class="linenos">665</span></a>                    <span class="n">save_template</span> <span class="o">=</span> <span class="n">save_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;{ACTIONS_&quot;</span> <span class="o">+</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;}&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;Action.&quot;</span> <span class="o">+</span> <span class="n">action</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">)</span>
</span><span id="Game-666"><a href="#Game-666"><span class="linenos">666</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file_name</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
</span><span id="Game-667"><a href="#Game-667"><span class="linenos">667</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">save_template</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">output_file</span><span class="p">)</span>
</span><span id="Game-668"><a href="#Game-668"><span class="linenos">668</span></a>
</span><span id="Game-669"><a href="#Game-669"><span class="linenos">669</span></a>        <span class="c1"># Apply ending actions of the rendering engine</span>
</span><span id="Game-670"><a href="#Game-670"><span class="linenos">670</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</span><span id="Game-671"><a href="#Game-671"><span class="linenos">671</span></a>        
</span><span id="Game-672"><a href="#Game-672"><span class="linenos">672</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-673"><a href="#Game-673"><span class="linenos">673</span></a>
</span><span id="Game-674"><a href="#Game-674"><span class="linenos">674</span></a>    <span class="k">def</span> <span class="nf">__determine_new_game_state</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>       <span class="n">Self</span><span class="p">,</span>
</span><span id="Game-675"><a href="#Game-675"><span class="linenos">675</span></a>                                     <span class="n">game_state</span><span class="p">:</span> <span class="n">GameState</span><span class="p">,</span>
</span><span id="Game-676"><a href="#Game-676"><span class="linenos">676</span></a>                                     <span class="n">actions</span><span class="p">:</span>    <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Action</span><span class="p">]</span>
</span><span id="Game-677"><a href="#Game-677"><span class="linenos">677</span></a>                                   <span class="p">)</span> <span class="o">-&gt;</span>          <span class="n">GameState</span><span class="p">:</span>
</span><span id="Game-678"><a href="#Game-678"><span class="linenos">678</span></a><span class="w">        </span>
</span><span id="Game-679"><a href="#Game-679"><span class="linenos">679</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game-680"><a href="#Game-680"><span class="linenos">680</span></a><span class="sd">            Updates the game state after a turn, given decisions of players.</span>
</span><span id="Game-681"><a href="#Game-681"><span class="linenos">681</span></a><span class="sd">            In:</span>
</span><span id="Game-682"><a href="#Game-682"><span class="linenos">682</span></a><span class="sd">                * self:       Reference to the current object.</span>
</span><span id="Game-683"><a href="#Game-683"><span class="linenos">683</span></a><span class="sd">                * game_state: Current game state.</span>
</span><span id="Game-684"><a href="#Game-684"><span class="linenos">684</span></a><span class="sd">                * actions:    Action performed per player.</span>
</span><span id="Game-685"><a href="#Game-685"><span class="linenos">685</span></a><span class="sd">            Out:</span>
</span><span id="Game-686"><a href="#Game-686"><span class="linenos">686</span></a><span class="sd">                * new_game_state: New game state after the turn.</span>
</span><span id="Game-687"><a href="#Game-687"><span class="linenos">687</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game-688"><a href="#Game-688"><span class="linenos">688</span></a>
</span><span id="Game-689"><a href="#Game-689"><span class="linenos">689</span></a>        <span class="c1"># Debug</span>
</span><span id="Game-690"><a href="#Game-690"><span class="linenos">690</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">game_state</span><span class="p">,</span> <span class="n">GameState</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;game_state&#39; must be of type &#39;pyrat.GameState&#39;&quot;</span>
</span><span id="Game-691"><a href="#Game-691"><span class="linenos">691</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;actions&#39; must be a dictionary&quot;</span>
</span><span id="Game-692"><a href="#Game-692"><span class="linenos">692</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">player_name</span> <span class="ow">in</span> <span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">]</span> <span class="k">for</span> <span class="n">player_name</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">),</span> <span class="s2">&quot;All players must be in the game&quot;</span>
</span><span id="Game-693"><a href="#Game-693"><span class="linenos">693</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">action</span> <span class="ow">in</span> <span class="n">Action</span> <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">actions</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="s2">&quot;All actions must be of type &#39;pyrat.Action&#39;&quot;</span>
</span><span id="Game-694"><a href="#Game-694"><span class="linenos">694</span></a>
</span><span id="Game-695"><a href="#Game-695"><span class="linenos">695</span></a>        <span class="c1"># Initialize new game state</span>
</span><span id="Game-696"><a href="#Game-696"><span class="linenos">696</span></a>        <span class="n">new_game_state</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">game_state</span><span class="p">)</span>
</span><span id="Game-697"><a href="#Game-697"><span class="linenos">697</span></a>        <span class="n">new_game_state</span><span class="o">.</span><span class="n">turn</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Game-698"><a href="#Game-698"><span class="linenos">698</span></a>
</span><span id="Game-699"><a href="#Game-699"><span class="linenos">699</span></a>        <span class="c1"># Move all players accordingly</span>
</span><span id="Game-700"><a href="#Game-700"><span class="linenos">700</span></a>        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-701"><a href="#Game-701"><span class="linenos">701</span></a>            <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_to_rc</span><span class="p">(</span><span class="n">game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="Game-702"><a href="#Game-702"><span class="linenos">702</span></a>            <span class="n">target</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-703"><a href="#Game-703"><span class="linenos">703</span></a>            <span class="k">if</span> <span class="n">actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">Action</span><span class="o">.</span><span class="n">NORTH</span> <span class="ow">and</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Game-704"><a href="#Game-704"><span class="linenos">704</span></a>                <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
</span><span id="Game-705"><a href="#Game-705"><span class="linenos">705</span></a>            <span class="k">elif</span> <span class="n">actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">Action</span><span class="o">.</span><span class="n">SOUTH</span> <span class="ow">and</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Game-706"><a href="#Game-706"><span class="linenos">706</span></a>                <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
</span><span id="Game-707"><a href="#Game-707"><span class="linenos">707</span></a>            <span class="k">elif</span> <span class="n">actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">Action</span><span class="o">.</span><span class="n">WEST</span> <span class="ow">and</span> <span class="n">col</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Game-708"><a href="#Game-708"><span class="linenos">708</span></a>                <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game-709"><a href="#Game-709"><span class="linenos">709</span></a>            <span class="k">elif</span> <span class="n">actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">Action</span><span class="o">.</span><span class="n">EAST</span> <span class="ow">and</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Game-710"><a href="#Game-710"><span class="linenos">710</span></a>                <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game-711"><a href="#Game-711"><span class="linenos">711</span></a>            <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_exists</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">target</span><span class="p">):</span>
</span><span id="Game-712"><a href="#Game-712"><span class="linenos">712</span></a>                <span class="n">weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">get_weight</span><span class="p">(</span><span class="n">game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">target</span><span class="p">)</span>
</span><span id="Game-713"><a href="#Game-713"><span class="linenos">713</span></a>                <span class="k">if</span> <span class="n">weight</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Game-714"><a href="#Game-714"><span class="linenos">714</span></a>                    <span class="n">new_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span>
</span><span id="Game-715"><a href="#Game-715"><span class="linenos">715</span></a>                <span class="k">elif</span> <span class="n">weight</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Game-716"><a href="#Game-716"><span class="linenos">716</span></a>                    <span class="n">new_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span>
</span><span id="Game-717"><a href="#Game-717"><span class="linenos">717</span></a>                    <span class="n">new_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
</span><span id="Game-718"><a href="#Game-718"><span class="linenos">718</span></a>
</span><span id="Game-719"><a href="#Game-719"><span class="linenos">719</span></a>        <span class="c1"># All players in mud advance a bit</span>
</span><span id="Game-720"><a href="#Game-720"><span class="linenos">720</span></a>        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-721"><a href="#Game-721"><span class="linenos">721</span></a>            <span class="k">if</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">is_in_mud</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
</span><span id="Game-722"><a href="#Game-722"><span class="linenos">722</span></a>                <span class="n">new_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Game-723"><a href="#Game-723"><span class="linenos">723</span></a>                <span class="k">if</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Game-724"><a href="#Game-724"><span class="linenos">724</span></a>                    <span class="n">new_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>
</span><span id="Game-725"><a href="#Game-725"><span class="linenos">725</span></a>                    <span class="n">new_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game-726"><a href="#Game-726"><span class="linenos">726</span></a>
</span><span id="Game-727"><a href="#Game-727"><span class="linenos">727</span></a>        <span class="c1"># Update cheese and scores</span>
</span><span id="Game-728"><a href="#Game-728"><span class="linenos">728</span></a>        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">game_state</span><span class="o">.</span><span class="n">cheese</span><span class="p">:</span>
</span><span id="Game-729"><a href="#Game-729"><span class="linenos">729</span></a>            <span class="n">players_on_cheese</span> <span class="o">=</span> <span class="p">[</span><span class="n">player</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span> <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]]</span>
</span><span id="Game-730"><a href="#Game-730"><span class="linenos">730</span></a>            <span class="k">for</span> <span class="n">player_on_cheese</span> <span class="ow">in</span> <span class="n">players_on_cheese</span><span class="p">:</span>
</span><span id="Game-731"><a href="#Game-731"><span class="linenos">731</span></a>                <span class="n">new_game_state</span><span class="o">.</span><span class="n">score_per_player</span><span class="p">[</span><span class="n">player_on_cheese</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">players_on_cheese</span><span class="p">)</span>
</span><span id="Game-732"><a href="#Game-732"><span class="linenos">732</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">players_on_cheese</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Game-733"><a href="#Game-733"><span class="linenos">733</span></a>                <span class="n">new_game_state</span><span class="o">.</span><span class="n">cheese</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Game-734"><a href="#Game-734"><span class="linenos">734</span></a>        
</span><span id="Game-735"><a href="#Game-735"><span class="linenos">735</span></a>        <span class="c1"># Store trace for GUI</span>
</span><span id="Game-736"><a href="#Game-736"><span class="linenos">736</span></a>        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game-737"><a href="#Game-737"><span class="linenos">737</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="Game-738"><a href="#Game-738"><span class="linenos">738</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">__trace_length</span><span class="p">:]</span>
</span><span id="Game-739"><a href="#Game-739"><span class="linenos">739</span></a>        
</span><span id="Game-740"><a href="#Game-740"><span class="linenos">740</span></a>        <span class="c1"># Return new game state</span>
</span><span id="Game-741"><a href="#Game-741"><span class="linenos">741</span></a>        <span class="k">return</span> <span class="n">new_game_state</span>
</span><span id="Game-742"><a href="#Game-742"><span class="linenos">742</span></a>        
</span><span id="Game-743"><a href="#Game-743"><span class="linenos">743</span></a>    <span class="c1">#############################################################################################################################################</span>
</span><span id="Game-744"><a href="#Game-744"><span class="linenos">744</span></a>
</span><span id="Game-745"><a href="#Game-745"><span class="linenos">745</span></a>    <span class="k">def</span> <span class="nf">__distribute_cheese</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>            <span class="n">Self</span><span class="p">,</span>
</span><span id="Game-746"><a href="#Game-746"><span class="linenos">746</span></a>                              <span class="n">available_cells</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Integral</span><span class="p">],</span>
</span><span id="Game-747"><a href="#Game-747"><span class="linenos">747</span></a>                            <span class="p">)</span> <span class="o">-&gt;</span>               <span class="n">List</span><span class="p">[</span><span class="n">Integral</span><span class="p">]:</span>
</span><span id="Game-748"><a href="#Game-748"><span class="linenos">748</span></a><span class="w">        </span>
</span><span id="Game-749"><a href="#Game-749"><span class="linenos">749</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game-750"><a href="#Game-750"><span class="linenos">750</span></a><span class="sd">            Distributes pieces of cheese in the maze, according to the provided criteria.</span>
</span><span id="Game-751"><a href="#Game-751"><span class="linenos">751</span></a><span class="sd">            If a fixed list of cheese was provided, it is used.</span>
</span><span id="Game-752"><a href="#Game-752"><span class="linenos">752</span></a><span class="sd">            Otherwise, the cheese is distributed randomly.</span>
</span><span id="Game-753"><a href="#Game-753"><span class="linenos">753</span></a><span class="sd">            In:</span>
</span><span id="Game-754"><a href="#Game-754"><span class="linenos">754</span></a><span class="sd">                * self:            Reference to the current object.</span>
</span><span id="Game-755"><a href="#Game-755"><span class="linenos">755</span></a><span class="sd">                * available_cells: List of indices of cells that can be used to place cheese.</span>
</span><span id="Game-756"><a href="#Game-756"><span class="linenos">756</span></a><span class="sd">            Out:</span>
</span><span id="Game-757"><a href="#Game-757"><span class="linenos">757</span></a><span class="sd">                * cheese: List of indices of cells containing cheese.</span>
</span><span id="Game-758"><a href="#Game-758"><span class="linenos">758</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game-759"><a href="#Game-759"><span class="linenos">759</span></a>        
</span><span id="Game-760"><a href="#Game-760"><span class="linenos">760</span></a>        <span class="c1"># Debug</span>
</span><span id="Game-761"><a href="#Game-761"><span class="linenos">761</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">available_cells</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;available_cells&#39; must be a list&quot;</span>
</span><span id="Game-762"><a href="#Game-762"><span class="linenos">762</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">available_cells</span><span class="p">]),</span> <span class="s2">&quot;All elements of &#39;available_cells&#39; must be integers&quot;</span>
</span><span id="Game-763"><a href="#Game-763"><span class="linenos">763</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_exists</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">available_cells</span><span class="p">]),</span> <span class="s2">&quot;All elements of &#39;available_cells&#39; must be valid indices of the maze&quot;</span>
</span><span id="Game-764"><a href="#Game-764"><span class="linenos">764</span></a>
</span><span id="Game-765"><a href="#Game-765"><span class="linenos">765</span></a>        <span class="c1"># If we ask for a fixed list of cheese, we use it</span>
</span><span id="Game-766"><a href="#Game-766"><span class="linenos">766</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Game-767"><a href="#Game-767"><span class="linenos">767</span></a>            
</span><span id="Game-768"><a href="#Game-768"><span class="linenos">768</span></a>            <span class="c1"># Debug</span>
</span><span id="Game-769"><a href="#Game-769"><span class="linenos">769</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="s2">&quot;Attribute &#39;__fixed_cheese&#39; must be a list&quot;</span>
</span><span id="Game-770"><a href="#Game-770"><span class="linenos">770</span></a>            <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">]),</span> <span class="s2">&quot;All elements of &#39;__fixed_cheese&#39; must be integers&quot;</span>
</span><span id="Game-771"><a href="#Game-771"><span class="linenos">771</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">),</span> <span class="s2">&quot;All elements of &#39;__fixed_cheese&#39; must be unique&quot;</span>
</span><span id="Game-772"><a href="#Game-772"><span class="linenos">772</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">available_cells</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">),</span> <span class="s2">&quot;Not enough available cells to place the fixed cheese&quot;</span>
</span><span id="Game-773"><a href="#Game-773"><span class="linenos">773</span></a>            <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_exists</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">]),</span> <span class="s2">&quot;All elements of &#39;__fixed_cheese&#39; must be valid indices of the maze&quot;</span>
</span><span id="Game-774"><a href="#Game-774"><span class="linenos">774</span></a>            <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">cell</span> <span class="ow">in</span> <span class="n">available_cells</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">]),</span> <span class="s2">&quot;All elements of &#39;__fixed_cheese&#39; must be in &#39;available_cells&#39;&quot;</span>
</span><span id="Game-775"><a href="#Game-775"><span class="linenos">775</span></a>
</span><span id="Game-776"><a href="#Game-776"><span class="linenos">776</span></a>            <span class="c1"># Place the cheese</span>
</span><span id="Game-777"><a href="#Game-777"><span class="linenos">777</span></a>            <span class="n">cheese</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span><span class="p">)</span>
</span><span id="Game-778"><a href="#Game-778"><span class="linenos">778</span></a>
</span><span id="Game-779"><a href="#Game-779"><span class="linenos">779</span></a>        <span class="c1"># Otherwise, we place the cheese randomly</span>
</span><span id="Game-780"><a href="#Game-780"><span class="linenos">780</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Game-781"><a href="#Game-781"><span class="linenos">781</span></a>            
</span><span id="Game-782"><a href="#Game-782"><span class="linenos">782</span></a>            <span class="c1"># Debug</span>
</span><span id="Game-783"><a href="#Game-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span><span class="p">,</span> <span class="n">Integral</span><span class="p">),</span> <span class="s2">&quot;Attribute &#39;__nb_cheese&#39; must be an integer&quot;</span>
</span><span id="Game-784"><a href="#Game-784"><span class="linenos">784</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Attribute &#39;__nb_cheese&#39; must be positive&quot;</span>
</span><span id="Game-785"><a href="#Game-785"><span class="linenos">785</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">available_cells</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span><span class="p">,</span> <span class="s2">&quot;Not enough available cells to place the cheese&quot;</span>
</span><span id="Game-786"><a href="#Game-786"><span class="linenos">786</span></a>
</span><span id="Game-787"><a href="#Game-787"><span class="linenos">787</span></a>            <span class="c1"># Place the cheese randomly</span>
</span><span id="Game-788"><a href="#Game-788"><span class="linenos">788</span></a>            <span class="n">rng</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">Random</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_cheese</span><span class="p">)</span>
</span><span id="Game-789"><a href="#Game-789"><span class="linenos">789</span></a>            <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">available_cells</span><span class="p">)</span>
</span><span id="Game-790"><a href="#Game-790"><span class="linenos">790</span></a>            <span class="n">cheese</span> <span class="o">=</span> <span class="n">available_cells</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span><span class="p">]</span>
</span><span id="Game-791"><a href="#Game-791"><span class="linenos">791</span></a>
</span><span id="Game-792"><a href="#Game-792"><span class="linenos">792</span></a>        <span class="c1"># Return the cheese</span>
</span><span id="Game-793"><a href="#Game-793"><span class="linenos">793</span></a>        <span class="k">return</span> <span class="n">cheese</span>
</span></pre></div>


            <div class="docstring"><p>A game is a class that allows to play a game of PyRat.
It is initialized with the parameters of the game.
Players should then be added to the game using the add_player method.
Finally, the start method should be called to start the game.
Once the game is over, it will provide statistics about the game.
Set your own parameters to define interesting objectives for the players.</p>
</div>


                            <div id="Game.__init__" class="classattr">
                                        <input id="Game.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Game</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">random_seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">random_seed_maze</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">random_seed_cheese</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">random_seed_players</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">maze_width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">maze_height</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">cell_percentage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">wall_percentage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mud_percentage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mud_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fixed_maze</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">]],</span> <span class="n">Any</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">nb_cheese</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fixed_cheese</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">random_maze_algorithm</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="enums.html#RandomMazeAlgorithm">pyrat.src.enums.RandomMazeAlgorithm</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">render_mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="enums.html#RenderMode">pyrat.src.enums.RenderMode</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">render_simplified</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">gui_speed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">trace_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fullscreen</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">save_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">save_game</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">preprocessing_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">turn_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">game_mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="enums.html#GameMode">pyrat.src.enums.GameMode</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">continue_on_error</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Game.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Game.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Game.__init__-101"><a href="#Game.__init__-101"><span class="linenos">101</span></a>    <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>                  <span class="n">Self</span><span class="p">,</span>
</span><span id="Game.__init__-102"><a href="#Game.__init__-102"><span class="linenos">102</span></a>                   <span class="n">random_seed</span><span class="p">:</span>           <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-103"><a href="#Game.__init__-103"><span class="linenos">103</span></a>                   <span class="n">random_seed_maze</span><span class="p">:</span>      <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-104"><a href="#Game.__init__-104"><span class="linenos">104</span></a>                   <span class="n">random_seed_cheese</span><span class="p">:</span>    <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-105"><a href="#Game.__init__-105"><span class="linenos">105</span></a>                   <span class="n">random_seed_players</span><span class="p">:</span>   <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-106"><a href="#Game.__init__-106"><span class="linenos">106</span></a>                   <span class="n">maze_width</span><span class="p">:</span>            <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-107"><a href="#Game.__init__-107"><span class="linenos">107</span></a>                   <span class="n">maze_height</span><span class="p">:</span>           <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-108"><a href="#Game.__init__-108"><span class="linenos">108</span></a>                   <span class="n">cell_percentage</span><span class="p">:</span>       <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-109"><a href="#Game.__init__-109"><span class="linenos">109</span></a>                   <span class="n">wall_percentage</span><span class="p">:</span>       <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-110"><a href="#Game.__init__-110"><span class="linenos">110</span></a>                   <span class="n">mud_percentage</span><span class="p">:</span>        <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-111"><a href="#Game.__init__-111"><span class="linenos">111</span></a>                   <span class="n">mud_range</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Integral</span><span class="p">,</span> <span class="n">Integral</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-112"><a href="#Game.__init__-112"><span class="linenos">112</span></a>                   <span class="n">fixed_maze</span><span class="p">:</span>            <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Integral</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Integral</span><span class="p">,</span> <span class="n">Integral</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-113"><a href="#Game.__init__-113"><span class="linenos">113</span></a>                   <span class="n">nb_cheese</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-114"><a href="#Game.__init__-114"><span class="linenos">114</span></a>                   <span class="n">fixed_cheese</span><span class="p">:</span>          <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Integral</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-115"><a href="#Game.__init__-115"><span class="linenos">115</span></a>                   <span class="n">random_maze_algorithm</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RandomMazeAlgorithm</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-116"><a href="#Game.__init__-116"><span class="linenos">116</span></a>                   <span class="n">render_mode</span><span class="p">:</span>           <span class="n">Optional</span><span class="p">[</span><span class="n">RenderMode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-117"><a href="#Game.__init__-117"><span class="linenos">117</span></a>                   <span class="n">render_simplified</span><span class="p">:</span>     <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-118"><a href="#Game.__init__-118"><span class="linenos">118</span></a>                   <span class="n">gui_speed</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-119"><a href="#Game.__init__-119"><span class="linenos">119</span></a>                   <span class="n">trace_length</span><span class="p">:</span>          <span class="n">Optional</span><span class="p">[</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-120"><a href="#Game.__init__-120"><span class="linenos">120</span></a>                   <span class="n">fullscreen</span><span class="p">:</span>            <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-121"><a href="#Game.__init__-121"><span class="linenos">121</span></a>                   <span class="n">save_path</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-122"><a href="#Game.__init__-122"><span class="linenos">122</span></a>                   <span class="n">save_game</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-123"><a href="#Game.__init__-123"><span class="linenos">123</span></a>                   <span class="n">preprocessing_time</span><span class="p">:</span>    <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-124"><a href="#Game.__init__-124"><span class="linenos">124</span></a>                   <span class="n">turn_time</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-125"><a href="#Game.__init__-125"><span class="linenos">125</span></a>                   <span class="n">game_mode</span><span class="p">:</span>             <span class="n">Optional</span><span class="p">[</span><span class="n">GameMode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.__init__-126"><a href="#Game.__init__-126"><span class="linenos">126</span></a>                   <span class="n">continue_on_error</span><span class="p">:</span>     <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game.__init__-127"><a href="#Game.__init__-127"><span class="linenos">127</span></a>                 <span class="p">)</span> <span class="o">-&gt;</span>                     <span class="n">Self</span><span class="p">:</span>
</span><span id="Game.__init__-128"><a href="#Game.__init__-128"><span class="linenos">128</span></a>
</span><span id="Game.__init__-129"><a href="#Game.__init__-129"><span class="linenos">129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game.__init__-130"><a href="#Game.__init__-130"><span class="linenos">130</span></a><span class="sd">            This function is the constructor of the class.</span>
</span><span id="Game.__init__-131"><a href="#Game.__init__-131"><span class="linenos">131</span></a><span class="sd">            When an object is instantiated, this method is called to initialize the object.</span>
</span><span id="Game.__init__-132"><a href="#Game.__init__-132"><span class="linenos">132</span></a><span class="sd">            This is where you should define the attributes of the object and set their initial values.</span>
</span><span id="Game.__init__-133"><a href="#Game.__init__-133"><span class="linenos">133</span></a><span class="sd">            Assertions checked in the objects manipulated by the game are not checked again.</span>
</span><span id="Game.__init__-134"><a href="#Game.__init__-134"><span class="linenos">134</span></a><span class="sd">            In:</span>
</span><span id="Game.__init__-135"><a href="#Game.__init__-135"><span class="linenos">135</span></a><span class="sd">                * self:                  Reference to the current object.</span>
</span><span id="Game.__init__-136"><a href="#Game.__init__-136"><span class="linenos">136</span></a><span class="sd">                * random_seed:           Global random seed for all elements, set to None for a random value.</span>
</span><span id="Game.__init__-137"><a href="#Game.__init__-137"><span class="linenos">137</span></a><span class="sd">                * random_seed_maze:      Random seed for the maze generation, set to None for a random value.</span>
</span><span id="Game.__init__-138"><a href="#Game.__init__-138"><span class="linenos">138</span></a><span class="sd">                * random_seed_cheese:    Random seed for the pieces of cheese distribution, set to None for a random value.</span>
</span><span id="Game.__init__-139"><a href="#Game.__init__-139"><span class="linenos">139</span></a><span class="sd">                * random_seed_players:   Random seed for the initial location of players, set to None for a random value.</span>
</span><span id="Game.__init__-140"><a href="#Game.__init__-140"><span class="linenos">140</span></a><span class="sd">                * maze_width:            Width of the maze in number of cells.</span>
</span><span id="Game.__init__-141"><a href="#Game.__init__-141"><span class="linenos">141</span></a><span class="sd">                * maze_height:           Height of the maze in number of cells.</span>
</span><span id="Game.__init__-142"><a href="#Game.__init__-142"><span class="linenos">142</span></a><span class="sd">                * cell_percentage:       Percentage of cells that can be accessed in the maze, 0%% being a useless maze, and 100%% being a full rectangular maze.</span>
</span><span id="Game.__init__-143"><a href="#Game.__init__-143"><span class="linenos">143</span></a><span class="sd">                * wall_percentage:       Percentage of walls in the maze, 0%% being an empty maze, and 100%% being the maximum number of walls that keep the maze connected.</span>
</span><span id="Game.__init__-144"><a href="#Game.__init__-144"><span class="linenos">144</span></a><span class="sd">                * mud_percentage:        Percentage of pairs of adjacent cells that are separated by mud in the maze.</span>
</span><span id="Game.__init__-145"><a href="#Game.__init__-145"><span class="linenos">145</span></a><span class="sd">                * mud_range:             Interval of turns needed to cross mud.</span>
</span><span id="Game.__init__-146"><a href="#Game.__init__-146"><span class="linenos">146</span></a><span class="sd">                * fixed_maze:            Fixed maze in any PyRat accepted representation (dictionary, numpy.ndarray or torch.tensor).</span>
</span><span id="Game.__init__-147"><a href="#Game.__init__-147"><span class="linenos">147</span></a><span class="sd">                * random_maze_algorithm: Algorithm to generate the maze.</span>
</span><span id="Game.__init__-148"><a href="#Game.__init__-148"><span class="linenos">148</span></a><span class="sd">                * nb_cheese:             Number of pieces of cheese in the maze.</span>
</span><span id="Game.__init__-149"><a href="#Game.__init__-149"><span class="linenos">149</span></a><span class="sd">                * fixed_cheese:          Fixed list of cheese.</span>
</span><span id="Game.__init__-150"><a href="#Game.__init__-150"><span class="linenos">150</span></a><span class="sd">                * render_mode:           Method to display the game.</span>
</span><span id="Game.__init__-151"><a href="#Game.__init__-151"><span class="linenos">151</span></a><span class="sd">                * render_simplified:     If the maze is rendered, hides some elements that are not essential.</span>
</span><span id="Game.__init__-152"><a href="#Game.__init__-152"><span class="linenos">152</span></a><span class="sd">                * gui_speed:             When rendering as GUI, controls the speed of the game (GUI rendering only).</span>
</span><span id="Game.__init__-153"><a href="#Game.__init__-153"><span class="linenos">153</span></a><span class="sd">                * trace_length:          Maximum length of the trace to display when players are moving (GUI rendering only).</span>
</span><span id="Game.__init__-154"><a href="#Game.__init__-154"><span class="linenos">154</span></a><span class="sd">                * fullscreen:            Renders the game in fullscreen mode (GUI rendering only).</span>
</span><span id="Game.__init__-155"><a href="#Game.__init__-155"><span class="linenos">155</span></a><span class="sd">                * save_path:             Path where games are saved.</span>
</span><span id="Game.__init__-156"><a href="#Game.__init__-156"><span class="linenos">156</span></a><span class="sd">                * save_game:             Indicates if the game should be saved.</span>
</span><span id="Game.__init__-157"><a href="#Game.__init__-157"><span class="linenos">157</span></a><span class="sd">                * preprocessing_time:    Time given to the players before the game starts.</span>
</span><span id="Game.__init__-158"><a href="#Game.__init__-158"><span class="linenos">158</span></a><span class="sd">                * turn_time:             Time after which players will miss a turn.</span>
</span><span id="Game.__init__-159"><a href="#Game.__init__-159"><span class="linenos">159</span></a><span class="sd">                * game_mode:             Indicates if players play concurrently, wait for each other, or if multiprocessing is disabled.</span>
</span><span id="Game.__init__-160"><a href="#Game.__init__-160"><span class="linenos">160</span></a><span class="sd">                * continue_on_error:     If a player crashes, continues the game anyway.</span>
</span><span id="Game.__init__-161"><a href="#Game.__init__-161"><span class="linenos">161</span></a><span class="sd">            Out:</span>
</span><span id="Game.__init__-162"><a href="#Game.__init__-162"><span class="linenos">162</span></a><span class="sd">                * A new instance of the class.</span>
</span><span id="Game.__init__-163"><a href="#Game.__init__-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game.__init__-164"><a href="#Game.__init__-164"><span class="linenos">164</span></a>        
</span><span id="Game.__init__-165"><a href="#Game.__init__-165"><span class="linenos">165</span></a>        <span class="c1"># Debug</span>
</span><span id="Game.__init__-166"><a href="#Game.__init__-166"><span class="linenos">166</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_seed</span><span class="p">,</span> <span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_seed&#39; must be an integer or None (if so, default value &#39;Game.DEFAULT_RANDOM_SEED&#39; is used)&quot;</span>
</span><span id="Game.__init__-167"><a href="#Game.__init__-167"><span class="linenos">167</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_seed_maze</span><span class="p">,</span> <span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_seed_maze&#39; must be an integer or None (if so, default value &#39;Game.DEFAULT_RANDOM_SEED_MAZE&#39; is used)&quot;</span>
</span><span id="Game.__init__-168"><a href="#Game.__init__-168"><span class="linenos">168</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_seed_cheese</span><span class="p">,</span> <span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_seed_cheese&#39; must be an integer or None (if so, default value &#39;Game.DEFAULT_RANDOM_SEED_CHEESE&#39; is used)&quot;</span>
</span><span id="Game.__init__-169"><a href="#Game.__init__-169"><span class="linenos">169</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_seed_players</span><span class="p">,</span> <span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_seed_players&#39; must be an integer or None (if so, default value &#39;Game.DEFAULT_RANDOM_SEED_PLAYERS&#39; is used)&quot;</span>
</span><span id="Game.__init__-170"><a href="#Game.__init__-170"><span class="linenos">170</span></a>        <span class="k">assert</span> <span class="n">random_seed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">random_seed</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;random_seed&#39; should be non-negative&quot;</span>
</span><span id="Game.__init__-171"><a href="#Game.__init__-171"><span class="linenos">171</span></a>        <span class="k">assert</span> <span class="n">random_seed_maze</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">random_seed_maze</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;random_seed_maze&#39; should be a positive integer&quot;</span>
</span><span id="Game.__init__-172"><a href="#Game.__init__-172"><span class="linenos">172</span></a>        <span class="k">assert</span> <span class="n">random_seed_cheese</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">random_seed_cheese</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;random_seed_cheese&#39; should be a positive integer&quot;</span>
</span><span id="Game.__init__-173"><a href="#Game.__init__-173"><span class="linenos">173</span></a>        <span class="k">assert</span> <span class="n">random_seed_players</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed_players</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">random_seed_players</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;random_seed_players&#39; should be a positive integer&quot;</span>
</span><span id="Game.__init__-174"><a href="#Game.__init__-174"><span class="linenos">174</span></a>        <span class="k">assert</span> <span class="n">random_seed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">random_seed_maze</span><span class="p">,</span> <span class="n">random_seed_cheese</span><span class="p">,</span> <span class="n">random_seed_players</span><span class="p">]])),</span> <span class="s2">&quot;Argument &#39;random_seed&#39; should be given if and only if no other random seed is given&quot;</span>
</span><span id="Game.__init__-175"><a href="#Game.__init__-175"><span class="linenos">175</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">render_mode</span><span class="p">,</span> <span class="p">(</span><span class="n">RenderMode</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;render_mode&#39; must be of type &#39;pyrat.RenderMode&#39; or None (if so, default value &#39;Game.DEFAULT_RENDER_MODE&#39; is used)&quot;</span>
</span><span id="Game.__init__-176"><a href="#Game.__init__-176"><span class="linenos">176</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">turn_time</span><span class="p">,</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;turn_time&#39; must be a real number or None (if so, default value &#39;Game.DEFAULT_TURN_TIME&#39; is used)&quot;</span>
</span><span id="Game.__init__-177"><a href="#Game.__init__-177"><span class="linenos">177</span></a>        <span class="k">assert</span> <span class="n">turn_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">turn_time</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Argument &#39;turn_time&#39; should be non-negative&quot;</span>
</span><span id="Game.__init__-178"><a href="#Game.__init__-178"><span class="linenos">178</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preprocessing_time</span><span class="p">,</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;preprocessing_time&#39; must be a real number or None (if so, default value &#39;Game.DEFAULT_PREPROCESSING_TIME&#39; is used)&quot;</span>
</span><span id="Game.__init__-179"><a href="#Game.__init__-179"><span class="linenos">179</span></a>        <span class="k">assert</span> <span class="n">preprocessing_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">preprocessing_time</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Argument &#39;preprocessing_time&#39; should be non-negative&quot;</span>
</span><span id="Game.__init__-180"><a href="#Game.__init__-180"><span class="linenos">180</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">game_mode</span><span class="p">,</span> <span class="p">(</span><span class="n">GameMode</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;game_mode&#39; must be of type &#39;pyrat.GameMode&#39; or None (if so, default value &#39;Game.DEFAULT_GAME_MODE&#39; is used)&quot;</span>
</span><span id="Game.__init__-181"><a href="#Game.__init__-181"><span class="linenos">181</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">continue_on_error</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;continue_on_error&#39; must be a boolean or None (if so, default value &#39;Game.DEFAULT_CONTINUE_ON_ERROR&#39; is used)&quot;</span>
</span><span id="Game.__init__-182"><a href="#Game.__init__-182"><span class="linenos">182</span></a>        <span class="k">assert</span> <span class="ow">not</span><span class="p">(</span><span class="n">game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SEQUENTIAL</span> <span class="ow">and</span> <span class="n">render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span><span class="p">),</span> <span class="s2">&quot;Cannot render GUI in sequential mode&quot;</span>
</span><span id="Game.__init__-183"><a href="#Game.__init__-183"><span class="linenos">183</span></a>        <span class="k">assert</span> <span class="n">fixed_maze</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fixed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">random_seed_maze</span><span class="p">,</span> <span class="n">random_maze_algorithm</span><span class="p">,</span> <span class="n">maze_width</span><span class="p">,</span> <span class="n">maze_height</span><span class="p">,</span> <span class="n">cell_percentage</span><span class="p">,</span> <span class="n">wall_percentage</span><span class="p">,</span> <span class="n">mud_percentage</span><span class="p">,</span> <span class="n">mud_range</span><span class="p">])),</span> <span class="s2">&quot;Argument &#39;fixed_maze&#39; should be given if and only if no other maze description is given&quot;</span>
</span><span id="Game.__init__-184"><a href="#Game.__init__-184"><span class="linenos">184</span></a>        <span class="k">assert</span> <span class="n">fixed_cheese</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fixed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">random_seed_cheese</span><span class="p">,</span> <span class="n">nb_cheese</span><span class="p">])),</span> <span class="s2">&quot;Argument &#39;fixed_cheese&#39; should be given if and only if no other cheese description is given&quot;</span>
</span><span id="Game.__init__-185"><a href="#Game.__init__-185"><span class="linenos">185</span></a>        <span class="k">assert</span> <span class="n">game_mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">game_mode</span> <span class="o">!=</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SIMULATION</span> <span class="ow">or</span> <span class="p">(</span><span class="n">game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SIMULATION</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">render_mode</span><span class="p">,</span> <span class="n">preprocessing_time</span><span class="p">,</span> <span class="n">turn_time</span><span class="p">]])),</span> <span class="s2">&quot;Some parameters should be set when running in simulation mode&quot;</span>
</span><span id="Game.__init__-186"><a href="#Game.__init__-186"><span class="linenos">186</span></a>        <span class="k">assert</span> <span class="n">render_mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span> <span class="ow">or</span> <span class="p">(</span><span class="n">render_mode</span> <span class="o">!=</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">[</span><span class="n">trace_length</span><span class="p">,</span> <span class="n">gui_speed</span><span class="p">,</span> <span class="n">fullscreen</span><span class="p">]])),</span> <span class="s2">&quot;Some parameters should be set only when rendering in GUI mode&quot;</span>
</span><span id="Game.__init__-187"><a href="#Game.__init__-187"><span class="linenos">187</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_maze_algorithm</span><span class="p">,</span> <span class="p">(</span><span class="n">RandomMazeAlgorithm</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;random_maze_algorithm&#39; must be of type &#39;pyrat.RandomMazeAlgorithm&#39; or None (if so, default value &#39;Game.DEFAULT_RANDOM_MAZE_ALGORITHM&#39; is used)&quot;</span>
</span><span id="Game.__init__-188"><a href="#Game.__init__-188"><span class="linenos">188</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">save_game</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;save_game&#39; must be a boolean or None (if so, default value &#39;Game.DEFAULT_SAVE_GAME&#39; is used)&quot;</span>
</span><span id="Game.__init__-189"><a href="#Game.__init__-189"><span class="linenos">189</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))),</span> <span class="s2">&quot;Argument &#39;save_path&#39; must be a string or None (if so, default value &#39;Game.DEFAULT_SAVE_PATH&#39; is used)&quot;</span>
</span><span id="Game.__init__-190"><a href="#Game.__init__-190"><span class="linenos">190</span></a>        <span class="k">assert</span> <span class="n">save_path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">is_valid_directory</span><span class="p">(</span><span class="n">save_path</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;save_path&#39; must be a valid directory&quot;</span>
</span><span id="Game.__init__-191"><a href="#Game.__init__-191"><span class="linenos">191</span></a>
</span><span id="Game.__init__-192"><a href="#Game.__init__-192"><span class="linenos">192</span></a>        <span class="c1"># Store given parameters or default values</span>
</span><span id="Game.__init__-193"><a href="#Game.__init__-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="o">=</span> <span class="n">random_seed</span> <span class="k">if</span> <span class="n">random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_SEED</span>
</span><span id="Game.__init__-194"><a href="#Game.__init__-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_maze</span> <span class="o">=</span> <span class="n">random_seed_maze</span> <span class="k">if</span> <span class="n">random_seed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_SEED_MAZE</span>
</span><span id="Game.__init__-195"><a href="#Game.__init__-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_cheese</span> <span class="o">=</span> <span class="n">random_seed_cheese</span> <span class="k">if</span> <span class="n">random_seed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_SEED_CHEESE</span>
</span><span id="Game.__init__-196"><a href="#Game.__init__-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_players</span> <span class="o">=</span> <span class="n">random_seed_players</span> <span class="k">if</span> <span class="n">random_seed_players</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_SEED_PLAYERS</span>
</span><span id="Game.__init__-197"><a href="#Game.__init__-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span> <span class="o">=</span> <span class="n">maze_width</span> <span class="k">if</span> <span class="n">maze_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_MAZE_WIDTH</span>
</span><span id="Game.__init__-198"><a href="#Game.__init__-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span> <span class="o">=</span> <span class="n">maze_height</span> <span class="k">if</span> <span class="n">maze_height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_MAZE_HEIGHT</span>
</span><span id="Game.__init__-199"><a href="#Game.__init__-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span> <span class="o">=</span> <span class="n">cell_percentage</span> <span class="k">if</span> <span class="n">cell_percentage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_CELL_PERCENTAGE</span>
</span><span id="Game.__init__-200"><a href="#Game.__init__-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span> <span class="o">=</span> <span class="n">wall_percentage</span> <span class="k">if</span> <span class="n">wall_percentage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_WALL_PERCENTAGE</span>
</span><span id="Game.__init__-201"><a href="#Game.__init__-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span> <span class="o">=</span> <span class="n">mud_percentage</span> <span class="k">if</span> <span class="n">mud_percentage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_MUD_PERCENTAGE</span>
</span><span id="Game.__init__-202"><a href="#Game.__init__-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span> <span class="o">=</span> <span class="n">mud_range</span> <span class="k">if</span> <span class="n">mud_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_MUD_RANGE</span>
</span><span id="Game.__init__-203"><a href="#Game.__init__-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span> <span class="o">=</span> <span class="n">fixed_maze</span> <span class="k">if</span> <span class="n">fixed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_FIXED_MAZE</span>
</span><span id="Game.__init__-204"><a href="#Game.__init__-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span> <span class="o">=</span> <span class="n">random_maze_algorithm</span> <span class="k">if</span> <span class="n">random_maze_algorithm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RANDOM_MAZE_ALGORITHM</span>
</span><span id="Game.__init__-205"><a href="#Game.__init__-205"><span class="linenos">205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__nb_cheese</span> <span class="o">=</span> <span class="n">nb_cheese</span> <span class="k">if</span> <span class="n">nb_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_NB_CHEESE</span>
</span><span id="Game.__init__-206"><a href="#Game.__init__-206"><span class="linenos">206</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_cheese</span> <span class="o">=</span> <span class="n">fixed_cheese</span> <span class="k">if</span> <span class="n">fixed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_FIXED_CHEESE</span>
</span><span id="Game.__init__-207"><a href="#Game.__init__-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">=</span> <span class="n">render_mode</span> <span class="k">if</span> <span class="n">render_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RENDER_MODE</span>
</span><span id="Game.__init__-208"><a href="#Game.__init__-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span> <span class="o">=</span> <span class="n">render_simplified</span> <span class="k">if</span> <span class="n">render_simplified</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_RENDER_SIMPLIFIED</span>
</span><span id="Game.__init__-209"><a href="#Game.__init__-209"><span class="linenos">209</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__gui_speed</span> <span class="o">=</span> <span class="n">gui_speed</span> <span class="k">if</span> <span class="n">gui_speed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_GUI_SPEED</span>
</span><span id="Game.__init__-210"><a href="#Game.__init__-210"><span class="linenos">210</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__trace_length</span> <span class="o">=</span> <span class="n">trace_length</span> <span class="k">if</span> <span class="n">trace_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_TRACE_LENGTH</span>
</span><span id="Game.__init__-211"><a href="#Game.__init__-211"><span class="linenos">211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__fullscreen</span> <span class="o">=</span> <span class="n">fullscreen</span> <span class="k">if</span> <span class="n">fullscreen</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_FULLSCREEN</span>
</span><span id="Game.__init__-212"><a href="#Game.__init__-212"><span class="linenos">212</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__save_path</span> <span class="o">=</span> <span class="n">save_path</span> <span class="k">if</span> <span class="n">save_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_SAVE_PATH</span>
</span><span id="Game.__init__-213"><a href="#Game.__init__-213"><span class="linenos">213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__save_game</span> <span class="o">=</span> <span class="n">save_game</span> <span class="k">if</span> <span class="n">save_game</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_SAVE_GAME</span>
</span><span id="Game.__init__-214"><a href="#Game.__init__-214"><span class="linenos">214</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__preprocessing_time</span> <span class="o">=</span> <span class="n">preprocessing_time</span> <span class="k">if</span> <span class="n">preprocessing_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_PREPROCESSING_TIME</span>
</span><span id="Game.__init__-215"><a href="#Game.__init__-215"><span class="linenos">215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__turn_time</span> <span class="o">=</span> <span class="n">turn_time</span> <span class="k">if</span> <span class="n">turn_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_TURN_TIME</span>
</span><span id="Game.__init__-216"><a href="#Game.__init__-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">=</span> <span class="n">game_mode</span> <span class="k">if</span> <span class="n">game_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_GAME_MODE</span>
</span><span id="Game.__init__-217"><a href="#Game.__init__-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__continue_on_error</span> <span class="o">=</span> <span class="n">continue_on_error</span> <span class="k">if</span> <span class="n">continue_on_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Game</span><span class="o">.</span><span class="n">DEFAULT_CONTINUE_ON_ERROR</span>
</span><span id="Game.__init__-218"><a href="#Game.__init__-218"><span class="linenos">218</span></a>
</span><span id="Game.__init__-219"><a href="#Game.__init__-219"><span class="linenos">219</span></a>        <span class="c1"># If the game is in simulation mode, we enforce some parameters</span>
</span><span id="Game.__init__-220"><a href="#Game.__init__-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SIMULATION</span><span class="p">:</span>
</span><span id="Game.__init__-221"><a href="#Game.__init__-221"><span class="linenos">221</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__preprocessing_time</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="Game.__init__-222"><a href="#Game.__init__-222"><span class="linenos">222</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__turn_time</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="Game.__init__-223"><a href="#Game.__init__-223"><span class="linenos">223</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">=</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">NO_RENDERING</span>
</span><span id="Game.__init__-224"><a href="#Game.__init__-224"><span class="linenos">224</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">=</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SEQUENTIAL</span>
</span><span id="Game.__init__-225"><a href="#Game.__init__-225"><span class="linenos">225</span></a>
</span><span id="Game.__init__-226"><a href="#Game.__init__-226"><span class="linenos">226</span></a>        <span class="c1"># Private attributes</span>
</span><span id="Game.__init__-227"><a href="#Game.__init__-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game.__init__-228"><a href="#Game.__init__-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_cheese</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game.__init__-229"><a href="#Game.__init__-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_players</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game.__init__-230"><a href="#Game.__init__-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players_rng</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game.__init__-231"><a href="#Game.__init__-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players_asked_location</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Game.__init__-232"><a href="#Game.__init__-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Game.__init__-233"><a href="#Game.__init__-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game.__init__-234"><a href="#Game.__init__-234"><span class="linenos">234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game.__init__-235"><a href="#Game.__init__-235"><span class="linenos">235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game.__init__-236"><a href="#Game.__init__-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game.__init__-237"><a href="#Game.__init__-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Game.__init__-238"><a href="#Game.__init__-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__reset_called</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Game.__init__-239"><a href="#Game.__init__-239"><span class="linenos">239</span></a>
</span><span id="Game.__init__-240"><a href="#Game.__init__-240"><span class="linenos">240</span></a>        <span class="c1"># Initialize the game</span>
</span><span id="Game.__init__-241"><a href="#Game.__init__-241"><span class="linenos">241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>This function is the constructor of the class.
When an object is instantiated, this method is called to initialize the object.
This is where you should define the attributes of the object and set their initial values.
Assertions checked in the objects manipulated by the game are not checked again.</p>

<h6 id="in">In:</h6>

<blockquote>
  <ul>
  <li>self:                  Reference to the current object.</li>
  <li>random_seed:           Global random seed for all elements, set to None for a random value.</li>
  <li>random_seed_maze:      Random seed for the maze generation, set to None for a random value.</li>
  <li>random_seed_cheese:    Random seed for the pieces of cheese distribution, set to None for a random value.</li>
  <li>random_seed_players:   Random seed for the initial location of players, set to None for a random value.</li>
  <li>maze_width:            Width of the maze in number of cells.</li>
  <li>maze_height:           Height of the maze in number of cells.</li>
  <li>cell_percentage:       Percentage of cells that can be accessed in the maze, 0%% being a useless maze, and 100%% being a full rectangular maze.</li>
  <li>wall_percentage:       Percentage of walls in the maze, 0%% being an empty maze, and 100%% being the maximum number of walls that keep the maze connected.</li>
  <li>mud_percentage:        Percentage of pairs of adjacent cells that are separated by mud in the maze.</li>
  <li>mud_range:             Interval of turns needed to cross mud.</li>
  <li>fixed_maze:            Fixed maze in any PyRat accepted representation (dictionary, numpy.ndarray or torch.tensor).</li>
  <li>random_maze_algorithm: Algorithm to generate the maze.</li>
  <li>nb_cheese:             Number of pieces of cheese in the maze.</li>
  <li>fixed_cheese:          Fixed list of cheese.</li>
  <li>render_mode:           Method to display the game.</li>
  <li>render_simplified:     If the maze is rendered, hides some elements that are not essential.</li>
  <li>gui_speed:             When rendering as GUI, controls the speed of the game (GUI rendering only).</li>
  <li>trace_length:          Maximum length of the trace to display when players are moving (GUI rendering only).</li>
  <li>fullscreen:            Renders the game in fullscreen mode (GUI rendering only).</li>
  <li>save_path:             Path where games are saved.</li>
  <li>save_game:             Indicates if the game should be saved.</li>
  <li>preprocessing_time:    Time given to the players before the game starts.</li>
  <li>turn_time:             Time after which players will miss a turn.</li>
  <li>game_mode:             Indicates if players play concurrently, wait for each other, or if multiprocessing is disabled.</li>
  <li>continue_on_error:     If a player crashes, continues the game anyway.</li>
  </ul>
</blockquote>

<h6 id="out">Out:</h6>

<blockquote>
  <ul>
  <li>A new instance of the class.</li>
  </ul>
</blockquote>
</div>


                            </div>
                            <div id="Game.DEFAULT_RANDOM_SEED" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_RANDOM_SEED</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_RANDOM_SEED"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_RANDOM_SEED_MAZE" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_RANDOM_SEED_MAZE</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_RANDOM_SEED_MAZE"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_RANDOM_SEED_CHEESE" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_RANDOM_SEED_CHEESE</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_RANDOM_SEED_CHEESE"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_RANDOM_SEED_PLAYERS" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_RANDOM_SEED_PLAYERS</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_RANDOM_SEED_PLAYERS"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_MAZE_WIDTH" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_MAZE_WIDTH</span>        =
<span class="default_value">15</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_MAZE_WIDTH"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_MAZE_HEIGHT" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_MAZE_HEIGHT</span>        =
<span class="default_value">13</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_MAZE_HEIGHT"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_CELL_PERCENTAGE" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_CELL_PERCENTAGE</span>        =
<span class="default_value">80.0</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_CELL_PERCENTAGE"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_WALL_PERCENTAGE" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_WALL_PERCENTAGE</span>        =
<span class="default_value">60.0</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_WALL_PERCENTAGE"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_MUD_PERCENTAGE" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_MUD_PERCENTAGE</span>        =
<span class="default_value">20.0</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_MUD_PERCENTAGE"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_MUD_RANGE" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_MUD_RANGE</span>        =
<span class="default_value">(4, 9)</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_MUD_RANGE"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_FIXED_MAZE" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_FIXED_MAZE</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_FIXED_MAZE"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_RANDOM_MAZE_ALGORITHM" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_RANDOM_MAZE_ALGORITHM</span>        =
<span class="default_value">&lt;RandomMazeAlgorithm.BIG_HOLES: &#39;big_holes&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_RANDOM_MAZE_ALGORITHM"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_NB_CHEESE" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_NB_CHEESE</span>        =
<span class="default_value">21</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_NB_CHEESE"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_FIXED_CHEESE" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_FIXED_CHEESE</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_FIXED_CHEESE"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_RENDER_MODE" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_RENDER_MODE</span>        =
<span class="default_value">&lt;RenderMode.GUI: &#39;gui&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_RENDER_MODE"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_RENDER_SIMPLIFIED" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_RENDER_SIMPLIFIED</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_RENDER_SIMPLIFIED"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_GUI_SPEED" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_GUI_SPEED</span>        =
<span class="default_value">1.0</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_GUI_SPEED"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_TRACE_LENGTH" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_TRACE_LENGTH</span>        =
<span class="default_value">0</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_TRACE_LENGTH"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_FULLSCREEN" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_FULLSCREEN</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_FULLSCREEN"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_SAVE_PATH" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_SAVE_PATH</span>        =
<span class="default_value">&#39;.&#39;</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_SAVE_PATH"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_SAVE_GAME" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_SAVE_GAME</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_SAVE_GAME"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_PREPROCESSING_TIME" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_PREPROCESSING_TIME</span>        =
<span class="default_value">3.0</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_PREPROCESSING_TIME"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_TURN_TIME" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_TURN_TIME</span>        =
<span class="default_value">0.1</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_TURN_TIME"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_GAME_MODE" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_GAME_MODE</span>        =
<span class="default_value">&lt;GameMode.STANDARD: &#39;standard&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_GAME_MODE"></a>
    
    

                            </div>
                            <div id="Game.DEFAULT_CONTINUE_ON_ERROR" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULT_CONTINUE_ON_ERROR</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#Game.DEFAULT_CONTINUE_ON_ERROR"></a>
    
    

                            </div>
                            <div id="Game.maze" class="classattr">
                                        <input id="Game.maze-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">maze</span><span class="annotation">: <a href="Maze.html#Maze">pyrat.src.Maze.Maze</a></span>

                <label class="view-source-button" for="Game.maze-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Game.maze"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Game.maze-290"><a href="#Game.maze-290"><span class="linenos">290</span></a>    <span class="nd">@property</span>
</span><span id="Game.maze-291"><a href="#Game.maze-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">maze</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span>
</span><span id="Game.maze-292"><a href="#Game.maze-292"><span class="linenos">292</span></a>             <span class="p">)</span> <span class="o">-&gt;</span>    <span class="n">Maze</span><span class="p">:</span>
</span><span id="Game.maze-293"><a href="#Game.maze-293"><span class="linenos">293</span></a><span class="w">        </span>
</span><span id="Game.maze-294"><a href="#Game.maze-294"><span class="linenos">294</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game.maze-295"><a href="#Game.maze-295"><span class="linenos">295</span></a><span class="sd">            Getter for __maze.</span>
</span><span id="Game.maze-296"><a href="#Game.maze-296"><span class="linenos">296</span></a><span class="sd">            It returns a copy of the maze attribute.</span>
</span><span id="Game.maze-297"><a href="#Game.maze-297"><span class="linenos">297</span></a><span class="sd">            In:</span>
</span><span id="Game.maze-298"><a href="#Game.maze-298"><span class="linenos">298</span></a><span class="sd">                * self: Reference to the current object.</span>
</span><span id="Game.maze-299"><a href="#Game.maze-299"><span class="linenos">299</span></a><span class="sd">            Out:</span>
</span><span id="Game.maze-300"><a href="#Game.maze-300"><span class="linenos">300</span></a><span class="sd">                * maze_copy: Copy of the __maze attribute.</span>
</span><span id="Game.maze-301"><a href="#Game.maze-301"><span class="linenos">301</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game.maze-302"><a href="#Game.maze-302"><span class="linenos">302</span></a>
</span><span id="Game.maze-303"><a href="#Game.maze-303"><span class="linenos">303</span></a>        <span class="c1"># Return the attribute</span>
</span><span id="Game.maze-304"><a href="#Game.maze-304"><span class="linenos">304</span></a>        <span class="n">maze_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="p">)</span>
</span><span id="Game.maze-305"><a href="#Game.maze-305"><span class="linenos">305</span></a>        <span class="k">return</span> <span class="n">maze_copy</span>
</span></pre></div>


            <div class="docstring"><p>Getter for __maze.
It returns a copy of the maze attribute.</p>

<h6 id="in">In:</h6>

<blockquote>
  <ul>
  <li>self: Reference to the current object.</li>
  </ul>
</blockquote>

<h6 id="out">Out:</h6>

<blockquote>
  <ul>
  <li>maze_copy: Copy of the __maze attribute.</li>
  </ul>
</blockquote>
</div>


                            </div>
                            <div id="Game.add_player" class="classattr">
                                        <input id="Game.add_player-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_player</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">Self</span>,</span><span class="param">	<span class="n">player</span><span class="p">:</span> <span class="n"><a href="Player.html#Player">pyrat.src.Player.Player</a></span>,</span><span class="param">	<span class="n">team</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">location</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="enums.html#StartingLocation">pyrat.src.enums.StartingLocation</a></span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">StartingLocation</span><span class="o">.</span><span class="n">CENTER</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="o">&gt;</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Game.add_player-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Game.add_player"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Game.add_player-311"><a href="#Game.add_player-311"><span class="linenos">311</span></a>    <span class="k">def</span> <span class="nf">add_player</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>     <span class="n">Self</span><span class="p">,</span>
</span><span id="Game.add_player-312"><a href="#Game.add_player-312"><span class="linenos">312</span></a>                     <span class="n">player</span><span class="p">:</span>   <span class="n">Player</span><span class="p">,</span>
</span><span id="Game.add_player-313"><a href="#Game.add_player-313"><span class="linenos">313</span></a>                     <span class="n">team</span><span class="p">:</span>     <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="Game.add_player-314"><a href="#Game.add_player-314"><span class="linenos">314</span></a>                     <span class="n">location</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">StartingLocation</span><span class="p">,</span> <span class="n">Integral</span><span class="p">]</span> <span class="o">=</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">CENTER</span>
</span><span id="Game.add_player-315"><a href="#Game.add_player-315"><span class="linenos">315</span></a>                   <span class="p">)</span> <span class="o">-&gt;</span>        <span class="kc">None</span><span class="p">:</span>
</span><span id="Game.add_player-316"><a href="#Game.add_player-316"><span class="linenos">316</span></a><span class="w">        </span>
</span><span id="Game.add_player-317"><a href="#Game.add_player-317"><span class="linenos">317</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game.add_player-318"><a href="#Game.add_player-318"><span class="linenos">318</span></a><span class="sd">            Adds a player to the game.</span>
</span><span id="Game.add_player-319"><a href="#Game.add_player-319"><span class="linenos">319</span></a><span class="sd">            In:</span>
</span><span id="Game.add_player-320"><a href="#Game.add_player-320"><span class="linenos">320</span></a><span class="sd">                * self:     Reference to the current object.</span>
</span><span id="Game.add_player-321"><a href="#Game.add_player-321"><span class="linenos">321</span></a><span class="sd">                * player:   Player to add.</span>
</span><span id="Game.add_player-322"><a href="#Game.add_player-322"><span class="linenos">322</span></a><span class="sd">                * team:     Team of the player.</span>
</span><span id="Game.add_player-323"><a href="#Game.add_player-323"><span class="linenos">323</span></a><span class="sd">                * location: Controls initial location of the player (fixed index, or value of the StartingLocation enumeration).</span>
</span><span id="Game.add_player-324"><a href="#Game.add_player-324"><span class="linenos">324</span></a><span class="sd">            Out:</span>
</span><span id="Game.add_player-325"><a href="#Game.add_player-325"><span class="linenos">325</span></a><span class="sd">                * None.</span>
</span><span id="Game.add_player-326"><a href="#Game.add_player-326"><span class="linenos">326</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game.add_player-327"><a href="#Game.add_player-327"><span class="linenos">327</span></a>
</span><span id="Game.add_player-328"><a href="#Game.add_player-328"><span class="linenos">328</span></a>        <span class="c1"># Debug</span>
</span><span id="Game.add_player-329"><a href="#Game.add_player-329"><span class="linenos">329</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">Player</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;player&#39; must be of type &#39;pyrat.Player&#39;&quot;</span>
</span><span id="Game.add_player-330"><a href="#Game.add_player-330"><span class="linenos">330</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">team</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;team&#39; must be a string&quot;</span>
</span><span id="Game.add_player-331"><a href="#Game.add_player-331"><span class="linenos">331</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="p">(</span><span class="n">StartingLocation</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)),</span> <span class="s2">&quot;Argument &#39;location&#39; must be of type &#39;pyrat.StartingLocation&#39; or an integer, corresponding to the index of the cell where the player should start&quot;</span>
</span><span id="Game.add_player-332"><a href="#Game.add_player-332"><span class="linenos">332</span></a>        <span class="k">assert</span> <span class="n">location</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">StartingLocation</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_exists</span><span class="p">(</span><span class="n">location</span><span class="p">)),</span> <span class="s2">&quot;Argument &#39;location&#39; must be a valid index of the maze or a value of the &#39;pyrat.StartingLocation&#39; enumeration&quot;</span>
</span><span id="Game.add_player-333"><a href="#Game.add_player-333"><span class="linenos">333</span></a>        <span class="k">assert</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span><span class="p">,</span> <span class="s2">&quot;Player &#39;</span><span class="si">%s</span><span class="s2">&#39; was already added to the game&quot;</span> <span class="o">%</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span>
</span><span id="Game.add_player-334"><a href="#Game.add_player-334"><span class="linenos">334</span></a>        <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">SAME</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;Cannot start player &#39;</span><span class="si">%s</span><span class="s2">&#39; at the same location as the previous player if no player was added before&quot;</span> <span class="o">%</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span>
</span><span id="Game.add_player-335"><a href="#Game.add_player-335"><span class="linenos">335</span></a>
</span><span id="Game.add_player-336"><a href="#Game.add_player-336"><span class="linenos">336</span></a>        <span class="c1"># Set initial location</span>
</span><span id="Game.add_player-337"><a href="#Game.add_player-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players_asked_location</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
</span><span id="Game.add_player-338"><a href="#Game.add_player-338"><span class="linenos">338</span></a>        <span class="n">corrected_location</span> <span class="o">=</span> <span class="n">location</span>
</span><span id="Game.add_player-339"><a href="#Game.add_player-339"><span class="linenos">339</span></a>        <span class="k">if</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">RANDOM</span><span class="p">:</span>
</span><span id="Game.add_player-340"><a href="#Game.add_player-340"><span class="linenos">340</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players_rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</span><span id="Game.add_player-341"><a href="#Game.add_player-341"><span class="linenos">341</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">SAME</span><span class="p">:</span>
</span><span id="Game.add_player-342"><a href="#Game.add_player-342"><span class="linenos">342</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Game.add_player-343"><a href="#Game.add_player-343"><span class="linenos">343</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">CENTER</span><span class="p">:</span>
</span><span id="Game.add_player-344"><a href="#Game.add_player-344"><span class="linenos">344</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Game.add_player-345"><a href="#Game.add_player-345"><span class="linenos">345</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">:</span>
</span><span id="Game.add_player-346"><a href="#Game.add_player-346"><span class="linenos">346</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Game.add_player-347"><a href="#Game.add_player-347"><span class="linenos">347</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">:</span>
</span><span id="Game.add_player-348"><a href="#Game.add_player-348"><span class="linenos">348</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game.add_player-349"><a href="#Game.add_player-349"><span class="linenos">349</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">:</span>
</span><span id="Game.add_player-350"><a href="#Game.add_player-350"><span class="linenos">350</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Game.add_player-351"><a href="#Game.add_player-351"><span class="linenos">351</span></a>        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="n">StartingLocation</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">:</span>
</span><span id="Game.add_player-352"><a href="#Game.add_player-352"><span class="linenos">352</span></a>            <span class="n">corrected_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">rc_to_i</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game.add_player-353"><a href="#Game.add_player-353"><span class="linenos">353</span></a>        
</span><span id="Game.add_player-354"><a href="#Game.add_player-354"><span class="linenos">354</span></a>        <span class="c1"># If the location is not reachable, we choose the closest reachable location</span>
</span><span id="Game.add_player-355"><a href="#Game.add_player-355"><span class="linenos">355</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_exists</span><span class="p">(</span><span class="n">corrected_location</span><span class="p">):</span>
</span><span id="Game.add_player-356"><a href="#Game.add_player-356"><span class="linenos">356</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">corrected_location</span>
</span><span id="Game.add_player-357"><a href="#Game.add_player-357"><span class="linenos">357</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Game.add_player-358"><a href="#Game.add_player-358"><span class="linenos">358</span></a>            <span class="n">valid_cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="Game.add_player-359"><a href="#Game.add_player-359"><span class="linenos">359</span></a>            <span class="n">distances</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_to_rc</span><span class="p">(</span><span class="n">corrected_location</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">i_to_rc</span><span class="p">(</span><span class="n">cell</span><span class="p">))</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">valid_cells</span><span class="p">]</span>
</span><span id="Game.add_player-360"><a href="#Game.add_player-360"><span class="linenos">360</span></a>            <span class="n">_</span><span class="p">,</span> <span class="n">argmin_distance</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">val</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>
</span><span id="Game.add_player-361"><a href="#Game.add_player-361"><span class="linenos">361</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_cells</span><span class="p">[</span><span class="n">argmin_distance</span><span class="p">]</span>
</span><span id="Game.add_player-362"><a href="#Game.add_player-362"><span class="linenos">362</span></a>
</span><span id="Game.add_player-363"><a href="#Game.add_player-363"><span class="linenos">363</span></a>        <span class="c1"># Append to team</span>
</span><span id="Game.add_player-364"><a href="#Game.add_player-364"><span class="linenos">364</span></a>        <span class="k">if</span> <span class="n">team</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">:</span>
</span><span id="Game.add_player-365"><a href="#Game.add_player-365"><span class="linenos">365</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Game.add_player-366"><a href="#Game.add_player-366"><span class="linenos">366</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="Game.add_player-367"><a href="#Game.add_player-367"><span class="linenos">367</span></a>
</span><span id="Game.add_player-368"><a href="#Game.add_player-368"><span class="linenos">368</span></a>        <span class="c1"># Initialize other elements of game state</span>
</span><span id="Game.add_player-369"><a href="#Game.add_player-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">score_per_player</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Game.add_player-370"><a href="#Game.add_player-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">muds</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span><span id="Game.add_player-371"><a href="#Game.add_player-371"><span class="linenos">371</span></a>
</span><span id="Game.add_player-372"><a href="#Game.add_player-372"><span class="linenos">372</span></a>        <span class="c1"># Other attributes</span>
</span><span id="Game.add_player-373"><a href="#Game.add_player-373"><span class="linenos">373</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
</span><span id="Game.add_player-374"><a href="#Game.add_player-374"><span class="linenos">374</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Game.add_player-375"><a href="#Game.add_player-375"><span class="linenos">375</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Adds a player to the game.</p>

<h6 id="in">In:</h6>

<blockquote>
  <ul>
  <li>self:     Reference to the current object.</li>
  <li>player:   Player to add.</li>
  <li>team:     Team of the player.</li>
  <li>location: Controls initial location of the player (fixed index, or value of the StartingLocation enumeration).</li>
  </ul>
</blockquote>

<h6 id="out">Out:</h6>

<blockquote>
  <ul>
  <li>None.</li>
  </ul>
</blockquote>
</div>


                            </div>
                            <div id="Game.reset" class="classattr">
                                        <input id="Game.reset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span>, </span><span class="param"><span class="n">keep_players</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Game.reset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Game.reset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Game.reset-379"><a href="#Game.reset-379"><span class="linenos">379</span></a>    <span class="k">def</span> <span class="nf">reset</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span>         <span class="n">Self</span><span class="p">,</span>
</span><span id="Game.reset-380"><a href="#Game.reset-380"><span class="linenos">380</span></a>                <span class="n">keep_players</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Game.reset-381"><a href="#Game.reset-381"><span class="linenos">381</span></a>              <span class="p">)</span> <span class="o">-&gt;</span>            <span class="kc">None</span><span class="p">:</span>
</span><span id="Game.reset-382"><a href="#Game.reset-382"><span class="linenos">382</span></a><span class="w">        </span>
</span><span id="Game.reset-383"><a href="#Game.reset-383"><span class="linenos">383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game.reset-384"><a href="#Game.reset-384"><span class="linenos">384</span></a><span class="sd">            Resets the game to its initial state.</span>
</span><span id="Game.reset-385"><a href="#Game.reset-385"><span class="linenos">385</span></a><span class="sd">            If random seeds were set, they will be kept, otherwise they will be randomly generated using the configuration provided when the game was created.</span>
</span><span id="Game.reset-386"><a href="#Game.reset-386"><span class="linenos">386</span></a><span class="sd">            If asked, it will keep players and will insert them as they were added.</span>
</span><span id="Game.reset-387"><a href="#Game.reset-387"><span class="linenos">387</span></a><span class="sd">            In:</span>
</span><span id="Game.reset-388"><a href="#Game.reset-388"><span class="linenos">388</span></a><span class="sd">                * self: Reference to the current object.</span>
</span><span id="Game.reset-389"><a href="#Game.reset-389"><span class="linenos">389</span></a><span class="sd">            Out:</span>
</span><span id="Game.reset-390"><a href="#Game.reset-390"><span class="linenos">390</span></a><span class="sd">                * None.</span>
</span><span id="Game.reset-391"><a href="#Game.reset-391"><span class="linenos">391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game.reset-392"><a href="#Game.reset-392"><span class="linenos">392</span></a>        
</span><span id="Game.reset-393"><a href="#Game.reset-393"><span class="linenos">393</span></a>        <span class="c1"># Debug</span>
</span><span id="Game.reset-394"><a href="#Game.reset-394"><span class="linenos">394</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keep_players</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s2">&quot;Argument &#39;keep_players&#39; must be a boolean&quot;</span>
</span><span id="Game.reset-395"><a href="#Game.reset-395"><span class="linenos">395</span></a>
</span><span id="Game.reset-396"><a href="#Game.reset-396"><span class="linenos">396</span></a>        <span class="c1"># Set random seeds for the game</span>
</span><span id="Game.reset-397"><a href="#Game.reset-397"><span class="linenos">397</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_maze</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game.reset-398"><a href="#Game.reset-398"><span class="linenos">398</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_cheese</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_cheese</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_cheese</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game.reset-399"><a href="#Game.reset-399"><span class="linenos">399</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_players</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_players</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_seed_players</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game.reset-400"><a href="#Game.reset-400"><span class="linenos">400</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__players_rng</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">Random</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_players</span><span class="p">)</span>
</span><span id="Game.reset-401"><a href="#Game.reset-401"><span class="linenos">401</span></a>        
</span><span id="Game.reset-402"><a href="#Game.reset-402"><span class="linenos">402</span></a>        <span class="c1"># Reset game analysis elements</span>
</span><span id="Game.reset-403"><a href="#Game.reset-403"><span class="linenos">403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__player_traces</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Game.reset-404"><a href="#Game.reset-404"><span class="linenos">404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Game.reset-405"><a href="#Game.reset-405"><span class="linenos">405</span></a>        
</span><span id="Game.reset-406"><a href="#Game.reset-406"><span class="linenos">406</span></a>        <span class="c1"># Initialize the maze</span>
</span><span id="Game.reset-407"><a href="#Game.reset-407"><span class="linenos">407</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Game.reset-408"><a href="#Game.reset-408"><span class="linenos">408</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">MazeFromDict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span><span class="p">)</span>
</span><span id="Game.reset-409"><a href="#Game.reset-409"><span class="linenos">409</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Game.reset-410"><a href="#Game.reset-410"><span class="linenos">410</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">MazeFromMatrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fixed_maze</span><span class="p">)</span>
</span><span id="Game.reset-411"><a href="#Game.reset-411"><span class="linenos">411</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span> <span class="o">==</span> <span class="n">RandomMazeAlgorithm</span><span class="o">.</span><span class="n">UNIFORM_HOLES</span><span class="p">:</span>
</span><span id="Game.reset-412"><a href="#Game.reset-412"><span class="linenos">412</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">UniformHolesRandomMaze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span><span class="p">)</span>
</span><span id="Game.reset-413"><a href="#Game.reset-413"><span class="linenos">413</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span> <span class="o">==</span> <span class="n">RandomMazeAlgorithm</span><span class="o">.</span><span class="n">HOLES_ON_SIDE</span><span class="p">:</span>
</span><span id="Game.reset-414"><a href="#Game.reset-414"><span class="linenos">414</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">HolesOnSideRandomMaze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span><span class="p">)</span>
</span><span id="Game.reset-415"><a href="#Game.reset-415"><span class="linenos">415</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__random_maze_algorithm</span> <span class="o">==</span> <span class="n">RandomMazeAlgorithm</span><span class="o">.</span><span class="n">BIG_HOLES</span><span class="p">:</span>
</span><span id="Game.reset-416"><a href="#Game.reset-416"><span class="linenos">416</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span> <span class="o">=</span> <span class="n">BigHolesRandomMaze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cell_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__wall_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_percentage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mud_range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_random_seed_maze</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze_height</span><span class="p">)</span>
</span><span id="Game.reset-417"><a href="#Game.reset-417"><span class="linenos">417</span></a>
</span><span id="Game.reset-418"><a href="#Game.reset-418"><span class="linenos">418</span></a>        <span class="c1"># Initialize the rendering engine</span>
</span><span id="Game.reset-419"><a href="#Game.reset-419"><span class="linenos">419</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="n">RenderMode</span><span class="o">.</span><span class="n">ASCII</span><span class="p">,</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">ANSI</span><span class="p">]:</span>
</span><span id="Game.reset-420"><a href="#Game.reset-420"><span class="linenos">420</span></a>            <span class="n">use_colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">ANSI</span>
</span><span id="Game.reset-421"><a href="#Game.reset-421"><span class="linenos">421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span> <span class="o">=</span> <span class="n">ShellRenderingEngine</span><span class="p">(</span><span class="n">use_colors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span><span class="p">)</span>
</span><span id="Game.reset-422"><a href="#Game.reset-422"><span class="linenos">422</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">GUI</span><span class="p">:</span>
</span><span id="Game.reset-423"><a href="#Game.reset-423"><span class="linenos">423</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span> <span class="o">=</span> <span class="n">PygameRenderingEngine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__fullscreen</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__trace_length</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_speed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span><span class="p">)</span>
</span><span id="Game.reset-424"><a href="#Game.reset-424"><span class="linenos">424</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__render_mode</span> <span class="o">==</span> <span class="n">RenderMode</span><span class="o">.</span><span class="n">NO_RENDERING</span><span class="p">:</span>
</span><span id="Game.reset-425"><a href="#Game.reset-425"><span class="linenos">425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span> <span class="o">=</span> <span class="n">RenderingEngine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__render_simplified</span><span class="p">)</span>
</span><span id="Game.reset-426"><a href="#Game.reset-426"><span class="linenos">426</span></a>        
</span><span id="Game.reset-427"><a href="#Game.reset-427"><span class="linenos">427</span></a>        <span class="c1"># Initialize the game state</span>
</span><span id="Game.reset-428"><a href="#Game.reset-428"><span class="linenos">428</span></a>        <span class="n">previous_initial_state</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="p">)</span>
</span><span id="Game.reset-429"><a href="#Game.reset-429"><span class="linenos">429</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">()</span>
</span><span id="Game.reset-430"><a href="#Game.reset-430"><span class="linenos">430</span></a>
</span><span id="Game.reset-431"><a href="#Game.reset-431"><span class="linenos">431</span></a>        <span class="c1"># Add players as they were added</span>
</span><span id="Game.reset-432"><a href="#Game.reset-432"><span class="linenos">432</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">)):</span>
</span><span id="Game.reset-433"><a href="#Game.reset-433"><span class="linenos">433</span></a>            <span class="n">player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Game.reset-434"><a href="#Game.reset-434"><span class="linenos">434</span></a>            <span class="n">player_asked_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players_asked_location</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Game.reset-435"><a href="#Game.reset-435"><span class="linenos">435</span></a>            <span class="k">if</span> <span class="n">keep_players</span><span class="p">:</span>
</span><span id="Game.reset-436"><a href="#Game.reset-436"><span class="linenos">436</span></a>                <span class="n">player_team</span> <span class="o">=</span> <span class="p">[</span><span class="n">team</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">previous_initial_state</span><span class="o">.</span><span class="n">teams</span> <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">previous_initial_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Game.reset-437"><a href="#Game.reset-437"><span class="linenos">437</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_player</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">player_team</span><span class="p">,</span> <span class="n">player_asked_location</span><span class="p">)</span>
</span><span id="Game.reset-438"><a href="#Game.reset-438"><span class="linenos">438</span></a>
</span><span id="Game.reset-439"><a href="#Game.reset-439"><span class="linenos">439</span></a>        <span class="c1"># Indicate that the game was reset</span>
</span><span id="Game.reset-440"><a href="#Game.reset-440"><span class="linenos">440</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__reset_called</span> <span class="o">=</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Resets the game to its initial state.
If random seeds were set, they will be kept, otherwise they will be randomly generated using the configuration provided when the game was created.
If asked, it will keep players and will insert them as they were added.</p>

<h6 id="in">In:</h6>

<blockquote>
  <ul>
  <li>self: Reference to the current object.</li>
  </ul>
</blockquote>

<h6 id="out">Out:</h6>

<blockquote>
  <ul>
  <li>None.</li>
  </ul>
</blockquote>
</div>


                            </div>
                            <div id="Game.start" class="classattr">
                                        <input id="Game.start-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">start</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Game.start-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Game.start"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Game.start-444"><a href="#Game.start-444"><span class="linenos">444</span></a>    <span class="k">def</span> <span class="nf">start</span> <span class="p">(</span> <span class="bp">self</span><span class="p">:</span> <span class="n">Self</span>
</span><span id="Game.start-445"><a href="#Game.start-445"><span class="linenos">445</span></a>              <span class="p">)</span> <span class="o">-&gt;</span>    <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="Game.start-446"><a href="#Game.start-446"><span class="linenos">446</span></a>
</span><span id="Game.start-447"><a href="#Game.start-447"><span class="linenos">447</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Game.start-448"><a href="#Game.start-448"><span class="linenos">448</span></a><span class="sd">            Starts a game, asking players for decisions until the game is over.</span>
</span><span id="Game.start-449"><a href="#Game.start-449"><span class="linenos">449</span></a><span class="sd">            In:</span>
</span><span id="Game.start-450"><a href="#Game.start-450"><span class="linenos">450</span></a><span class="sd">                * self: Reference to the current object.</span>
</span><span id="Game.start-451"><a href="#Game.start-451"><span class="linenos">451</span></a><span class="sd">            Out:</span>
</span><span id="Game.start-452"><a href="#Game.start-452"><span class="linenos">452</span></a><span class="sd">                * stats: Game statistics computed during the game.</span>
</span><span id="Game.start-453"><a href="#Game.start-453"><span class="linenos">453</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Game.start-454"><a href="#Game.start-454"><span class="linenos">454</span></a>        
</span><span id="Game.start-455"><a href="#Game.start-455"><span class="linenos">455</span></a>        <span class="c1"># Debug</span>
</span><span id="Game.start-456"><a href="#Game.start-456"><span class="linenos">456</span></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;No player was added to the game&quot;</span>
</span><span id="Game.start-457"><a href="#Game.start-457"><span class="linenos">457</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">__reset_called</span><span class="p">,</span> <span class="s2">&quot;The game was not reset before starting&quot;</span>
</span><span id="Game.start-458"><a href="#Game.start-458"><span class="linenos">458</span></a>
</span><span id="Game.start-459"><a href="#Game.start-459"><span class="linenos">459</span></a>        <span class="c1"># We catch exceptions that may happen during the game</span>
</span><span id="Game.start-460"><a href="#Game.start-460"><span class="linenos">460</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Game.start-461"><a href="#Game.start-461"><span class="linenos">461</span></a>        
</span><span id="Game.start-462"><a href="#Game.start-462"><span class="linenos">462</span></a>            <span class="c1"># Mark the game as not reset</span>
</span><span id="Game.start-463"><a href="#Game.start-463"><span class="linenos">463</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__reset_called</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Game.start-464"><a href="#Game.start-464"><span class="linenos">464</span></a>
</span><span id="Game.start-465"><a href="#Game.start-465"><span class="linenos">465</span></a>            <span class="c1"># Initialize stats</span>
</span><span id="Game.start-466"><a href="#Game.start-466"><span class="linenos">466</span></a>            <span class="n">stats</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;players&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;turns&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
</span><span id="Game.start-467"><a href="#Game.start-467"><span class="linenos">467</span></a>            <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game.start-468"><a href="#Game.start-468"><span class="linenos">468</span></a>                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game.start-469"><a href="#Game.start-469"><span class="linenos">469</span></a>                                                 <span class="s2">&quot;preprocessing_duration&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Game.start-470"><a href="#Game.start-470"><span class="linenos">470</span></a>                                                 <span class="s2">&quot;turn_durations&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="Game.start-471"><a href="#Game.start-471"><span class="linenos">471</span></a>                                                 <span class="s2">&quot;team&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">team</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span> <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team</span><span class="p">]][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Game.start-472"><a href="#Game.start-472"><span class="linenos">472</span></a>                                                 <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">Action</span><span class="o">.</span><span class="n">NOTHING</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game.start-473"><a href="#Game.start-473"><span class="linenos">473</span></a>                                                             <span class="n">Action</span><span class="o">.</span><span class="n">NORTH</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game.start-474"><a href="#Game.start-474"><span class="linenos">474</span></a>                                                             <span class="n">Action</span><span class="o">.</span><span class="n">EAST</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game.start-475"><a href="#Game.start-475"><span class="linenos">475</span></a>                                                             <span class="n">Action</span><span class="o">.</span><span class="n">SOUTH</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game.start-476"><a href="#Game.start-476"><span class="linenos">476</span></a>                                                             <span class="n">Action</span><span class="o">.</span><span class="n">WEST</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game.start-477"><a href="#Game.start-477"><span class="linenos">477</span></a>                                                             <span class="s2">&quot;mud&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game.start-478"><a href="#Game.start-478"><span class="linenos">478</span></a>                                                             <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game.start-479"><a href="#Game.start-479"><span class="linenos">479</span></a>                                                             <span class="s2">&quot;miss&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Game.start-480"><a href="#Game.start-480"><span class="linenos">480</span></a>                                                             <span class="s2">&quot;wall&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">}}</span>
</span><span id="Game.start-481"><a href="#Game.start-481"><span class="linenos">481</span></a>            
</span><span id="Game.start-482"><a href="#Game.start-482"><span class="linenos">482</span></a>            <span class="c1"># In multiprocessing mode, prepare processes</span>
</span><span id="Game.start-483"><a href="#Game.start-483"><span class="linenos">483</span></a>            <span class="n">maze_per_player</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="p">)</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="Game.start-484"><a href="#Game.start-484"><span class="linenos">484</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">,</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">]:</span>
</span><span id="Game.start-485"><a href="#Game.start-485"><span class="linenos">485</span></a>
</span><span id="Game.start-486"><a href="#Game.start-486"><span class="linenos">486</span></a>                <span class="c1"># Create a process per player</span>
</span><span id="Game.start-487"><a href="#Game.start-487"><span class="linenos">487</span></a>                <span class="n">turn_start_synchronizer</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Barrier</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Game.start-488"><a href="#Game.start-488"><span class="linenos">488</span></a>                <span class="n">turn_timeout_lock</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</span><span id="Game.start-489"><a href="#Game.start-489"><span class="linenos">489</span></a>                <span class="n">player_processes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Game.start-490"><a href="#Game.start-490"><span class="linenos">490</span></a>                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game.start-491"><a href="#Game.start-491"><span class="linenos">491</span></a>                    <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;process&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;input_queue&quot;</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Queue</span><span class="p">(),</span> <span class="s2">&quot;output_queue&quot;</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Queue</span><span class="p">(),</span> <span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Barrier</span><span class="p">(</span><span class="mi">2</span><span class="p">)}</span>
</span><span id="Game.start-492"><a href="#Game.start-492"><span class="linenos">492</span></a>                    <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;process&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_player_process_function</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">maze_per_player</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;input_queue&quot;</span><span class="p">],</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">],</span> <span class="n">turn_start_synchronizer</span><span class="p">,</span> <span class="n">turn_timeout_lock</span><span class="p">,</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,))</span>
</span><span id="Game.start-493"><a href="#Game.start-493"><span class="linenos">493</span></a>                    <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;process&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="Game.start-494"><a href="#Game.start-494"><span class="linenos">494</span></a>
</span><span id="Game.start-495"><a href="#Game.start-495"><span class="linenos">495</span></a>                <span class="c1"># If playing in standard mode, we create processs to wait instead of missing players</span>
</span><span id="Game.start-496"><a href="#Game.start-496"><span class="linenos">496</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">:</span>
</span><span id="Game.start-497"><a href="#Game.start-497"><span class="linenos">497</span></a>                    <span class="n">waiter_processes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Game.start-498"><a href="#Game.start-498"><span class="linenos">498</span></a>                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game.start-499"><a href="#Game.start-499"><span class="linenos">499</span></a>                        <span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;process&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;input_queue&quot;</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">Queue</span><span class="p">()}</span>
</span><span id="Game.start-500"><a href="#Game.start-500"><span class="linenos">500</span></a>                        <span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;process&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_waiter_process_function</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;input_queue&quot;</span><span class="p">],</span> <span class="n">turn_start_synchronizer</span><span class="p">,))</span>
</span><span id="Game.start-501"><a href="#Game.start-501"><span class="linenos">501</span></a>                        <span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;process&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="Game.start-502"><a href="#Game.start-502"><span class="linenos">502</span></a>
</span><span id="Game.start-503"><a href="#Game.start-503"><span class="linenos">503</span></a>            <span class="c1"># Add cheese</span>
</span><span id="Game.start-504"><a href="#Game.start-504"><span class="linenos">504</span></a>            <span class="n">available_cells</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="o">.</span><span class="n">vertices</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="Game.start-505"><a href="#Game.start-505"><span class="linenos">505</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="o">.</span><span class="n">cheese</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__distribute_cheese</span><span class="p">(</span><span class="n">available_cells</span><span class="p">))</span>
</span><span id="Game.start-506"><a href="#Game.start-506"><span class="linenos">506</span></a>            <span class="n">game_state</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__initial_game_state</span><span class="p">)</span>
</span><span id="Game.start-507"><a href="#Game.start-507"><span class="linenos">507</span></a>            
</span><span id="Game.start-508"><a href="#Game.start-508"><span class="linenos">508</span></a>            <span class="c1"># Initial rendering of the maze</span>
</span><span id="Game.start-509"><a href="#Game.start-509"><span class="linenos">509</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="p">,</span> <span class="n">game_state</span><span class="p">)</span>
</span><span id="Game.start-510"><a href="#Game.start-510"><span class="linenos">510</span></a>            
</span><span id="Game.start-511"><a href="#Game.start-511"><span class="linenos">511</span></a>            <span class="c1"># We play until the game is over</span>
</span><span id="Game.start-512"><a href="#Game.start-512"><span class="linenos">512</span></a>            <span class="n">players_ready</span> <span class="o">=</span> <span class="p">[</span><span class="n">player</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">]</span>
</span><span id="Game.start-513"><a href="#Game.start-513"><span class="linenos">513</span></a>            <span class="n">players_running</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="kc">True</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="Game.start-514"><a href="#Game.start-514"><span class="linenos">514</span></a>            <span class="n">all_action_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">action</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">Action</span><span class="p">]</span>
</span><span id="Game.start-515"><a href="#Game.start-515"><span class="linenos">515</span></a>            <span class="k">while</span> <span class="nb">any</span><span class="p">(</span><span class="n">players_running</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="Game.start-516"><a href="#Game.start-516"><span class="linenos">516</span></a>
</span><span id="Game.start-517"><a href="#Game.start-517"><span class="linenos">517</span></a>                <span class="c1"># We communicate the state of the game to the players not in mud</span>
</span><span id="Game.start-518"><a href="#Game.start-518"><span class="linenos">518</span></a>                <span class="n">game_phases</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="Game.start-519"><a href="#Game.start-519"><span class="linenos">519</span></a>                <span class="n">turn_actions</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="s2">&quot;miss&quot;</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="Game.start-520"><a href="#Game.start-520"><span class="linenos">520</span></a>                <span class="n">durations</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="Game.start-521"><a href="#Game.start-521"><span class="linenos">521</span></a>                <span class="k">for</span> <span class="n">ready_player</span> <span class="ow">in</span> <span class="n">players_ready</span><span class="p">:</span>
</span><span id="Game.start-522"><a href="#Game.start-522"><span class="linenos">522</span></a>                    <span class="n">final_stats</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span> <span class="k">if</span> <span class="n">game_state</span><span class="o">.</span><span class="n">game_over</span><span class="p">()</span> <span class="k">else</span> <span class="p">{}</span>
</span><span id="Game.start-523"><a href="#Game.start-523"><span class="linenos">523</span></a>                    <span class="n">player_game_state</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">game_state</span><span class="p">)</span>
</span><span id="Game.start-524"><a href="#Game.start-524"><span class="linenos">524</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">,</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">]:</span>
</span><span id="Game.start-525"><a href="#Game.start-525"><span class="linenos">525</span></a>                        <span class="n">player_processes</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;input_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">player_game_state</span><span class="p">,</span> <span class="n">final_stats</span><span class="p">))</span>
</span><span id="Game.start-526"><a href="#Game.start-526"><span class="linenos">526</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Game.start-527"><a href="#Game.start-527"><span class="linenos">527</span></a>                        <span class="n">turn_actions</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">durations</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_player_process_function</span><span class="p">(</span><span class="n">ready_player</span><span class="p">,</span> <span class="n">maze_per_player</span><span class="p">[</span><span class="n">ready_player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">player_game_state</span><span class="p">,</span> <span class="n">final_stats</span><span class="p">)</span>
</span><span id="Game.start-528"><a href="#Game.start-528"><span class="linenos">528</span></a>                
</span><span id="Game.start-529"><a href="#Game.start-529"><span class="linenos">529</span></a>                <span class="c1"># In multiprocessing mode, we for everybody to receive data to start</span>
</span><span id="Game.start-530"><a href="#Game.start-530"><span class="linenos">530</span></a>                <span class="c1"># In sequential mode, decisions are already received at this point</span>
</span><span id="Game.start-531"><a href="#Game.start-531"><span class="linenos">531</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">,</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">]:</span>
</span><span id="Game.start-532"><a href="#Game.start-532"><span class="linenos">532</span></a>                    <span class="n">turn_start_synchronizer</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="Game.start-533"><a href="#Game.start-533"><span class="linenos">533</span></a>
</span><span id="Game.start-534"><a href="#Game.start-534"><span class="linenos">534</span></a>                <span class="c1"># Wait a bit</span>
</span><span id="Game.start-535"><a href="#Game.start-535"><span class="linenos">535</span></a>                <span class="n">sleep_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__preprocessing_time</span> <span class="k">if</span> <span class="n">game_state</span><span class="o">.</span><span class="n">turn</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">__turn_time</span>
</span><span id="Game.start-536"><a href="#Game.start-536"><span class="linenos">536</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>
</span><span id="Game.start-537"><a href="#Game.start-537"><span class="linenos">537</span></a>
</span><span id="Game.start-538"><a href="#Game.start-538"><span class="linenos">538</span></a>                <span class="c1"># In synchronous mode, we wait for everyone</span>
</span><span id="Game.start-539"><a href="#Game.start-539"><span class="linenos">539</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">:</span>
</span><span id="Game.start-540"><a href="#Game.start-540"><span class="linenos">540</span></a>                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game.start-541"><a href="#Game.start-541"><span class="linenos">541</span></a>                        <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="Game.start-542"><a href="#Game.start-542"><span class="linenos">542</span></a>                        <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="Game.start-543"><a href="#Game.start-543"><span class="linenos">543</span></a>
</span><span id="Game.start-544"><a href="#Game.start-544"><span class="linenos">544</span></a>                <span class="c1"># In standard mode, we block the possibility to return an action and check who answered in time</span>
</span><span id="Game.start-545"><a href="#Game.start-545"><span class="linenos">545</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span><span class="p">:</span>
</span><span id="Game.start-546"><a href="#Game.start-546"><span class="linenos">546</span></a>
</span><span id="Game.start-547"><a href="#Game.start-547"><span class="linenos">547</span></a>                    <span class="c1"># Wait at least for those in mud</span>
</span><span id="Game.start-548"><a href="#Game.start-548"><span class="linenos">548</span></a>                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game.start-549"><a href="#Game.start-549"><span class="linenos">549</span></a>                        <span class="k">if</span> <span class="n">game_state</span><span class="o">.</span><span class="n">is_in_mud</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">players_running</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]:</span>
</span><span id="Game.start-550"><a href="#Game.start-550"><span class="linenos">550</span></a>                            <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="Game.start-551"><a href="#Game.start-551"><span class="linenos">551</span></a>                            <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="Game.start-552"><a href="#Game.start-552"><span class="linenos">552</span></a>
</span><span id="Game.start-553"><a href="#Game.start-553"><span class="linenos">553</span></a>                    <span class="c1"># For others, set timeout and wait for output info of those who passed just before timeout</span>
</span><span id="Game.start-554"><a href="#Game.start-554"><span class="linenos">554</span></a>                    <span class="k">with</span> <span class="n">turn_timeout_lock</span><span class="p">:</span>
</span><span id="Game.start-555"><a href="#Game.start-555"><span class="linenos">555</span></a>                        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game.start-556"><a href="#Game.start-556"><span class="linenos">556</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">game_state</span><span class="o">.</span><span class="n">is_in_mud</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">players_running</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]:</span>
</span><span id="Game.start-557"><a href="#Game.start-557"><span class="linenos">557</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
</span><span id="Game.start-558"><a href="#Game.start-558"><span class="linenos">558</span></a>                                    <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_end_synchronizer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="Game.start-559"><a href="#Game.start-559"><span class="linenos">559</span></a>                                    <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">player_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;output_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="Game.start-560"><a href="#Game.start-560"><span class="linenos">560</span></a>
</span><span id="Game.start-561"><a href="#Game.start-561"><span class="linenos">561</span></a>                <span class="c1"># Check which players are ready to continue</span>
</span><span id="Game.start-562"><a href="#Game.start-562"><span class="linenos">562</span></a>                <span class="n">players_ready</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Game.start-563"><a href="#Game.start-563"><span class="linenos">563</span></a>                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game.start-564"><a href="#Game.start-564"><span class="linenos">564</span></a>                    <span class="k">if</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;postprocessing&quot;</span><span class="p">:</span>
</span><span id="Game.start-565"><a href="#Game.start-565"><span class="linenos">565</span></a>                        <span class="n">players_running</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Game.start-566"><a href="#Game.start-566"><span class="linenos">566</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__game_mode</span> <span class="o">==</span> <span class="n">GameMode</span><span class="o">.</span><span class="n">STANDARD</span> <span class="ow">and</span> <span class="p">(</span><span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;postprocessing&quot;</span> <span class="ow">or</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;miss&quot;</span><span class="p">):</span>
</span><span id="Game.start-567"><a href="#Game.start-567"><span class="linenos">567</span></a>                        <span class="n">waiter_processes</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;input_queue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Game.start-568"><a href="#Game.start-568"><span class="linenos">568</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Game.start-569"><a href="#Game.start-569"><span class="linenos">569</span></a>                        <span class="n">players_ready</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
</span><span id="Game.start-570"><a href="#Game.start-570"><span class="linenos">570</span></a>
</span><span id="Game.start-571"><a href="#Game.start-571"><span class="linenos">571</span></a>                <span class="c1"># Check for errors</span>
</span><span id="Game.start-572"><a href="#Game.start-572"><span class="linenos">572</span></a>                <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">])</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__continue_on_error</span><span class="p">:</span>
</span><span id="Game.start-573"><a href="#Game.start-573"><span class="linenos">573</span></a>                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;A player has crashed, exiting&quot;</span><span class="p">)</span>
</span><span id="Game.start-574"><a href="#Game.start-574"><span class="linenos">574</span></a>
</span><span id="Game.start-575"><a href="#Game.start-575"><span class="linenos">575</span></a>                <span class="c1"># We save the turn info if we are not postprocessing</span>
</span><span id="Game.start-576"><a href="#Game.start-576"><span class="linenos">576</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">game_state</span><span class="o">.</span><span class="n">game_over</span><span class="p">():</span>
</span><span id="Game.start-577"><a href="#Game.start-577"><span class="linenos">577</span></a>                
</span><span id="Game.start-578"><a href="#Game.start-578"><span class="linenos">578</span></a>                    <span class="c1"># Apply the actions</span>
</span><span id="Game.start-579"><a href="#Game.start-579"><span class="linenos">579</span></a>                    <span class="n">corrected_actions</span> <span class="o">=</span> <span class="p">{</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">Action</span><span class="p">(</span><span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span> <span class="k">if</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">in</span> <span class="n">all_action_names</span> <span class="k">else</span> <span class="n">Action</span><span class="o">.</span><span class="n">NOTHING</span> <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">}</span>
</span><span id="Game.start-580"><a href="#Game.start-580"><span class="linenos">580</span></a>                    <span class="n">new_game_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__determine_new_game_state</span><span class="p">(</span><span class="n">game_state</span><span class="p">,</span> <span class="n">corrected_actions</span><span class="p">)</span>
</span><span id="Game.start-581"><a href="#Game.start-581"><span class="linenos">581</span></a>
</span><span id="Game.start-582"><a href="#Game.start-582"><span class="linenos">582</span></a>                    <span class="c1"># Save stats</span>
</span><span id="Game.start-583"><a href="#Game.start-583"><span class="linenos">583</span></a>                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">:</span>
</span><span id="Game.start-584"><a href="#Game.start-584"><span class="linenos">584</span></a>                        <span class="k">if</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
</span><span id="Game.start-585"><a href="#Game.start-585"><span class="linenos">585</span></a>                            <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="s2">&quot;miss&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Game.start-586"><a href="#Game.start-586"><span class="linenos">586</span></a>                        <span class="k">elif</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;preprocessing&quot;</span><span class="p">:</span>
</span><span id="Game.start-587"><a href="#Game.start-587"><span class="linenos">587</span></a>                            <span class="k">if</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">in</span> <span class="n">all_action_names</span> <span class="ow">and</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Action</span><span class="o">.</span><span class="n">NOTHING</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="n">game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">player_locations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">is_in_mud</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
</span><span id="Game.start-588"><a href="#Game.start-588"><span class="linenos">588</span></a>                                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="s2">&quot;wall&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Game.start-589"><a href="#Game.start-589"><span class="linenos">589</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="Game.start-590"><a href="#Game.start-590"><span class="linenos">590</span></a>                                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Game.start-591"><a href="#Game.start-591"><span class="linenos">591</span></a>                            <span class="k">if</span> <span class="n">turn_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;mud&quot;</span><span class="p">:</span>
</span><span id="Game.start-592"><a href="#Game.start-592"><span class="linenos">592</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">__actions_history</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corrected_actions</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="Game.start-593"><a href="#Game.start-593"><span class="linenos">593</span></a>                        <span class="k">if</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Game.start-594"><a href="#Game.start-594"><span class="linenos">594</span></a>                            <span class="k">if</span> <span class="n">game_phases</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;preprocessing&quot;</span><span class="p">:</span>
</span><span id="Game.start-595"><a href="#Game.start-595"><span class="linenos">595</span></a>                                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;preprocessing_duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="Game.start-596"><a href="#Game.start-596"><span class="linenos">596</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="Game.start-597"><a href="#Game.start-597"><span class="linenos">597</span></a>                                <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;turn_durations&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">durations</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="Game.start-598"><a href="#Game.start-598"><span class="linenos">598</span></a>                        <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">][</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_game_state</span><span class="o">.</span><span class="n">score_per_player</span><span class="p">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="Game.start-599"><a href="#Game.start-599"><span class="linenos">599</span></a>                    <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;turns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">game_state</span><span class="o">.</span><span class="n">turn</span>
</span><span id="Game.start-600"><a href="#Game.start-600"><span class="linenos">600</span></a>                    
</span><span id="Game.start-601"><a href="#Game.start-601"><span class="linenos">601</span></a>                    <span class="c1"># Go to next turn</span>
</span><span id="Game.start-602"><a href="#Game.start-602"><span class="linenos">602</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__rendering_engine</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__players</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__maze</span><span class="p">,</span> <span class="n">new_game_state</span><span class="p">)</span>
</span><span id="Game.start-603"><a href="#Game.start-603"><span class="linenos">603</span></a>                    <span class="n">game_state</span> <span class="o">=</span> <span class="n">new_game_state</span>
</span><span id="Game.start-604"><a href="#Game.start-604"><span class="linenos">604</span></a>
</span><span id="Game.start-605"><a href="#Game.start-605"><span class="linenos">605</span></a>        <span class="c1"># In case of an error, we ignore stats</span>
</span><span id="Game.start-606"><a href="#Game.start-606"><span class="linenos">606</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="Game.start-607"><a href="#Game.start-607"><span class="linenos">607</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span id="Game.start-608"><a href="#Game.start-608"><span class="linenos">608</span></a>            <span class="n">stats</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Game.start-609"><a href="#Game.start-609"><span class="linenos">609</span></a>        
</span><span id="Game.start-610"><a href="#Game.start-610"><span class="linenos">610</span></a>        <span class="c1"># Apply end actions before returning</span>
</span><span id="Game.start-611"><a href="#Game.start-611"><span class="linenos">611</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__end</span><span class="p">(</span><span class="n">stats</span> <span class="o">==</span> <span class="p">{})</span>
</span><span id="Game.start-612"><a href="#Game.start-612"><span class="linenos">612</span></a>        <span class="k">return</span> <span class="n">stats</span>
</span></pre></div>


            <div class="docstring"><p>Starts a game, asking players for decisions until the game is over.</p>

<h6 id="in">In:</h6>

<blockquote>
  <ul>
  <li>self: Reference to the current object.</li>
  </ul>
</blockquote>

<h6 id="out">Out:</h6>

<blockquote>
  <ul>
  <li>stats: Game statistics computed during the game.</li>
  </ul>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>